name,active,nodes,connections,createdAt,updatedAt,settings,staticData,pinData,versionId,triggerCount,id,meta,parentFolderId
V1 ocal RAG AI Agent,f,"[{""parameters"":{},""id"":""99b30fd7-b36c-44ba-9daa-408585aaaee9"",""name"":""Postgres Chat Memory"",""type"":""@n8n/n8n-nodes-langchain.memoryPostgresChat"",""typeVersion"":1.1,""position"":[1040,560],""credentials"":{""postgres"":{""id"":""i83SgkPKmlQ785tT"",""name"":""Postgres account""}}},{""parameters"":{""model"":""llama3.1:latest"",""options"":{}},""id"":""c7632a7c-2661-492e-bd6f-aab994818998"",""name"":""Ollama Chat Model"",""type"":""@n8n/n8n-nodes-langchain.lmChatOllama"",""typeVersion"":1,""position"":[920,560],""credentials"":{""ollamaApi"":{""id"":""C0BctVXe93bO063x"",""name"":""Ollama account""}}},{""parameters"":{""model"":""llama3.1:latest"",""options"":{}},""id"":""73d773a4-5c72-4af3-a52d-144f0e417823"",""name"":""Ollama Model"",""type"":""@n8n/n8n-nodes-langchain.lmOllama"",""typeVersion"":1,""position"":[1960,500],""credentials"":{""ollamaApi"":{""id"":""C0BctVXe93bO063x"",""name"":""Ollama account""}}},{""parameters"":{""name"":""documents"",""topK"":3},""id"":""3f882fa7-c8ed-4531-b236-a34c16c55838"",""name"":""Vector Store Tool"",""type"":""@n8n/n8n-nodes-langchain.toolVectorStore"",""typeVersion"":1,""position"":[1740,340]},{""parameters"":{""model"":""nomic-embed-text:latest""},""id"":""3a8e3fa0-3997-4bce-985c-975fb5ad4013"",""name"":""Embeddings Ollama"",""type"":""@n8n/n8n-nodes-langchain.embeddingsOllama"",""typeVersion"":1,""position"":[1840,600],""credentials"":{""ollamaApi"":{""id"":""C0BctVXe93bO063x"",""name"":""Ollama account""}}},{""parameters"":{""pollTimes"":{""item"":[{""mode"":""everyMinute""}]},""triggerOn"":""specificFolder"",""folderToWatch"":{""__rl"":true,""value"":""1914m3M7kRzkd5RJqAfzRY9EBcJrKemZC"",""mode"":""list"",""cachedResultName"":""Meeting Notes"",""cachedResultUrl"":""https://drive.google.com/drive/folders/1914m3M7kRzkd5RJqAfzRY9EBcJrKemZC""},""event"":""fileCreated"",""options"":{}},""id"":""41fb71dd-236a-48bc-9761-5841d52ca1b3"",""name"":""File Created"",""type"":""n8n-nodes-base.googleDriveTrigger"",""typeVersion"":1,""position"":[600,880],""credentials"":{""googleDriveOAuth2Api"":{""id"":""vzcL2pD7uQzqDpdK"",""name"":""Google Drive account""}}},{""parameters"":{""pollTimes"":{""item"":[{""mode"":""everyMinute""}]},""triggerOn"":""specificFolder"",""folderToWatch"":{""__rl"":true,""value"":""1914m3M7kRzkd5RJqAfzRY9EBcJrKemZC"",""mode"":""list"",""cachedResultName"":""Meeting Notes"",""cachedResultUrl"":""https://drive.google.com/drive/folders/1914m3M7kRzkd5RJqAfzRY9EBcJrKemZC""},""event"":""fileUpdated"",""options"":{}},""id"":""7b904686-89ae-4722-9ce5-a9da1b13b1a1"",""name"":""File Updated"",""type"":""n8n-nodes-base.googleDriveTrigger"",""typeVersion"":1,""position"":[600,1100],""credentials"":{""googleDriveOAuth2Api"":{""id"":""vzcL2pD7uQzqDpdK"",""name"":""Google Drive account""}}},{""parameters"":{""assignments"":{""assignments"":[{""id"":""10646eae-ae46-4327-a4dc-9987c2d76173"",""name"":""file_id"",""value"":""={{ $json.id }}"",""type"":""string""},{""id"":""dd0aa081-79e7-4714-8a67-1e898285554c"",""name"":""folder_id"",""value"":""={{ $json.parents[0] }}"",""type"":""string""}]},""options"":{}},""id"":""87f8bbb0-92c5-4b25-be63-7a9d91fc46f8"",""name"":""Set File ID"",""type"":""n8n-nodes-base.set"",""typeVersion"":3.4,""position"":[860,880]},{""parameters"":{""operation"":""download"",""fileId"":{""__rl"":true,""value"":""={{ $('Set File ID').item.json.file_id }}"",""mode"":""id""},""options"":{""googleFileConversion"":{""conversion"":{""docsToFormat"":""text/plain""}}}},""id"":""9f1e08fb-4ef3-4c4d-9473-5a7a1608b8e3"",""name"":""Download File"",""type"":""n8n-nodes-base.googleDrive"",""typeVersion"":3,""position"":[1300,880],""executeOnce"":true,""credentials"":{""googleDriveOAuth2Api"":{""id"":""vzcL2pD7uQzqDpdK"",""name"":""Google Drive account""}}},{""parameters"":{""operation"":""text"",""options"":{}},""id"":""7efee822-68ad-4fe2-a616-ba19fd127684"",""name"":""Extract Document Text"",""type"":""n8n-nodes-base.extractFromFile"",""typeVersion"":1,""position"":[1540,880],""alwaysOutputData"":true},{""parameters"":{""options"":{""metadata"":{""metadataValues"":[{""name"":""file_id"",""value"":""={{ $('Set File ID').item.json.file_id }}""},{""name"":""folder_id"",""value"":""={{ $('Set File ID').item.json.folder_id }}""}]}}},""id"":""da4c8b29-4944-43c4-9df3-e380366c594a"",""name"":""Default Data Loader"",""type"":""@n8n/n8n-nodes-langchain.documentDefaultDataLoader"",""typeVersion"":1,""position"":[1860,1100]},{""parameters"":{""chunkSize"":100,""options"":{}},""id"":""d11c39b9-3fa7-4d5d-838f-da0d258c67c5"",""name"":""Recursive Character Text Splitter"",""type"":""@n8n/n8n-nodes-langchain.textSplitterRecursiveCharacterTextSplitter"",""typeVersion"":1,""position"":[1860,1320]},{""parameters"":{""model"":""nomic-embed-text:latest""},""id"":""8a04559c-dfe8-479f-8998-a2e9bc994a0a"",""name"":""Embeddings Ollama1"",""type"":""@n8n/n8n-nodes-langchain.embeddingsOllama"",""typeVersion"":1,""position"":[1700,1100],""credentials"":{""ollamaApi"":{""id"":""C0BctVXe93bO063x"",""name"":""Ollama account""}}},{""parameters"":{""content"":""## Local RAG AI Agent with Chat Interface"",""height"":527.3027193303974,""width"":969.0343804425795},""id"":""a18773ae-1eb3-46b8-91cf-4184c66cf14f"",""name"":""Sticky Note2"",""type"":""n8n-nodes-base.stickyNote"",""typeVersion"":1,""position"":[560,220]},{""parameters"":{""content"":""## Agent Tools for Local RAG"",""height"":528.85546469693,""width"":583.4552380860637,""color"":4},""id"":""fa010a11-3dda-4bd5-b261-463a3a6b88d9"",""name"":""Sticky Note"",""type"":""n8n-nodes-base.stickyNote"",""typeVersion"":1,""position"":[1540,220]},{""parameters"":{""content"":""## Workflow to Create Local Knowledgebase from Google Drive Folder"",""height"":705.2695614889159,""width"":1568.9362829025763,""color"":5},""id"":""f29e6cc7-015e-47cb-a4fd-fecd6ffb0d24"",""name"":""Sticky Note1"",""type"":""n8n-nodes-base.stickyNote"",""typeVersion"":1,""position"":[560,760]},{""parameters"":{""options"":{}},""id"":""5da52326-dfbd-4350-919c-843461f58913"",""name"":""When chat message received"",""type"":""@n8n/n8n-nodes-langchain.chatTrigger"",""typeVersion"":1.1,""position"":[620,340],""webhookId"":""4b3b1838-d6b3-447e-9d79-d0931eddb9f8""},{""parameters"":{""qdrantCollection"":{""__rl"":true,""value"":""documents"",""mode"":""list"",""cachedResultName"":""documents""},""options"":{}},""id"":""355370e0-2174-4e5b-830b-dd0f123b2e40"",""name"":""Qdrant Vector Store"",""type"":""@n8n/n8n-nodes-langchain.vectorStoreQdrant"",""typeVersion"":1,""position"":[1560,480],""credentials"":{""qdrantApi"":{""id"":""VOnegFP8eijBkbNO"",""name"":""QdrantApi account""}}},{""parameters"":{""code"":{""execute"":{""code"":""const { QdrantVectorStore } = require(\""@langchain/qdrant\"");\nconst { OllamaEmbeddings } = require(\""@langchain/community/embeddings/ollama\"");\n\nconst embeddings = new OllamaEmbeddings({\n  model: \""nomic-embed-text\"",\n  baseUrl: \""http://ollama:11434\""\n});\n\nconst vectorStore = await QdrantVectorStore.fromExistingCollection(\n  embeddings,\n  {\n    url: \""http://qdrant:6333\"",\n    collectionName: \""documents\"",\n  }\n);\n\nconst fileIdToDelete = this.getInputData()[0].json.file_id;\n\nconst filter = {\n        must: [\n            {\n                key: \""metadata.file_id\"",\n                match: {\n                    value: fileIdToDelete,\n                },\n            },\n        ],\n    }\n\n// const results = await vectorStore.similaritySearch(\""this\"", 10, filter);\n// const idsToDelete = results.map((doc) => doc.id);\n\n// NOT IMPLEMENTED!\n// await vectorStore.delete({ ids: idsToDelete });\n\nvectorStore.client.delete(\""documents\"", {\n  filter\n});\n\nreturn [ {json: { file_id: fileIdToDelete } } ];\n""}},""inputs"":{""input"":[{""type"":""main"",""required"":true}]},""outputs"":{""output"":[{""type"":""main""}]}},""id"":""b93bd001-0c4d-42fe-939a-eb441f354917"",""name"":""Clear Old Vectors"",""type"":""@n8n/n8n-nodes-langchain.code"",""typeVersion"":1,""position"":[1080,880],""alwaysOutputData"":false},{""parameters"":{""mode"":""insert"",""qdrantCollection"":{""__rl"":true,""value"":""documents"",""mode"":""list"",""cachedResultName"":""documents""},""options"":{}},""id"":""97ec4618-c0ea-445b-9406-5d41784d7836"",""name"":""Qdrant Vector Store Insert"",""type"":""@n8n/n8n-nodes-langchain.vectorStoreQdrant"",""typeVersion"":1,""position"":[1760,880],""credentials"":{""qdrantApi"":{""id"":""VOnegFP8eijBkbNO"",""name"":""QdrantApi account""}}},{""parameters"":{""options"":{}},""id"":""e537544a-37d5-4b00-b5ff-bc71f041f4bb"",""name"":""Respond to Webhook"",""type"":""n8n-nodes-base.respondToWebhook"",""typeVersion"":1.1,""position"":[1340,340]},{""parameters"":{""httpMethod"":""POST"",""path"":""invoke_n8n_agent"",""responseMode"":""responseNode"",""options"":{}},""id"":""2b8cd01f-30a8-4aab-b0dd-56d2b658f059"",""name"":""Webhook"",""type"":""n8n-nodes-base.webhook"",""typeVersion"":2,""position"":[620,520],""webhookId"":""4a839da9-b8a2-45f8-bcaf-c484f9a5912d""},{""parameters"":{""options"":{}},""id"":""c9dfe906-178b-4375-8bda-f9290f35f222"",""name"":""AI Agent"",""type"":""@n8n/n8n-nodes-langchain.agent"",""typeVersion"":1.6,""position"":[1000,340]},{""parameters"":{""assignments"":{""assignments"":[{""id"":""75ebfdef-c8e2-4c3e-b716-1479d0cc2a73"",""name"":""chatInput"",""value"":""={{ $json?.chatInput || $json.body.chatInput }}"",""type"":""string""},{""id"":""59b7a20f-0626-4861-93e2-015d430c266e"",""name"":""sessionId"",""value"":""={{ $json?.sessionId || $json.body.sessionId}}"",""type"":""string""}]},""options"":{}},""id"":""8f974a15-aa2f-4525-8278-ad58ad296076"",""name"":""Edit Fields"",""type"":""n8n-nodes-base.set"",""typeVersion"":3.4,""position"":[820,340]}]","{""Postgres Chat Memory"":{""ai_memory"":[[{""node"":""AI Agent"",""type"":""ai_memory"",""index"":0}]]},""Ollama Chat Model"":{""ai_languageModel"":[[{""node"":""AI Agent"",""type"":""ai_languageModel"",""index"":0}]]},""Ollama Model"":{""ai_languageModel"":[[{""node"":""Vector Store Tool"",""type"":""ai_languageModel"",""index"":0}]]},""Embeddings Ollama"":{""ai_embedding"":[[{""node"":""Qdrant Vector Store"",""type"":""ai_embedding"",""index"":0}]]},""File Created"":{""main"":[[{""node"":""Set File ID"",""type"":""main"",""index"":0}]]},""File Updated"":{""main"":[[{""node"":""Set File ID"",""type"":""main"",""index"":0}]]},""Set File ID"":{""main"":[[{""node"":""Clear Old Vectors"",""type"":""main"",""index"":0}]]},""Download File"":{""main"":[[{""node"":""Extract Document Text"",""type"":""main"",""index"":0}]]},""Extract Document Text"":{""main"":[[{""node"":""Qdrant Vector Store Insert"",""type"":""main"",""index"":0}]]},""Default Data Loader"":{""ai_document"":[[{""node"":""Qdrant Vector Store Insert"",""type"":""ai_document"",""index"":0}]]},""Recursive Character Text Splitter"":{""ai_textSplitter"":[[{""node"":""Default Data Loader"",""type"":""ai_textSplitter"",""index"":0}]]},""Embeddings Ollama1"":{""ai_embedding"":[[{""node"":""Qdrant Vector Store Insert"",""type"":""ai_embedding"",""index"":0}]]},""When chat message received"":{""main"":[[{""node"":""Edit Fields"",""type"":""main"",""index"":0}]]},""Qdrant Vector Store"":{""ai_vectorStore"":[[{""node"":""Vector Store Tool"",""type"":""ai_vectorStore"",""index"":0}]]},""Clear Old Vectors"":{""main"":[[{""node"":""Download File"",""type"":""main"",""index"":0}]]},""Webhook"":{""main"":[[{""node"":""Edit Fields"",""type"":""main"",""index"":0}]]},""AI Agent"":{""main"":[[{""node"":""Respond to Webhook"",""type"":""main"",""index"":0}]]},""Edit Fields"":{""main"":[[{""node"":""AI Agent"",""type"":""main"",""index"":0}]]},""Vector Store Tool"":{""ai_tool"":[[{""node"":""AI Agent"",""type"":""ai_tool"",""index"":0}]]}}",2025-03-22 10:29:54.748+00,2025-03-22 12:10:25.509+00,"{""executionOrder"":""v1""}",,{},19f9691c-4682-4704-81f2-33fdec9d0be2,0,vTN9y2dLXqTiDfPT,"{""templateCredsSetupCompleted"":true,""instanceId"":""f722e3e1e81e942a38faa434ad0aee8699371bbff9f883b9d5c59a7c726605af""}",
V2 Supabase RAG AI Agent,f,"[{""parameters"":{},""id"":""3e70b57d-49fb-4cb0-8f9f-29d39adf6a65"",""name"":""Postgres Chat Memory"",""type"":""@n8n/n8n-nodes-langchain.memoryPostgresChat"",""typeVersion"":1.1,""position"":[480,340],""credentials"":{""postgres"":{""id"":""i83SgkPKmlQ785tT"",""name"":""Postgres account""}}},{""parameters"":{""model"":""qwen2.5:7b-instruct-q4_K_M"",""options"":{}},""id"":""8d61de27-45d8-4d10-97cc-3c36d224f865"",""name"":""Ollama Chat Model"",""type"":""@n8n/n8n-nodes-langchain.lmChatOllama"",""typeVersion"":1,""position"":[360,340],""credentials"":{""ollamaApi"":{""id"":""C0BctVXe93bO063x"",""name"":""Ollama account""}}},{""parameters"":{""model"":""qwen2.5:7b-instruct-q4_K_M"",""options"":{}},""id"":""cbd5b56f-7afc-4e83-a221-6be4d348374e"",""name"":""Ollama Model"",""type"":""@n8n/n8n-nodes-langchain.lmOllama"",""typeVersion"":1,""position"":[1400,280],""credentials"":{""ollamaApi"":{""id"":""C0BctVXe93bO063x"",""name"":""Ollama account""}}},{""parameters"":{""name"":""documents"",""topK"":3},""id"":""c15bd0a8-286a-4076-8ce8-8c0e54f73e2a"",""name"":""Vector Store Tool"",""type"":""@n8n/n8n-nodes-langchain.toolVectorStore"",""typeVersion"":1,""position"":[1180,100]},{""parameters"":{""operation"":""text"",""destinationKey"":""=data"",""options"":{}},""id"":""ab9fb44a-85c6-486b-b5de-0f9d768d91b2"",""name"":""Extract Document Text"",""type"":""n8n-nodes-base.extractFromFile"",""typeVersion"":1,""position"":[920,640],""alwaysOutputData"":true},{""parameters"":{""options"":{""metadata"":{""metadataValues"":[{""name"":""file_id"",""value"":""={{ $('Local File Trigger').item.json.path }}""}]}}},""id"":""b5abf0a5-f62a-49a6-bf81-bf002ba4bb90"",""name"":""Default Data Loader"",""type"":""@n8n/n8n-nodes-langchain.documentDefaultDataLoader"",""typeVersion"":1,""position"":[1300,880]},{""parameters"":{""chunkSize"":100,""options"":{}},""id"":""1e2791c1-86e7-4fe1-a76d-732f87e6f41a"",""name"":""Recursive Character Text Splitter"",""type"":""@n8n/n8n-nodes-langchain.textSplitterRecursiveCharacterTextSplitter"",""typeVersion"":1,""position"":[1300,1100]},{""parameters"":{""model"":""nomic-embed-text:latest""},""id"":""909713ea-5be3-4916-b12e-a8e848c949cb"",""name"":""Embeddings Ollama1"",""type"":""@n8n/n8n-nodes-langchain.embeddingsOllama"",""typeVersion"":1,""position"":[1140,880],""credentials"":{""ollamaApi"":{""id"":""C0BctVXe93bO063x"",""name"":""Ollama account""}}},{""parameters"":{""content"":""## Local RAG AI Agent with Chat Interface"",""height"":527.3027193303974,""width"":969.0343804425795},""id"":""de473f2f-b806-45bc-a0e0-2ef0d2aa9b55"",""name"":""Sticky Note2"",""type"":""n8n-nodes-base.stickyNote"",""typeVersion"":1,""position"":[0,0]},{""parameters"":{""content"":""## Agent Tools for Local RAG"",""height"":528.85546469693,""width"":583.4552380860637,""color"":4},""id"":""b23ef570-f642-4503-87b9-3494ffdbf768"",""name"":""Sticky Note"",""type"":""n8n-nodes-base.stickyNote"",""typeVersion"":1,""position"":[980,0]},{""parameters"":{""content"":""## Workflow to Create Local Knowledgebase"",""height"":705.2695614889159,""width"":1568.9362829025763,""color"":5},""id"":""836cd765-dae8-460e-951d-66e19d0cce77"",""name"":""Sticky Note1"",""type"":""n8n-nodes-base.stickyNote"",""typeVersion"":1,""position"":[0,540]},{""parameters"":{""options"":{}},""id"":""f8b5039c-4b00-453a-b30e-31a59f5d36ad"",""name"":""When chat message received"",""type"":""@n8n/n8n-nodes-langchain.chatTrigger"",""typeVersion"":1.1,""position"":[60,120],""webhookId"":""4b3b1838-d6b3-447e-9d79-d0931eddb9f8""},{""parameters"":{""options"":{}},""id"":""2f64907b-42ef-4bd6-83ba-e97584271bc7"",""name"":""Respond to Webhook"",""type"":""n8n-nodes-base.respondToWebhook"",""typeVersion"":1.1,""position"":[780,120]},{""parameters"":{""httpMethod"":""POST"",""path"":""invoke_n8n_agent"",""responseMode"":""responseNode"",""options"":{}},""id"":""9a30041f-0c14-41d8-a811-229b890bb1b7"",""name"":""Webhook"",""type"":""n8n-nodes-base.webhook"",""typeVersion"":2,""position"":[60,300],""webhookId"":""4a839da9-b8a2-45f8-bcaf-c484f9a5912d""},{""parameters"":{""options"":{}},""id"":""8311e22f-bddd-41f8-9d40-fde119126dc9"",""name"":""AI Agent"",""type"":""@n8n/n8n-nodes-langchain.agent"",""typeVersion"":1.6,""position"":[440,120]},{""parameters"":{""assignments"":{""assignments"":[{""id"":""75ebfdef-c8e2-4c3e-b716-1479d0cc2a73"",""name"":""chatInput"",""value"":""={{ $json?.chatInput || $json.body.chatInput }}"",""type"":""string""},{""id"":""59b7a20f-0626-4861-93e2-015d430c266e"",""name"":""sessionId"",""value"":""={{ $json?.sessionId || $json.body.sessionId}}"",""type"":""string""}]},""options"":{}},""id"":""4988a14f-a2ea-4c4b-8f66-0f1773e11ea0"",""name"":""Edit Fields"",""type"":""n8n-nodes-base.set"",""typeVersion"":3.4,""position"":[260,120]},{""parameters"":{""tableName"":{""__rl"":true,""value"":""documents"",""mode"":""list"",""cachedResultName"":""documents""},""options"":{""queryName"":""match_documents""}},""type"":""@n8n/n8n-nodes-langchain.vectorStoreSupabase"",""typeVersion"":1,""position"":[1000,240],""id"":""9841944a-5a85-437d-a9ed-a3e7393d7a8d"",""name"":""Supabase Vector Store"",""credentials"":{""supabaseApi"":{""id"":""3tjCDwujGZ7BlK7R"",""name"":""Supabase account""}}},{""parameters"":{""model"":""nomic-embed-text:latest""},""type"":""@n8n/n8n-nodes-langchain.embeddingsOllama"",""typeVersion"":1,""position"":[1180,380],""id"":""24e6e703-33c2-426d-ab59-7c9cad0fded9"",""name"":""Embeddings Ollama2"",""credentials"":{""ollamaApi"":{""id"":""C0BctVXe93bO063x"",""name"":""Ollama account""}}},{""parameters"":{""mode"":""insert"",""tableName"":{""__rl"":true,""value"":""documents"",""mode"":""list"",""cachedResultName"":""documents""},""options"":{""queryName"":""match_documents""}},""type"":""@n8n/n8n-nodes-langchain.vectorStoreSupabase"",""typeVersion"":1,""position"":[1180,640],""id"":""d72c6f38-7766-4a10-9897-362539a6bcc0"",""name"":""Supabase Vector Store1"",""credentials"":{""supabaseApi"":{""id"":""3tjCDwujGZ7BlK7R"",""name"":""Supabase account""}}},{""parameters"":{""operation"":""delete"",""tableId"":""documents"",""filterType"":""string"",""filterString"":""=metadata->>file_id=like.*{{ $json.path }}*""},""id"":""ab0e0395-9f88-438f-bc47-ea3913b869fe"",""name"":""Delete Old Doc Rows"",""type"":""n8n-nodes-base.supabase"",""typeVersion"":1,""position"":[460,840],""alwaysOutputData"":true,""credentials"":{""supabaseApi"":{""id"":""3tjCDwujGZ7BlK7R"",""name"":""Supabase account""}}},{""parameters"":{""triggerOn"":""folder"",""path"":""/data/shared"",""events"":[""add"",""change""],""options"":{""followSymlinks"":true,""usePolling"":true}},""type"":""n8n-nodes-base.localFileTrigger"",""typeVersion"":1,""position"":[60,840],""id"":""eba68fe1-738d-451b-a2a7-9ee2942dd727"",""name"":""Local File Trigger""},{""parameters"":{""fileSelector"":""={{ $('Local File Trigger').item.json.path }}"",""options"":{""dataPropertyName"":""=data""}},""type"":""n8n-nodes-base.readWriteFile"",""typeVersion"":1,""position"":[640,640],""id"":""b9459d4d-836c-47c4-9651-ebf3129f8864"",""name"":""Read/Write Files from Disk"",""executeOnce"":true},{""parameters"":{""conditions"":{""options"":{""caseSensitive"":true,""leftValue"":"""",""typeValidation"":""strict"",""version"":2},""conditions"":[{""id"":""e051736f-949a-4230-bf32-c9ade2674b12"",""leftValue"":""={{ $json.event }}"",""rightValue"":""add"",""operator"":{""type"":""string"",""operation"":""equals"",""name"":""filter.operator.equals""}}],""combinator"":""and""},""options"":{}},""type"":""n8n-nodes-base.if"",""typeVersion"":2.2,""position"":[280,660],""id"":""27123d6a-e27a-49a9-bd73-8a27235928ea"",""name"":""If""}]","{""Postgres Chat Memory"":{""ai_memory"":[[{""node"":""AI Agent"",""type"":""ai_memory"",""index"":0}]]},""Ollama Chat Model"":{""ai_languageModel"":[[{""node"":""AI Agent"",""type"":""ai_languageModel"",""index"":0}]]},""Ollama Model"":{""ai_languageModel"":[[{""node"":""Vector Store Tool"",""type"":""ai_languageModel"",""index"":0}]]},""Extract Document Text"":{""main"":[[{""node"":""Supabase Vector Store1"",""type"":""main"",""index"":0}]]},""Default Data Loader"":{""ai_document"":[[{""node"":""Supabase Vector Store1"",""type"":""ai_document"",""index"":0}]]},""Recursive Character Text Splitter"":{""ai_textSplitter"":[[{""node"":""Default Data Loader"",""type"":""ai_textSplitter"",""index"":0}]]},""Embeddings Ollama1"":{""ai_embedding"":[[{""node"":""Supabase Vector Store1"",""type"":""ai_embedding"",""index"":0}]]},""When chat message received"":{""main"":[[{""node"":""Edit Fields"",""type"":""main"",""index"":0}]]},""Webhook"":{""main"":[[{""node"":""Edit Fields"",""type"":""main"",""index"":0}]]},""AI Agent"":{""main"":[[{""node"":""Respond to Webhook"",""type"":""main"",""index"":0}]]},""Edit Fields"":{""main"":[[{""node"":""AI Agent"",""type"":""main"",""index"":0}]]},""Vector Store Tool"":{""ai_tool"":[[{""node"":""AI Agent"",""type"":""ai_tool"",""index"":0}]]},""Supabase Vector Store"":{""ai_vectorStore"":[[{""node"":""Vector Store Tool"",""type"":""ai_vectorStore"",""index"":0}]]},""Embeddings Ollama2"":{""ai_embedding"":[[{""node"":""Supabase Vector Store"",""type"":""ai_embedding"",""index"":0}]]},""Delete Old Doc Rows"":{""main"":[[{""node"":""Read/Write Files from Disk"",""type"":""main"",""index"":0}]]},""Local File Trigger"":{""main"":[[{""node"":""If"",""type"":""main"",""index"":0}]]},""Read/Write Files from Disk"":{""main"":[[{""node"":""Extract Document Text"",""type"":""main"",""index"":0}]]},""If"":{""main"":[[{""node"":""Read/Write Files from Disk"",""type"":""main"",""index"":0}],[{""node"":""Delete Old Doc Rows"",""type"":""main"",""index"":0}]]}}",2025-03-22 10:29:54.748+00,2025-03-22 12:10:25.509+00,"{""executionOrder"":""v1""}",,{},ea9ff68c-8fc0-40b0-aa5d-48217cda89f3,0,hrnPh6dXgIbGVzIk,"{""instanceId"":""73cb7a3e883df514bb47e8d1b34526d30e2abb8f56cd99f10d5948a1e11b25aa""}",
V3 Local Agentic RAG AI Agent,f,"[{""parameters"":{""jsonMode"":""expressionData"",""jsonData"":""={{ $json.data || $json.text || $json.concatenated_data }}"",""options"":{""metadata"":{""metadataValues"":[{""name"":""=file_id"",""value"":""={{ $('Set File ID').first().json.file_id }}""},{""name"":""file_title"",""value"":""={{ $('Set File ID').first().json.file_title }}""}]}}},""id"":""55f9647b-a2b2-4b19-97d2-ddc8864e440b"",""name"":""Default Data Loader"",""type"":""@n8n/n8n-nodes-langchain.documentDefaultDataLoader"",""typeVersion"":1,""position"":[1000,1140]},{""parameters"":{""content"":""## Agent Tools for RAG"",""height"":528.85546469693,""width"":583.4552380860637,""color"":4},""id"":""ceb2c823-1cce-4813-85e6-c3e638e68091"",""name"":""Sticky Note"",""type"":""n8n-nodes-base.stickyNote"",""typeVersion"":1,""position"":[0,0]},{""parameters"":{""content"":""## Tool to Add a Google Drive File to Vector DB"",""height"":867,""width"":3073,""color"":5},""id"":""7bbc9f6b-ac99-471f-8bce-72427a4f775e"",""name"":""Sticky Note1"",""type"":""n8n-nodes-base.stickyNote"",""typeVersion"":1,""position"":[-1740,540]},{""parameters"":{""operation"":""text"",""options"":{}},""id"":""f80a6769-d48d-4bd9-a6fc-ca718a2ef4b9"",""name"":""Extract Document Text"",""type"":""n8n-nodes-base.extractFromFile"",""typeVersion"":1,""position"":[200,1140],""alwaysOutputData"":true},{""parameters"":{},""id"":""1f5d7294-b47e-41fe-99d7-7f79617c76cd"",""name"":""Postgres Chat Memory"",""type"":""@n8n/n8n-nodes-langchain.memoryPostgresChat"",""typeVersion"":1,""position"":[-600,360],""notesInFlow"":false,""credentials"":{""postgres"":{""id"":""i83SgkPKmlQ785tT"",""name"":""Postgres account""}}},{""parameters"":{""assignments"":{""assignments"":[{""id"":""10646eae-ae46-4327-a4dc-9987c2d76173"",""name"":""file_id"",""value"":""={{ $json.path }}"",""type"":""string""},{""id"":""f4536df5-d0b1-4392-bf17-b8137fb31a44"",""name"":""file_type"",""value"":""={{ $json.path.split(/[\\\\/]/).pop().split('.').pop(); }}"",""type"":""string""},{""id"":""77d782de-169d-4a46-8a8e-a3831c04d90f"",""name"":""file_title"",""value"":""={{ $json.path.split(/[\\\\/]/).pop().split('.').slice(0, -1).join('.'); }}"",""type"":""string""}]},""options"":{}},""id"":""5f283705-2576-4756-88fb-120463c3b69b"",""name"":""Set File ID"",""type"":""n8n-nodes-base.set"",""typeVersion"":3.4,""position"":[-1320,820]},{""parameters"":{""content"":""## RAG AI Agent with Chat Interface"",""height"":464.8027193303974,""width"":1035.6381264595484},""id"":""dc23d387-98e7-421d-b277-60dfbe06c501"",""name"":""Sticky Note2"",""type"":""n8n-nodes-base.stickyNote"",""typeVersion"":1,""position"":[-1040,60]},{""parameters"":{""options"":{}},""id"":""f285aab4-53d1-46a9-9e22-2686f082a374"",""name"":""Respond to Webhook"",""type"":""n8n-nodes-base.respondToWebhook"",""typeVersion"":1.1,""position"":[-180,140]},{""parameters"":{""assignments"":{""assignments"":[{""id"":""9a9a245e-f1a1-4282-bb02-a81ffe629f0f"",""name"":""chatInput"",""value"":""={{ $json?.chatInput || $json.body.chatInput }}"",""type"":""string""},{""id"":""b80831d8-c653-4203-8706-adedfdb98f77"",""name"":""sessionId"",""value"":""={{ $json?.sessionId || $json.body.sessionId}}"",""type"":""string""}]},""options"":{}},""id"":""129c23bf-c9dc-4b87-820f-3f371f5a420d"",""name"":""Edit Fields"",""type"":""n8n-nodes-base.set"",""typeVersion"":3.4,""position"":[-740,140]},{""parameters"":{""public"":true,""options"":{}},""id"":""fffe770f-5fe3-4ded-8aed-5d628a5e622f"",""name"":""When chat message received"",""type"":""@n8n/n8n-nodes-langchain.chatTrigger"",""typeVersion"":1.1,""position"":[-1000,140],""webhookId"":""e104e40e-6134-4825-a6f0-8a646d882662""},{""parameters"":{""httpMethod"":""POST"",""path"":""bf4dd093-bb02-472c-9454-7ab9af97bd1d"",""responseMode"":""responseNode"",""options"":{}},""id"":""5eb1415f-4d37-4e63-8914-f370ae12d275"",""name"":""Webhook"",""type"":""n8n-nodes-base.webhook"",""typeVersion"":2,""position"":[-1000,340],""webhookId"":""bf4dd093-bb02-472c-9454-7ab9af97bd1d""},{""parameters"":{""operation"":""pdf"",""options"":{}},""id"":""d050553b-da5c-4250-8f25-0300f49099cc"",""name"":""Extract PDF Text"",""type"":""n8n-nodes-base.extractFromFile"",""typeVersion"":1,""position"":[200,580]},{""parameters"":{""aggregate"":""aggregateAllItemData"",""options"":{}},""id"":""8f5f530e-186a-4788-86d1-cb41d0400286"",""name"":""Aggregate"",""type"":""n8n-nodes-base.aggregate"",""typeVersion"":1,""position"":[240,760]},{""parameters"":{""fieldsToSummarize"":{""values"":[{""aggregation"":""concatenate"",""field"":""data""}]},""options"":{}},""id"":""50cb0e47-5857-4a27-a1a4-12357ba50420"",""name"":""Summarize"",""type"":""n8n-nodes-base.summarize"",""typeVersion"":1,""position"":[440,840]},{""parameters"":{""promptType"":""define"",""text"":""={{ $json.chatInput }}"",""options"":{""systemMessage"":""You are a personal assistant who helps answer questions from a corpus of documents. The documents are either text based (Txt, docs, extracted PDFs, etc.) or tabular data (CSVs or Excel documents).\n\nYou are given tools to perform RAG in the 'documents' table, look up the documents available in your knowledge base in the 'document_metadata' table, extract all the text from a given document, and query the tabular files with SQL in the 'document_rows' table.\n\nAlways start by performing RAG unless the users asks you to check a document or the question requires a SQL query for tabular data (fetching a sum, finding a max, something a RAG lookup would be unreliable for). If RAG doesn't help, then look at the documents that are available to you, find a few that you think would contain the answer, and then analyze those.\n\nAlways tell the user if you didn't find the answer. Don't make something up just to please them.""}},""id"":""8d6daa23-a646-4592-a449-02cf50e2c953"",""name"":""RAG AI Agent"",""type"":""@n8n/n8n-nodes-langchain.agent"",""typeVersion"":1.6,""position"":[-520,140]},{""parameters"":{""rules"":{""values"":[{""conditions"":{""options"":{""caseSensitive"":true,""leftValue"":"""",""typeValidation"":""strict"",""version"":1},""conditions"":[{""leftValue"":""={{ $('Set File ID').item.json.file_type }}"",""rightValue"":""pdf"",""operator"":{""type"":""string"",""operation"":""equals""}}],""combinator"":""and""}},{""conditions"":{""options"":{""caseSensitive"":true,""leftValue"":"""",""typeValidation"":""strict"",""version"":1},""conditions"":[{""id"":""2ae7faa7-a936-4621-a680-60c512163034"",""leftValue"":""={{ $('Set File ID').item.json.file_type }}"",""rightValue"":""xlsx"",""operator"":{""type"":""string"",""operation"":""equals"",""name"":""filter.operator.equals""}}],""combinator"":""and""}},{""conditions"":{""options"":{""caseSensitive"":true,""leftValue"":"""",""typeValidation"":""strict"",""version"":1},""conditions"":[{""id"":""fc193b06-363b-4699-a97d-e5a850138b0e"",""leftValue"":""={{ $('Set File ID').item.json.file_type }}"",""rightValue"":""=csv"",""operator"":{""type"":""string"",""operation"":""equals"",""name"":""filter.operator.equals""}}],""combinator"":""and""}},{""conditions"":{""options"":{""caseSensitive"":true,""leftValue"":"""",""typeValidation"":""strict"",""version"":1},""conditions"":[{""id"":""b69f5605-0179-4b02-9a32-e34bb085f82d"",""leftValue"":""={{ $('Set File ID').item.json.file_type }}"",""rightValue"":""txt"",""operator"":{""type"":""string"",""operation"":""equals"",""name"":""filter.operator.equals""}}],""combinator"":""and""}}]},""options"":{""fallbackOutput"":3}},""id"":""a381554d-5628-44dc-8e8c-fae60d6860b0"",""name"":""Switch"",""type"":""n8n-nodes-base.switch"",""typeVersion"":3,""position"":[-460,800]},{""parameters"":{""operation"":""xlsx"",""options"":{}},""id"":""713308e3-f35f-4657-b6fb-06882b178102"",""name"":""Extract from Excel"",""type"":""n8n-nodes-base.extractFromFile"",""typeVersion"":1,""position"":[20,760]},{""parameters"":{""assignments"":{""assignments"":[{""id"":""f422e2e0-381c-46ea-8f38-3f58c501d8b9"",""name"":""schema"",""value"":""={{ $('Extract from Excel').isExecuted ? $('Extract from Excel').first().json.keys().toJsonString() : $('Extract from CSV').first().json.keys().toJsonString() }}"",""type"":""string""},{""id"":""bb07c71e-5b60-4795-864c-cc3845b6bc46"",""name"":""data"",""value"":""={{ $json.concatenated_data }}"",""type"":""string""}]},""options"":{}},""type"":""n8n-nodes-base.set"",""typeVersion"":3.4,""position"":[880,700],""id"":""068f0564-7f2b-40df-8a82-ddfff6ac3192"",""name"":""Set Schema""},{""parameters"":{""options"":{}},""type"":""n8n-nodes-base.extractFromFile"",""typeVersion"":1,""position"":[20,940],""id"":""9cc88ee0-a065-4bee-a6d8-135c433da188"",""name"":""Extract from CSV""},{""parameters"":{""content"":""## Run Each Node Once to Set Up Database Tables"",""height"":300,""width"":680,""color"":3},""type"":""n8n-nodes-base.stickyNote"",""position"":[-1740,220],""typeVersion"":1,""id"":""452a79b7-d5fe-4d5d-b32f-9df1d714423d"",""name"":""Sticky Note3""},{""parameters"":{""operation"":""executeQuery"",""query"":""CREATE TABLE document_metadata (\n    id TEXT PRIMARY KEY,\n    title TEXT,\n    created_at TIMESTAMP DEFAULT NOW(),\n    schema TEXT\n);"",""options"":{}},""type"":""n8n-nodes-base.postgres"",""typeVersion"":2.5,""position"":[-1620,320],""id"":""8d137c72-d6b5-4f91-a114-8d9f1777411b"",""name"":""Create Document Metadata Table"",""credentials"":{""postgres"":{""id"":""i83SgkPKmlQ785tT"",""name"":""Postgres account""}}},{""parameters"":{""operation"":""executeQuery"",""query"":""CREATE TABLE document_rows (\n    id SERIAL PRIMARY KEY,\n    dataset_id TEXT REFERENCES document_metadata(id),\n    row_data JSONB  -- Store the actual row data\n);"",""options"":{}},""type"":""n8n-nodes-base.postgres"",""typeVersion"":2.5,""position"":[-1320,320],""id"":""ddd63d7b-b7e7-4af5-9b2d-72898ca9b63a"",""name"":""Create Document Rows Table (for Tabular Data)"",""credentials"":{""postgres"":{""id"":""i83SgkPKmlQ785tT"",""name"":""Postgres account""}}},{""parameters"":{""descriptionType"":""manual"",""toolDescription"":""Use this tool to fetch all available documents, including the table schema if the file is a CSV or Excel file."",""operation"":""select"",""schema"":{""__rl"":true,""mode"":""list"",""value"":""public""},""table"":{""__rl"":true,""value"":""document_metadata"",""mode"":""list"",""cachedResultName"":""document_metadata""},""returnAll"":true,""options"":{}},""type"":""n8n-nodes-base.postgresTool"",""typeVersion"":2.5,""position"":[-460,360],""id"":""e5223ab2-36fe-4294-9acc-14acefa716e4"",""name"":""List Documents"",""credentials"":{""postgres"":{""id"":""i83SgkPKmlQ785tT"",""name"":""Postgres account""}}},{""parameters"":{""descriptionType"":""manual"",""toolDescription"":""Given a file ID, fetches the text from the document."",""operation"":""executeQuery"",""query"":""SELECT \n    string_agg(text, ' ') as document_text\nFROM documents_pg\n  WHERE metadata->>'file_id' = $1\nGROUP BY metadata->>'file_id';"",""options"":{""queryReplacement"":""={{ $fromAI('file_id') }}""}},""type"":""n8n-nodes-base.postgresTool"",""typeVersion"":2.5,""position"":[-320,360],""id"":""7d4eb63b-3b03-4d89-ad19-9a57f1a7cd84"",""name"":""Get File Contents"",""credentials"":{""postgres"":{""id"":""i83SgkPKmlQ785tT"",""name"":""Postgres account""}}},{""parameters"":{""descriptionType"":""manual"",""toolDescription"":""Run a SQL query - use this to query from the document_rows table once you know the file ID (which is the file path) you are querying. dataset_id is the file_id (file path) and you are always using the row_data for filtering, which is a jsonb field that has all the keys from the file schema given in the document_metadata table.\n\nExample query:\n\nSELECT AVG((row_data->>'revenue')::numeric)\nFROM document_rows\nWHERE dataset_id = '/data/shared/document.csv';\n\nExample query 2:\n\nSELECT \n    row_data->>'category' as category,\n    SUM((row_data->>'sales')::numeric) as total_sales\nFROM dataset_rows\nWHERE dataset_id = '/data/shared/document2.csv'\nGROUP BY row_data->>'category';"",""operation"":""executeQuery"",""query"":""{{ $fromAI('sql_query') }}"",""options"":{}},""type"":""n8n-nodes-base.postgresTool"",""typeVersion"":2.5,""position"":[-160,360],""id"":""07c5525b-ae30-4c1f-b3e2-a6db965c25cf"",""name"":""Query Document Rows"",""credentials"":{""postgres"":{""id"":""i83SgkPKmlQ785tT"",""name"":""Postgres account""}}},{""parameters"":{""options"":{""reset"":false}},""type"":""n8n-nodes-base.splitInBatches"",""typeVersion"":3,""position"":[-1500,660],""id"":""933204fb-4c04-4217-8045-85358e9c9b0f"",""name"":""Loop Over Items""},{""parameters"":{""operation"":""upsert"",""schema"":{""__rl"":true,""mode"":""list"",""value"":""public""},""table"":{""__rl"":true,""value"":""document_metadata"",""mode"":""list"",""cachedResultName"":""document_metadata""},""columns"":{""mappingMode"":""defineBelow"",""value"":{""id"":""={{ $('Set File ID').item.json.file_id }}"",""title"":""={{ $('Set File ID').item.json.file_title }}""},""matchingColumns"":[""id""],""schema"":[{""id"":""id"",""displayName"":""id"",""required"":true,""defaultMatch"":true,""display"":true,""type"":""string"",""canBeUsedToMatch"":true,""removed"":false},{""id"":""title"",""displayName"":""title"",""required"":false,""defaultMatch"":false,""display"":true,""type"":""string"",""canBeUsedToMatch"":false},{""id"":""url"",""displayName"":""url"",""required"":false,""defaultMatch"":false,""display"":true,""type"":""string"",""canBeUsedToMatch"":false,""removed"":true},{""id"":""created_at"",""displayName"":""created_at"",""required"":false,""defaultMatch"":false,""display"":true,""type"":""dateTime"",""canBeUsedToMatch"":false},{""id"":""schema"",""displayName"":""schema"",""required"":false,""defaultMatch"":false,""display"":true,""type"":""string"",""canBeUsedToMatch"":false,""removed"":true}],""attemptToConvertTypes"":false,""convertFieldsToString"":false},""options"":{}},""type"":""n8n-nodes-base.postgres"",""typeVersion"":2.5,""position"":[-820,680],""id"":""e2be1ad8-b54c-456f-814a-6d19808b0343"",""name"":""Insert Document Metadata"",""executeOnce"":true,""credentials"":{""postgres"":{""id"":""i83SgkPKmlQ785tT"",""name"":""Postgres account""}}},{""parameters"":{""schema"":{""__rl"":true,""mode"":""list"",""value"":""public""},""table"":{""__rl"":true,""value"":""document_rows"",""mode"":""list"",""cachedResultName"":""document_rows""},""columns"":{""mappingMode"":""defineBelow"",""value"":{""dataset_id"":""={{ $('Set File ID').item.json.file_id }}"",""row_data"":""={{ $json.toJsonString().replaceAll(/'/g, \""''\"") }}""},""matchingColumns"":[""id""],""schema"":[{""id"":""id"",""displayName"":""id"",""required"":false,""defaultMatch"":true,""display"":true,""type"":""number"",""canBeUsedToMatch"":true,""removed"":true},{""id"":""dataset_id"",""displayName"":""dataset_id"",""required"":false,""defaultMatch"":false,""display"":true,""type"":""string"",""canBeUsedToMatch"":true,""removed"":false},{""id"":""row_data"",""displayName"":""row_data"",""required"":false,""defaultMatch"":false,""display"":true,""type"":""object"",""canBeUsedToMatch"":true,""removed"":false}],""attemptToConvertTypes"":false,""convertFieldsToString"":false},""options"":{}},""type"":""n8n-nodes-base.postgres"",""typeVersion"":2.5,""position"":[240,940],""id"":""be314c88-6e7d-4229-9d06-cba976ce0ca1"",""name"":""Insert Table Rows"",""credentials"":{""postgres"":{""id"":""i83SgkPKmlQ785tT"",""name"":""Postgres account""}}},{""parameters"":{""operation"":""upsert"",""schema"":{""__rl"":true,""mode"":""list"",""value"":""public""},""table"":{""__rl"":true,""value"":""document_metadata"",""mode"":""list"",""cachedResultName"":""document_metadata""},""columns"":{""mappingMode"":""defineBelow"",""value"":{""id"":""={{ $('Set File ID').item.json.file_id }}"",""schema"":""={{ $json.schema }}""},""matchingColumns"":[""id""],""schema"":[{""id"":""id"",""displayName"":""id"",""required"":true,""defaultMatch"":true,""display"":true,""type"":""string"",""canBeUsedToMatch"":true,""removed"":false},{""id"":""title"",""displayName"":""title"",""required"":false,""defaultMatch"":false,""display"":true,""type"":""string"",""canBeUsedToMatch"":false,""removed"":true},{""id"":""url"",""displayName"":""url"",""required"":false,""defaultMatch"":false,""display"":true,""type"":""string"",""canBeUsedToMatch"":false,""removed"":true},{""id"":""created_at"",""displayName"":""created_at"",""required"":false,""defaultMatch"":false,""display"":true,""type"":""dateTime"",""canBeUsedToMatch"":false},{""id"":""schema"",""displayName"":""schema"",""required"":false,""defaultMatch"":false,""display"":true,""type"":""string"",""canBeUsedToMatch"":false,""removed"":false}],""attemptToConvertTypes"":false,""convertFieldsToString"":false},""options"":{}},""type"":""n8n-nodes-base.postgres"",""typeVersion"":2.5,""position"":[1100,700],""id"":""72eb8ed6-de71-4e46-bdaf-fb8ca48225ab"",""name"":""Update Schema for Document Metadata"",""credentials"":{""postgres"":{""id"":""i83SgkPKmlQ785tT"",""name"":""Postgres account""}}},{""parameters"":{""content"":""## 🚀 n8n Local AI Agentic RAG Template\n\n**Author:** [Cole Medin](https://www.youtube.com/@ColeMedin)\n\n## What is this?\nThis template provides an entirely local implementation of an **Agentic RAG (Retrieval Augmented Generation)** system in n8n that can be extended easily for your specific use case and knowledge base. Unlike standard RAG which only performs simple lookups, this agent can reason about your knowledge base, self-improve retrieval, and dynamically switch between different tools based on the specific question. This workflow can be used with the [local AI package](https://github.com/coleam00/local-ai-packaged) for your LLMs (Ollama) and database (Supabase or \""vanilla\"" Postgres).\n\n## Why Agentic RAG?\nStandard RAG has significant limitations:\n- Poor analysis of numerical/tabular data\n- Missing context due to document chunking\n- Inability to connect information across documents\n- No dynamic tool selection based on question type\n\n## What makes this template powerful:\n- **Intelligent tool selection**: Switches between RAG lookups, SQL queries, or full document retrieval based on the question\n- **Complete document context**: Accesses entire documents when needed instead of just chunks\n- **Accurate numerical analysis**: Uses SQL for precise calculations on spreadsheet/tabular data\n- **Cross-document insights**: Connects information across your entire knowledge base\n- **Multi-file processing**: Handles multiple documents in a single workflow loop\n- **Efficient storage**: Uses JSONB in Supabase to store tabular data without creating new tables for each CSV\n\n## Getting Started\n1. Run the table creation nodes first to set up your database tables in Supabase\n2. Upload your documents to the folder on your computer that is mounted to /data/shared in the n8n container. This folder by default is the \""shared\"" folder in the local AI package.\n3. The agent will process them automatically (chunking text, storing tabular data in Supabase)\n4. Start asking questions that leverage the agent's multiple reasoning approaches\n\n## Customization\nThis template provides a solid foundation that you can extend by:\n- Tuning the system prompt for your specific use case\n- Adding document metadata like summaries\n- Implementing more advanced RAG techniques\n- Optimizing for larger knowledge bases\n\n---\n\nThe non-local (\""cloud\"") version of this Agentic RAG agent can be [found here](https://github.com/coleam00/ottomator-agents/tree/main/n8n-agentic-rag-agent)."",""height"":1320,""width"":540,""color"":6},""type"":""n8n-nodes-base.stickyNote"",""position"":[-2300,-140],""typeVersion"":1,""id"":""69bc6648-74a5-4f24-8539-63fdc890bf8e"",""name"":""Sticky Note9""},{""parameters"":{""triggerOn"":""folder"",""path"":""/data/shared"",""events"":[""add"",""change""],""options"":{""followSymlinks"":true,""usePolling"":true}},""type"":""n8n-nodes-base.localFileTrigger"",""typeVersion"":1,""position"":[-1700,660],""id"":""c0039541-9e7b-487b-bf8a-4917fcc5b9dd"",""name"":""Local File Trigger""},{""parameters"":{""fileSelector"":""={{ $('Set File ID').item.json.file_id }}"",""options"":{""dataPropertyName"":""=data""}},""type"":""n8n-nodes-base.readWriteFile"",""typeVersion"":1,""position"":[-660,820],""id"":""3f1993e1-77f9-4983-8eff-446f8a39d1a7"",""name"":""Read/Write Files from Disk""},{""parameters"":{""model"":""nomic-embed-text:latest""},""type"":""@n8n/n8n-nodes-langchain.embeddingsOllama"",""typeVersion"":1,""position"":[760,1140],""id"":""a6c810f0-c564-4faa-8c69-fc22ef4f1156"",""name"":""Embeddings Ollama"",""credentials"":{""ollamaApi"":{""id"":""C0BctVXe93bO063x"",""name"":""Ollama account""}}},{""parameters"":{""model"":""nomic-embed-text:latest""},""type"":""@n8n/n8n-nodes-langchain.embeddingsOllama"",""typeVersion"":1,""position"":[260,340],""id"":""31c8cf4e-525f-47e4-a499-73a0cbf4f6e5"",""name"":""Embeddings Ollama1"",""credentials"":{""ollamaApi"":{""id"":""C0BctVXe93bO063x"",""name"":""Ollama account""}}},{""parameters"":{""chunkSize"":400,""options"":{}},""type"":""@n8n/n8n-nodes-langchain.textSplitterRecursiveCharacterTextSplitter"",""typeVersion"":1,""position"":[900,1260],""id"":""590bdbf7-cbe7-405c-b2b8-cd73155ec4e4"",""name"":""Recursive Character Text Splitter""},{""parameters"":{""model"":{""__rl"":true,""value"":""qwen2.5:14b-8k"",""mode"":""list"",""cachedResultName"":""qwen2.5:14b-8k""},""options"":{}},""type"":""@n8n/n8n-nodes-langchain.lmChatOpenAi"",""typeVersion"":1.2,""position"":[-740,360],""id"":""a3b834b1-5fc7-4c84-86f3-eacde77ed46b"",""name"":""Ollama (Change Base URL)"",""credentials"":{""openAiApi"":{""id"":""hCRYMvx7elcOLiPj"",""name"":""OpenAi account""}}},{""parameters"":{""content"":""## NOTE\n\nThe Ollama chat model node doesn't work with the RAG nodes - known issue with n8n.\n\nSo for now, we are using the OpenAI chat model but changing the base URL to Ollama when creating the credentials (i.e. http://ollama:11434/v1). The API key can be set to whatever, it isn't used for local LLMs."",""height"":200,""width"":540,""color"":6},""type"":""n8n-nodes-base.stickyNote"",""position"":[-2300,1200],""typeVersion"":1,""id"":""c1a15e44-f282-4a2a-abe4-f4c17709fe38"",""name"":""Sticky Note4""},{""parameters"":{""operation"":""executeQuery"",""query"":""DO $$\nBEGIN\n    IF EXISTS (SELECT 1 FROM information_schema.tables WHERE table_name = 'documents_pg') THEN\n        EXECUTE 'DELETE FROM documents_pg WHERE metadata->>''file_id'' LIKE ''%' || $1 || '%''';\n    END IF;\nEND\n$$;"",""options"":{""queryReplacement"":""={{ $json.file_id }}""}},""type"":""n8n-nodes-base.postgres"",""typeVersion"":2.5,""position"":[-1140,680],""id"":""b7976820-6a79-4908-861c-f9062c2f7d17"",""name"":""Delete Old Doc Records"",""credentials"":{""postgres"":{""id"":""i83SgkPKmlQ785tT"",""name"":""Postgres account""}}},{""parameters"":{""operation"":""executeQuery"",""query"":""DELETE FROM document_rows\nWHERE dataset_id LIKE '%' || $1 || '%';"",""options"":{""queryReplacement"":""={{ $('Set File ID').item.json.file_id }}""}},""type"":""n8n-nodes-base.postgres"",""typeVersion"":2.5,""position"":[-980,820],""id"":""979948a0-7449-46d8-8c38-0a8ff8689162"",""name"":""Delete Old Data Records"",""credentials"":{""postgres"":{""id"":""i83SgkPKmlQ785tT"",""name"":""Postgres account""}}},{""parameters"":{""mode"":""insert"",""tableName"":""documents_pg"",""options"":{}},""type"":""@n8n/n8n-nodes-langchain.vectorStorePGVector"",""typeVersion"":1,""position"":[880,920],""id"":""a6f5e003-5f65-488b-9ce5-0844413239f5"",""name"":""Postgres PGVector Store"",""credentials"":{""postgres"":{""id"":""i83SgkPKmlQ785tT"",""name"":""Postgres account""}}},{""parameters"":{""mode"":""retrieve-as-tool"",""toolName"":""documents"",""toolDescription"":""Use RAG to look up information in the knowledgebase."",""tableName"":""documents_pg"",""options"":{}},""type"":""@n8n/n8n-nodes-langchain.vectorStorePGVector"",""typeVersion"":1,""position"":[160,140],""id"":""d62a3b1e-5e74-4e46-b626-fd17fb74468c"",""name"":""Postgres PGVector Store1"",""credentials"":{""postgres"":{""id"":""i83SgkPKmlQ785tT"",""name"":""Postgres account""}}}]","{""Extract Document Text"":{""main"":[[{""node"":""Postgres PGVector Store"",""type"":""main"",""index"":0}]]},""Default Data Loader"":{""ai_document"":[[{""node"":""Postgres PGVector Store"",""type"":""ai_document"",""index"":0}]]},""Postgres Chat Memory"":{""ai_memory"":[[{""node"":""RAG AI Agent"",""type"":""ai_memory"",""index"":0}]]},""Set File ID"":{""main"":[[{""node"":""Delete Old Doc Records"",""type"":""main"",""index"":0}]]},""Edit Fields"":{""main"":[[{""node"":""RAG AI Agent"",""type"":""main"",""index"":0}]]},""When chat message received"":{""main"":[[{""node"":""Edit Fields"",""type"":""main"",""index"":0}]]},""Webhook"":{""main"":[[{""node"":""Edit Fields"",""type"":""main"",""index"":0}]]},""Extract PDF Text"":{""main"":[[{""node"":""Postgres PGVector Store"",""type"":""main"",""index"":0}]]},""Aggregate"":{""main"":[[{""node"":""Summarize"",""type"":""main"",""index"":0}]]},""Summarize"":{""main"":[[{""node"":""Set Schema"",""type"":""main"",""index"":0},{""node"":""Postgres PGVector Store"",""type"":""main"",""index"":0}]]},""RAG AI Agent"":{""main"":[[{""node"":""Respond to Webhook"",""type"":""main"",""index"":0}]]},""Switch"":{""main"":[[{""node"":""Extract PDF Text"",""type"":""main"",""index"":0}],[{""node"":""Extract from Excel"",""type"":""main"",""index"":0}],[{""node"":""Extract from CSV"",""type"":""main"",""index"":0}],[{""node"":""Extract Document Text"",""type"":""main"",""index"":0}]]},""Extract from Excel"":{""main"":[[{""node"":""Aggregate"",""type"":""main"",""index"":0},{""node"":""Insert Table Rows"",""type"":""main"",""index"":0}]]},""Set Schema"":{""main"":[[{""node"":""Update Schema for Document Metadata"",""type"":""main"",""index"":0}]]},""Extract from CSV"":{""main"":[[{""node"":""Aggregate"",""type"":""main"",""index"":0},{""node"":""Insert Table Rows"",""type"":""main"",""index"":0}]]},""Create Document Metadata Table"":{""main"":[[]]},""List Documents"":{""ai_tool"":[[{""node"":""RAG AI Agent"",""type"":""ai_tool"",""index"":0}]]},""Get File Contents"":{""ai_tool"":[[{""node"":""RAG AI Agent"",""type"":""ai_tool"",""index"":0}]]},""Query Document Rows"":{""ai_tool"":[[{""node"":""RAG AI Agent"",""type"":""ai_tool"",""index"":0}]]},""Loop Over Items"":{""main"":[[],[{""node"":""Set File ID"",""type"":""main"",""index"":0}]]},""Insert Document Metadata"":{""main"":[[{""node"":""Read/Write Files from Disk"",""type"":""main"",""index"":0}]]},""Local File Trigger"":{""main"":[[{""node"":""Loop Over Items"",""type"":""main"",""index"":0}]]},""Read/Write Files from Disk"":{""main"":[[{""node"":""Switch"",""type"":""main"",""index"":0}]]},""Embeddings Ollama"":{""ai_embedding"":[[{""node"":""Postgres PGVector Store"",""type"":""ai_embedding"",""index"":0}]]},""Embeddings Ollama1"":{""ai_embedding"":[[{""node"":""Postgres PGVector Store1"",""type"":""ai_embedding"",""index"":0}]]},""Recursive Character Text Splitter"":{""ai_textSplitter"":[[{""node"":""Default Data Loader"",""type"":""ai_textSplitter"",""index"":0}]]},""Ollama (Change Base URL)"":{""ai_languageModel"":[[{""node"":""RAG AI Agent"",""type"":""ai_languageModel"",""index"":0}]]},""Delete Old Doc Records"":{""main"":[[{""node"":""Delete Old Data Records"",""type"":""main"",""index"":0}]]},""Delete Old Data Records"":{""main"":[[{""node"":""Insert Document Metadata"",""type"":""main"",""index"":0}]]},""Postgres PGVector Store"":{""main"":[[{""node"":""Loop Over Items"",""type"":""main"",""index"":0}]]},""Postgres PGVector Store1"":{""ai_tool"":[[{""node"":""RAG AI Agent"",""type"":""ai_tool"",""index"":0}]]}}",2025-03-22 10:29:54.748+00,2025-03-22 12:10:25.509+00,"{""executionOrder"":""v1""}",,{},cd039b65-853f-4cde-892c-0ad66da0ef02,4,RssROpqkXOm23GYL,"{""templateCredsSetupCompleted"":true,""instanceId"":""73cb7a3e883df514bb47e8d1b34526d30e2abb8f56cd99f10d5948a1e11b25aa""}",
My workflow,f,"[{""parameters"":{""options"":{""frequencyPenalty"":0.2,""temperature"":0.7}},""id"":""19b3d4ca-f34c-4c17-abd2-51dd310ba76d"",""name"":""OpenAI Chat Model"",""type"":""@n8n/n8n-nodes-langchain.lmChatOpenAi"",""position"":[220,300],""typeVersion"":1,""credentials"":{""openAiApi"":{""id"":""hCRYMvx7elcOLiPj"",""name"":""OpenAi API""}}},{""parameters"":{""agent"":""openAiFunctionsAgent"",""text"":""={{ $json.body.chatInput }}"",""options"":{""systemMessage"":""={{ $json.body.systemPrompt }}""}},""id"":""b55912e3-6e13-48e5-9f47-d14d06a0b688"",""name"":""AI Agent"",""type"":""@n8n/n8n-nodes-langchain.agent"",""position"":[320,-140],""typeVersion"":1.1},{""parameters"":{""sessionKey"":""={{ $('Webhook').item.json.body.user_id }}_{{ $('Webhook').item.json.body.chat_id }}"",""contextWindowLength"":10},""id"":""1a115fdc-fdf4-45d7-9be4-966f202583fb"",""name"":""Window Buffer Memory"",""type"":""@n8n/n8n-nodes-langchain.memoryBufferWindow"",""position"":[380,120],""typeVersion"":1},{""parameters"":{},""type"":""@n8n/n8n-nodes-langchain.toolWikipedia"",""typeVersion"":1,""position"":[540,120],""id"":""a1af4eef-bce7-4619-95b4-b4e8ded7166b"",""name"":""Wikipedia""},{""parameters"":{},""type"":""@n8n/n8n-nodes-langchain.toolCalculator"",""typeVersion"":1,""position"":[660,120],""id"":""9d8aff5c-4fb8-43db-9c98-ead7beb1214a"",""name"":""Calculator""},{""parameters"":{""httpMethod"":""POST"",""path"":""OpenWebUITestAgent"",""authentication"":""basicAuth"",""responseMode"":""responseNode"",""options"":{}},""type"":""n8n-nodes-base.webhook"",""typeVersion"":2,""position"":[0,-140],""id"":""1ff5b7b9-9278-45e0-8a6d-d80dcb169c7f"",""name"":""Webhook"",""webhookId"":""b3e7d885-0c39-4425-a239-ae065759dbb5"",""credentials"":{""httpBasicAuth"":{""id"":""LRDSxubbcczOIOAy"",""name"":""Unnamed credential""}}},{""parameters"":{""options"":{}},""type"":""n8n-nodes-base.respondToWebhook"",""typeVersion"":1.1,""position"":[780,-140],""id"":""1b3eafaf-59e8-44c0-80c0-f05c7b701c84"",""name"":""Respond to Webhook""},{""parameters"":{""toolDescription"":""Get current Time"",""url"":""https://www.timeapi.io/api/time/current/zone"",""sendQuery"":true,""parametersQuery"":{""values"":[{""name"":""timeZone"",""valueProvider"":""fieldValue"",""value"":""Europe/Berlin""}]}},""type"":""@n8n/n8n-nodes-langchain.toolHttpRequest"",""typeVersion"":1.1,""position"":[780,120],""id"":""9a51935f-dd3e-4f31-aa39-8a69fe0bc25a"",""name"":""Get Time""}]","{""AI Agent"":{""main"":[[{""node"":""Respond to Webhook"",""type"":""main"",""index"":0}]]},""Window Buffer Memory"":{""ai_memory"":[[{""node"":""AI Agent"",""type"":""ai_memory"",""index"":0}]]},""Wikipedia"":{""ai_tool"":[[{""node"":""AI Agent"",""type"":""ai_tool"",""index"":0}]]},""Calculator"":{""ai_tool"":[[{""node"":""AI Agent"",""type"":""ai_tool"",""index"":0}]]},""Webhook"":{""main"":[[{""node"":""AI Agent"",""type"":""main"",""index"":0}]]},""Get Time"":{""ai_tool"":[[{""node"":""AI Agent"",""type"":""ai_tool"",""index"":0}]]},""OpenAI Chat Model"":{""ai_languageModel"":[[{""node"":""AI Agent"",""type"":""ai_languageModel"",""index"":0}]]}}",2025-03-22 12:36:08.498+00,2025-03-22 17:17:25.457+00,"{""executionOrder"":""v1""}",,{},a2ea470a-2c6a-4ae5-8342-f3e329144bac,1,sZ8eQrGalNOpqXAp,"{""templateCredsSetupCompleted"":true}",
Supervisor Example,f,"[{""parameters"":{""content"":""# The Supervisor Architecture\n\n\n![Image](https://i.imgur.com/rkNGIXN.png)\n### Diagram By Langchain\n\n## Benefits\n- **Specialization and Separation of Concerns**: Each agent is responsible for a specific task, reducing the scope of responsibility, leading to better accuracy.\n- **Reusability**: Agents can be reused across different workflows and contexts without duplication.\n- **Improved Transparency and Debugging Process**:  It becomes easier to identify and resolve issues because the overall task is divided into smaller units handled by multiple agents.\n- **Parallelization**: Being able to execute tasks parallelly."",""height"":880,""width"":900},""type"":""n8n-nodes-base.stickyNote"",""typeVersion"":1,""position"":[-1400,-20],""id"":""78642642-26e7-46c2-b947-ffa3e9423dcf"",""name"":""Sticky Note""},{""parameters"":{""options"":{""systemMessage"":""=<Context>\nYou are a supervisor agent, You have access to a team of agents.\n</Context>\n\n<Tools>\n- The Calendar Agent - responsible for managing user calendar events\n- The Email Agent - responsible for managing user emails\n- The Contacts Agent - responsible for accessing user contacts\n</Tools>\n\n<Notes>\n- The current date and time is: {{ $now }}\n</Notes>\n\n<Rules>\n- Always ask for the Date and Time when a user requests to create a Calendar Event \n- Make sure to always get the contacts from the contacts agent if a user requests to send an email to somebody or if they request to create a calendar event with a particular person, without specifying their email address.\n- Make sure to always pass the name and email of the contact to the Calendar and Email Agent whenever present.\n- Always make sure a request is explicity, ie. Creating A Calendar Event, or Sending an email, before actually doing it.\n- Never include a placeholder sign-off when making requests to the Email Agent; simply specify the content you want emailed.\n- Always explicity specify the action of the email when asking the email agent, either to send, draft, fetch. \n</Rules>""}},""type"":""@n8n/n8n-nodes-langchain.agent"",""typeVersion"":1.8,""position"":[340,240],""id"":""f6e23684-77c7-480a-8ee9-4f8455066c78"",""name"":""Supervisor""},{""parameters"":{""promptType"":""define"",""text"":""={{ $json.query }}"",""options"":{""systemMessage"":""=<Context>\nYou are a calendar assistant. Your responsibilities include creating, getting, and deleting events in the user's calendar.\n</Context>\n\n<Tools>\n   - Use \""Create with Attendee\"" when an event includes a participant.  \n   - Use \""Create\"" for solo events.   \n   - Use \""Get\"" to fetch calendar schedules when requested.\n   - Use \""Remove\"" to delete an event. You must use \""Get Events\"" first to get the ID of the event to delete.\n   - Use \""Update\"" to update an event. You must use \""Get Events\"" first to get the ID of the event to update.\n</Tools>\n\n<Notes>\n- Here is the current date/time: {{ $now }}\n- If a duration for an event isn't specified, assume it will be one hour.\n- If a request is made that goes beyond your capabilities (Refer to tools available to you), acknowledge that it cannot be performed.\n</Notes>""}},""id"":""4b602073-f0f6-4a98-b73f-e5cfadf4c864"",""name"":""Calendar Agent"",""type"":""@n8n/n8n-nodes-langchain.agent"",""typeVersion"":1.6,""position"":[800,560],""onError"":""continueRegularOutput""},{""parameters"":{""promptType"":""define"",""text"":""={{ $json.query }}"",""options"":{""systemMessage"":""=<Context>\nYou are an assistant responsible for managing email communications.\n</Context>\n\n<Tools>  \n- Use **\""Send\""** to send messages.  \n- Use **\""Create Draft\""** if the user wants to review before sending.  \n- Use **\""Get\""** to fetch inbox messages when requested.  \n- Use **\""Get By Sender\""** to fetch inbox messages by a specific sender.  \n- Use **\""Reply\""** to respond—ensure you call **\""Get Emails\""** first to obtain the message ID.\n</Tools>\n\n<Notes>  \n- The current date and time is: {{ $now }}  \n- If a request is made that goes beyond your capabilities (Refer to tools available to you), acknowledge that it cannot be performed.\n- always sign off as \""Mahmut.\""\n</Notes>""}},""id"":""c4cd3ea2-1b00-40df-87ba-82fac5c39aee"",""name"":""Email Agent"",""type"":""@n8n/n8n-nodes-langchain.agent"",""typeVersion"":1.6,""position"":[-180,560],""onError"":""continueRegularOutput""},{""parameters"":{""resource"":""draft"",""subject"":""={{ $fromAI(\""subject\"") }}"",""emailType"":""html"",""message"":""={{ $fromAI(\""emailContent\"") }}"",""options"":{""sendTo"":""={{ $fromAI(\""email\"") }}""}},""type"":""n8n-nodes-base.gmailTool"",""typeVersion"":2.1,""position"":[180,760],""id"":""64f323d8-ffae-47c7-91db-a39c90c997e9"",""name"":""Create Draft"",""webhookId"":""17016bce-d7d7-428a-a56c-f6ea122db8be""},{""parameters"":{""options"":{}},""id"":""6ca7debe-ffc3-40f8-ab30-9e063dc134d2"",""name"":""Email GPT"",""type"":""@n8n/n8n-nodes-langchain.lmChatOpenAi"",""typeVersion"":1,""position"":[-320,760]},{""parameters"":{""calendar"":{""__rl"":true,""value"":""mahmutktech98@gmail.com"",""mode"":""list"",""cachedResultName"":""mahmutktech98@gmail.com""},""start"":""={{ $fromAI(\""eventStart\"") }}"",""end"":""={{ $fromAI(\""eventEnd\"") }}"",""additionalFields"":{""attendees"":[],""summary"":""={{ $fromAI(\""eventTitle\"") }}""}},""type"":""n8n-nodes-base.googleCalendarTool"",""typeVersion"":1.3,""position"":[820,760],""id"":""da5356e2-9e6b-4f6e-8dc3-8899a5e45102"",""name"":""Create""},{""parameters"":{""calendar"":{""__rl"":true,""value"":""mahmutktech98@gmail.com"",""mode"":""list"",""cachedResultName"":""mahmutktech98@gmail.com""},""start"":""={{ $fromAI(\""eventStart\"") }}"",""end"":""={{ $fromAI(\""eventEnd\"") }}"",""additionalFields"":{""attendees"":[""={{ $fromAI(\""attendees\"", \""can use comma to indicate multiple\"") }}""],""summary"":""={{ $fromAI(\""eventTitle\"") }}""}},""type"":""n8n-nodes-base.googleCalendarTool"",""typeVersion"":1.3,""position"":[960,800],""id"":""9a34fb8b-2248-4f88-8b88-e2a0736cabc4"",""name"":""Create with Attendee""},{""parameters"":{""operation"":""update"",""calendar"":{""__rl"":true,""value"":""mahmutktech98@gmail.com"",""mode"":""list"",""cachedResultName"":""mahmutktech98@gmail.com""},""eventId"":""={{ $fromAI(\""eventId\"") }}"",""updateFields"":{""end"":""={{ $fromAI(\""endTime\"") }}"",""start"":""={{ $fromAI(\""startTime\"") }}""}},""type"":""n8n-nodes-base.googleCalendarTool"",""typeVersion"":1.3,""position"":[1100,840],""id"":""daa1bcf8-38ea-4b06-bcb4-4de26a6fcb20"",""name"":""Update""},{""parameters"":{""operation"":""delete"",""calendar"":{""__rl"":true,""value"":""mahmutktech98@gmail.com"",""mode"":""list"",""cachedResultName"":""mahmutktech98@gmail.com""},""eventId"":""={{ $fromAI(\""eventId\"") }}"",""options"":{}},""type"":""n8n-nodes-base.googleCalendarTool"",""typeVersion"":1.3,""position"":[1120,760],""id"":""44b452f1-cd40-4a2d-a6d5-7c1ded36c2ea"",""name"":""Remove""},{""parameters"":{""operation"":""getAll"",""calendar"":{""__rl"":true,""value"":""mahmutktech98@gmail.com"",""mode"":""list"",""cachedResultName"":""mahmutktech98@gmail.com""},""timeMin"":""={{ $fromAI(\""dayBefore\"",\""the day before the date the user requested\"") }}"",""timeMax"":""={{ $fromAI(\""dayAfter\"",\""the day after the date the user requested\"") }}"",""options"":{}},""type"":""n8n-nodes-base.googleCalendarTool"",""typeVersion"":1.3,""position"":[1260,800],""id"":""877cf346-9a20-49c3-b9f4-67a411bfd524"",""name"":""Get""},{""parameters"":{""operation"":""getAll"",""limit"":""={{ $fromAI(\""limit\"",\""number of emails to fetch\"") }}"",""simple"":false,""filters"":{},""options"":{}},""type"":""n8n-nodes-base.gmailTool"",""typeVersion"":2.1,""position"":[-180,800],""id"":""43019faa-7d9e-4fbc-8f6b-593cd3594b7e"",""name"":""Get1"",""webhookId"":""af4b3298-9037-44b0-aa12-2acbfbb5e66f""},{""parameters"":{""operation"":""getAll"",""limit"":""={{ $fromAI(\""limit\"",\""number of emails to fetch\"") }}"",""simple"":false,""filters"":{""sender"":""={{ $fromAI(\""sender\"",\""Sender of the email, name or email\"") }}""},""options"":{}},""type"":""n8n-nodes-base.gmailTool"",""typeVersion"":2.1,""position"":[-40,840],""id"":""4884e6a2-aa85-4571-b830-21873f9eb82e"",""name"":""Get By Sender"",""webhookId"":""af4b3298-9037-44b0-aa12-2acbfbb5e66f""},{""parameters"":{""operation"":""reply"",""messageId"":""={{ $fromAI(\""id\"",\""email id\"") }}"",""message"":""={{ $fromAI(\""emailContent\"") }}"",""options"":{""appendAttribution"":false}},""type"":""n8n-nodes-base.gmailTool"",""typeVersion"":2.1,""position"":[-20,760],""id"":""27a2ccfd-c27b-4b43-8d78-5e9bbcf75c8d"",""name"":""Reply"",""webhookId"":""114785e6-a859-432b-81b4-c490c1c35b1c""},{""parameters"":{""sendTo"":""={{ $fromAI(\""email\"") }}"",""subject"":""={{ $fromAI(\""subject\"") }}"",""message"":""={{ $fromAI(\""emailContent\"") }}"",""options"":{""appendAttribution"":false}},""type"":""n8n-nodes-base.gmailTool"",""typeVersion"":2.1,""position"":[160,840],""id"":""e19b2bfe-dff8-45d7-b306-d2cada635791"",""name"":""Send"",""webhookId"":""86c8c4b1-13bb-4ebe-acb9-30e1d7082d55""},{""parameters"":{""content"":""# With The Supervisor Architecture"",""height"":80,""width"":600,""color"":4},""type"":""n8n-nodes-base.stickyNote"",""typeVersion"":1,""position"":[160,-60],""id"":""cac2eee3-5075-4bf8-937b-41027d3f4612"",""name"":""Sticky Note1""},{""parameters"":{""content"":""# Without the Supervisor Architecture"",""height"":80,""width"":640,""color"":3},""type"":""n8n-nodes-base.stickyNote"",""typeVersion"":1,""position"":[1880,-60],""id"":""bfb58843-2407-418b-9094-d00500f651f0"",""name"":""Sticky Note2""},{""parameters"":{""model"":{""__rl"":true,""value"":""gpt-4o"",""mode"":""list"",""cachedResultName"":""gpt-4o""},""options"":{}},""type"":""@n8n/n8n-nodes-langchain.lmChatOpenAi"",""typeVersion"":1.2,""position"":[1820,300],""id"":""24503b9c-54d3-4fdd-86ee-899f83dbc7f6"",""name"":""OpenAI Chat Model1""},{""parameters"":{""calendar"":{""__rl"":true,""value"":""mahmutktech98@gmail.com"",""mode"":""list"",""cachedResultName"":""mahmutktech98@gmail.com""},""start"":""={{ $fromAI(\""eventStart\"") }}"",""end"":""={{ $fromAI(\""eventEnd\"") }}"",""additionalFields"":{""attendees"":[],""summary"":""={{ $fromAI(\""eventTitle\"") }}""}},""type"":""n8n-nodes-base.googleCalendarTool"",""typeVersion"":1.3,""position"":[2180,580],""id"":""fe2fdeb1-1dbf-4577-94e6-d2e1e2a7bcf6"",""name"":""Create1""},{""parameters"":{""calendar"":{""__rl"":true,""value"":""mahmutktech98@gmail.com"",""mode"":""list"",""cachedResultName"":""mahmutktech98@gmail.com""},""start"":""={{ $fromAI(\""eventStart\"") }}"",""end"":""={{ $fromAI(\""eventEnd\"") }}"",""additionalFields"":{""attendees"":[""={{ $fromAI(\""attendeeEmails\"", \""can use comma to indicate multiple\"") }}""],""summary"":""={{ $fromAI(\""eventTitle\"") }}""}},""type"":""n8n-nodes-base.googleCalendarTool"",""typeVersion"":1.3,""position"":[2320,580],""id"":""9cb2f497-0df1-4de3-8f3d-831cca4422b9"",""name"":""Create with Attendee1""},{""parameters"":{""operation"":""update"",""calendar"":{""__rl"":true,""value"":""mahmutktech98@gmail.com"",""mode"":""list"",""cachedResultName"":""mahmutktech98@gmail.com""},""eventId"":""={{ $fromAI(\""eventId\"") }}"",""updateFields"":{""end"":""={{ $fromAI(\""endTime\"") }}"",""start"":""={{ $fromAI(\""startTime\"") }}""}},""type"":""n8n-nodes-base.googleCalendarTool"",""typeVersion"":1.3,""position"":[2460,580],""id"":""aa6e24bc-c266-4a04-88b9-d937fd8a8bc4"",""name"":""Update1""},{""parameters"":{""operation"":""delete"",""calendar"":{""__rl"":true,""value"":""mahmutktech98@gmail.com"",""mode"":""list"",""cachedResultName"":""mahmutktech98@gmail.com""},""eventId"":""={{ $fromAI(\""eventId\"") }}"",""options"":{}},""type"":""n8n-nodes-base.googleCalendarTool"",""typeVersion"":1.3,""position"":[2580,580],""id"":""e38230bb-4153-4860-971e-2d4cd2f4e0ef"",""name"":""Remove1""},{""parameters"":{""operation"":""getAll"",""calendar"":{""__rl"":true,""value"":""mahmutktech98@gmail.com"",""mode"":""list"",""cachedResultName"":""mahmutktech98@gmail.com""},""timeMin"":""={{ $fromAI(\""dayBefore\"",\""the day before the date the user requested\"") }}"",""timeMax"":""={{ $fromAI(\""dayAfter\"",\""the day after the date the user requested\"") }}"",""options"":{}},""type"":""n8n-nodes-base.googleCalendarTool"",""typeVersion"":1.3,""position"":[2720,580],""id"":""71e3ce88-8baa-49cc-8bed-0cde858bb92d"",""name"":""Get2""},{""parameters"":{""resource"":""draft"",""subject"":""={{ $fromAI(\""subject\"") }}"",""emailType"":""html"",""message"":""={{ $fromAI(\""emailContent\"") }}"",""options"":{""sendTo"":""={{ $fromAI(\""email\"") }}""}},""type"":""n8n-nodes-base.gmailTool"",""typeVersion"":2.1,""position"":[2040,580],""id"":""2fdf32cd-3808-4b9c-876d-274d1c4a610c"",""name"":""Create Draft1"",""webhookId"":""17016bce-d7d7-428a-a56c-f6ea122db8be""},{""parameters"":{""operation"":""getAll"",""limit"":""={{ $fromAI(\""limit\"",\""number of emails to fetch\"") }}"",""simple"":false,""filters"":{},""options"":{}},""type"":""n8n-nodes-base.gmailTool"",""typeVersion"":2.1,""position"":[1560,580],""id"":""4aed5f40-cf73-4ff1-86da-9ec009e267cb"",""name"":""Get3"",""webhookId"":""af4b3298-9037-44b0-aa12-2acbfbb5e66f""},{""parameters"":{""operation"":""getAll"",""limit"":""={{ $fromAI(\""limit\"",\""number of emails to fetch\"") }}"",""simple"":false,""filters"":{""sender"":""={{ $fromAI(\""sender\"",\""Sender of the email, name or email\"") }}""},""options"":{}},""type"":""n8n-nodes-base.gmailTool"",""typeVersion"":2.1,""position"":[1680,580],""id"":""df003613-bccd-463c-abad-dc5a39080f88"",""name"":""Get By Sender1"",""webhookId"":""af4b3298-9037-44b0-aa12-2acbfbb5e66f""},{""parameters"":{""operation"":""reply"",""messageId"":""={{ $fromAI(\""id\"",\""email id\"") }}"",""message"":""={{ $fromAI(\""emailContent\"") }}"",""options"":{""appendAttribution"":false}},""type"":""n8n-nodes-base.gmailTool"",""typeVersion"":2.1,""position"":[1800,580],""id"":""82f3b51a-d28a-4266-81f0-22f3a24dad74"",""name"":""Reply1"",""webhookId"":""114785e6-a859-432b-81b4-c490c1c35b1c""},{""parameters"":{""sendTo"":""={{ $fromAI(\""email\"") }}"",""subject"":""={{ $fromAI(\""subject\"") }}"",""message"":""={{ $fromAI(\""emailContent\"") }}"",""options"":{""appendAttribution"":false}},""type"":""n8n-nodes-base.gmailTool"",""typeVersion"":2.1,""position"":[1920,580],""id"":""402983e8-43e6-4e8f-899e-99582ad05b34"",""name"":""Send1"",""webhookId"":""86c8c4b1-13bb-4ebe-acb9-30e1d7082d55""},{""parameters"":{""options"":{""systemMessage"":""=<Context>\nYou are an assistant responsible for managing email communications, calendar events, and contacts.\n</Context>\n\n\n<Tools>\n- Use **\""Send\""** to send messages.  \n- Use **\""Create Draft\""** if the user wants to review before sending.  \n- Use **\""Get\""** to fetch inbox messages when requested.  \n- Use **\""Get By Sender\""** to fetch inbox messages by a specific sender.  \n- Use **\""Reply\""** to respond—ensure you call **\""Get Emails\""** first to obtain the message ID.obtain the message ID.\n- Slack Contacts\n- Crm Contacts\n   - Use \""Create with Attendee\"" when an event includes a participant.  \n   - Use \""Create\"" for solo events.   \n   - Use \""Get\"" to fetch calendar schedules when requested.\n   - Use \""Remove\"" to delete an event. You must use \""Get Events\"" first to get the ID of the event to delete.\n   - Use \""Update\"" to update an event. You must use \""Get Events\"" first to get the ID of the event to update.\n</Tools>\n\n<Notes>\nThe current date and time is: {{ $now }}.\n- If a duration for an event isn't specified, assume it will be one hour.\n- If a request is made that goes beyond your capabilities (Refer to tools available to you), acknowledge that it cannot be performed.\nAlways fetch contacts by calling both tools unless which source to use is explicitly specified\n- If a request is made that goes beyond your capabilities (Refer to tools available to you), acknowledge that it cannot be performed.\n- always sign off as \""Mahmut.\""\n- Always ask for the Date and Time when a user requests to create a Calendar Event \n- Make sure to always get the contacts from the contacts agent if a user requests to send an email to somebody or if they request to create a calendar event with a particular person, without specifying their email address.\n- Make sure to always pass the name and email of the contact to the Calendar and Email Agent whenever present.\n- Always make sure a request is explicity, ie. Creating A Calendar Event, or Sending an email, before actually doing it.\n</Notes>""}},""type"":""@n8n/n8n-nodes-langchain.agent"",""typeVersion"":1.8,""position"":[2040,160],""id"":""becec6ba-93cd-4acb-8426-3f8c5e8df114"",""name"":""Personal Assistant""},{""parameters"":{""name"":""The_Calendar_Agent"",""description"":""Use this tool for any tasks related to calendar management."",""workflowId"":{""__rl"":true,""value"":""9r4fpMPrRSpnINDa"",""mode"":""list"",""cachedResultName"":""Calendar Agent""},""workflowInputs"":{""mappingMode"":""defineBelow"",""value"":{},""matchingColumns"":[],""schema"":[],""attemptToConvertTypes"":false,""convertFieldsToString"":false}},""type"":""@n8n/n8n-nodes-langchain.toolWorkflow"",""typeVersion"":2.1,""position"":[900,480],""id"":""63e9a47f-86b2-47ef-8e60-518e119807d3"",""name"":""The Calendar Agent""},{""parameters"":{""name"":""The_Email_Agent"",""description"":""Use this tool for any tasks related to email management."",""workflowId"":{""__rl"":true,""value"":""st0kg0uFBQezhrYr"",""mode"":""list"",""cachedResultName"":""Email Agent""},""workflowInputs"":{""mappingMode"":""defineBelow"",""value"":{},""matchingColumns"":[],""schema"":[],""attemptToConvertTypes"":false,""convertFieldsToString"":false}},""type"":""@n8n/n8n-nodes-langchain.toolWorkflow"",""typeVersion"":2.1,""position"":[-80,480],""id"":""985eedb0-4bc0-4815-871e-12a659092ba9"",""name"":""The Email Agent""},{""parameters"":{""options"":{}},""type"":""@n8n/n8n-nodes-langchain.chatTrigger"",""typeVersion"":1.1,""position"":[400,100],""id"":""c2970dec-c15d-4295-8a7d-a79adca33918"",""name"":""When chat message received"",""webhookId"":""57c955d6-0398-47b6-9e20-b5dfbb04910f""},{""parameters"":{""options"":{""systemMessage"":""=<Context>\nYou are the Contacts Agent, you manage contacts. \n</Context>\n\n<Tools>\n- Slack Contacts\n- Crm Contacts\n</Tools>\n\n<Note>\nAlways fetch contacts by calling both tools unless which source to use is explicitly specified\n</Note>""}},""type"":""@n8n/n8n-nodes-langchain.agent"",""typeVersion"":1.8,""position"":[400,680],""id"":""bd8c08f7-a0ed-4f77-bb82-14d1ff6c26aa"",""name"":""Contacts Agent""},{""parameters"":{""name"":""SLACK_CONTACTS"",""description"":""=Call this tool to get the SLACK CONTACTS"",""jsCode"":""return `\n[{\n    firstName: 'Michael',\n    lastName: 'Williams',\n    email: 'michael.williams@example.com'\n  },\n  {\n    firstName: 'Emma',\n    lastName: 'Brown',\n    email: 'emma.brown@example.com'\n  },\n  {\n    firstName: 'Oliver',\n    lastName: 'Davis',\n    email: 'oliver.davis@example.com'\n  }]\n`""},""type"":""@n8n/n8n-nodes-langchain.toolCode"",""typeVersion"":1.1,""position"":[480,920],""id"":""ed7b8f6b-4388-4c6d-9beb-ff3fbae5d105"",""name"":""Slack Contacts""},{""parameters"":{""name"":""CRM_CONTACTS"",""description"":""=Call this tool to get the CRM CONTACTS"",""jsCode"":""return `[\n  {\n    firstName: 'John',\n    lastName: 'Doe',\n    email: 'oncekod98@gmail.com'\n  },\n  {\n    firstName: 'Jane',\n    lastName: 'Smith',\n    email: 'jane.smith@example.com'\n  },\n  {\n    firstName: 'Alice',\n    lastName: 'Johnson',\n    email: 'alice.johnson@example.com'\n  },\n]`""},""type"":""@n8n/n8n-nodes-langchain.toolCode"",""typeVersion"":1.1,""position"":[600,920],""id"":""c69570cf-5786-43e7-b6a3-a14131eb235e"",""name"":""Crm Contacts""},{""parameters"":{""model"":{""__rl"":true,""value"":""gpt-4o-mini"",""mode"":""list"",""cachedResultName"":""gpt-4o-mini""},""options"":{}},""type"":""@n8n/n8n-nodes-langchain.lmChatOpenAi"",""typeVersion"":1.2,""position"":[360,920],""id"":""eac43923-9505-4fc2-8de2-571a258a410b"",""name"":""Contacts GPT""},{""parameters"":{""name"":""SLACK_CONTACTS"",""description"":""=Call this tool to get the SLACK CONTACTS"",""jsCode"":""return `\n[{\n    firstName: 'Michael',\n    lastName: 'Williams',\n    email: 'michael.williams@example.com'\n  },\n  {\n    firstName: 'Emma',\n    lastName: 'Brown',\n    email: 'emma.brown@example.com'\n  },\n  {\n    firstName: 'Oliver',\n    lastName: 'Davis',\n    email: 'oliver.davis@example.com'\n  }]\n`""},""type"":""@n8n/n8n-nodes-langchain.toolCode"",""typeVersion"":1.1,""position"":[2940,580],""id"":""7dd992b9-2132-4f9e-9a54-4e38f3ea2db3"",""name"":""Slack Contacts1""},{""parameters"":{""name"":""CRM_CONTACTS"",""description"":""=Call this tool to get the CRM CONTACTS"",""jsCode"":""return `[\n  {\n    firstName: 'John',\n    lastName: 'Doe',\n    email: 'oncekod98@gmail.com'\n  },\n  {\n    firstName: 'Jane',\n    lastName: 'Smith',\n    email: 'jane.smith@example.com'\n  },\n  {\n    firstName: 'Alice',\n    lastName: 'Johnson',\n    email: 'alice.johnson@example.com'\n  },\n]`""},""type"":""@n8n/n8n-nodes-langchain.toolCode"",""typeVersion"":1.1,""position"":[3060,580],""id"":""17b289bb-2883-47ce-a969-d1d988c36b8a"",""name"":""Crm Contacts1""},{""parameters"":{""name"":""The_Contacts_Agent"",""description"":""=Call this agent when you need access to the contacts of the user. It contains the contacts from 2 sources\n- SLACK\n- CRM\n\nPass in the query \n\n"",""workflowId"":{""__rl"":true,""value"":""kiJQVYIRP8cN0NtW"",""mode"":""list"",""cachedResultName"":""Contacts Agent""},""workflowInputs"":{""mappingMode"":""defineBelow"",""value"":{},""matchingColumns"":[],""schema"":[],""attemptToConvertTypes"":false,""convertFieldsToString"":false}},""type"":""@n8n/n8n-nodes-langchain.toolWorkflow"",""typeVersion"":2.1,""position"":[480,600],""id"":""2760ac1c-9629-425c-bf10-d55feb7329f4"",""name"":""The Contacts Agent""},{""parameters"":{""contextWindowLength"":10},""type"":""@n8n/n8n-nodes-langchain.memoryBufferWindow"",""typeVersion"":1.3,""position"":[2540,280],""id"":""3278ecb1-1566-4cd4-8cbd-33f7db8d3977"",""name"":""Simple Memory1""},{""parameters"":{""model"":{""__rl"":true,""mode"":""list"",""value"":""gpt-4o-mini""},""options"":{}},""type"":""@n8n/n8n-nodes-langchain.lmChatOpenAi"",""typeVersion"":1.2,""position"":[800,840],""id"":""a6490dd6-cfea-48b8-b521-f58d7f5e7bb8"",""name"":""Calendar GPT""},{""parameters"":{""model"":{""__rl"":true,""value"":""gpt-4o"",""mode"":""list"",""cachedResultName"":""gpt-4o""},""options"":{}},""type"":""@n8n/n8n-nodes-langchain.lmChatOpenAi"",""typeVersion"":1.2,""position"":[0,300],""id"":""b6afe99b-1420-4ddd-bd3d-e5346f4def5f"",""name"":""Supervisor GPT""},{""parameters"":{""contextWindowLength"":10},""type"":""@n8n/n8n-nodes-langchain.memoryBufferWindow"",""typeVersion"":1.3,""position"":[140,340],""id"":""2f236b36-605e-43b9-823a-7bad9e0d1aee"",""name"":""Simple Memory""}]","{""Create Draft"":{""ai_tool"":[[{""node"":""Email Agent"",""type"":""ai_tool"",""index"":0}]]},""Email GPT"":{""ai_languageModel"":[[{""node"":""Email Agent"",""type"":""ai_languageModel"",""index"":0}]]},""Create"":{""ai_tool"":[[{""node"":""Calendar Agent"",""type"":""ai_tool"",""index"":0}]]},""Create with Attendee"":{""ai_tool"":[[{""node"":""Calendar Agent"",""type"":""ai_tool"",""index"":0}]]},""Update"":{""ai_tool"":[[{""node"":""Calendar Agent"",""type"":""ai_tool"",""index"":0}]]},""Remove"":{""ai_tool"":[[{""node"":""Calendar Agent"",""type"":""ai_tool"",""index"":0}]]},""Get"":{""ai_tool"":[[{""node"":""Calendar Agent"",""type"":""ai_tool"",""index"":0}]]},""Get1"":{""ai_tool"":[[{""node"":""Email Agent"",""type"":""ai_tool"",""index"":0}]]},""Get By Sender"":{""ai_tool"":[[{""node"":""Email Agent"",""type"":""ai_tool"",""index"":0}]]},""Reply"":{""ai_tool"":[[{""node"":""Email Agent"",""type"":""ai_tool"",""index"":0}]]},""Send"":{""ai_tool"":[[{""node"":""Email Agent"",""type"":""ai_tool"",""index"":0}]]},""OpenAI Chat Model1"":{""ai_languageModel"":[[{""node"":""Personal Assistant"",""type"":""ai_languageModel"",""index"":0}]]},""Get3"":{""ai_tool"":[[{""node"":""Personal Assistant"",""type"":""ai_tool"",""index"":0}]]},""Get By Sender1"":{""ai_tool"":[[{""node"":""Personal Assistant"",""type"":""ai_tool"",""index"":0}]]},""Reply1"":{""ai_tool"":[[{""node"":""Personal Assistant"",""type"":""ai_tool"",""index"":0}]]},""Send1"":{""ai_tool"":[[{""node"":""Personal Assistant"",""type"":""ai_tool"",""index"":0}]]},""Create Draft1"":{""ai_tool"":[[{""node"":""Personal Assistant"",""type"":""ai_tool"",""index"":0}]]},""Create1"":{""ai_tool"":[[{""node"":""Personal Assistant"",""type"":""ai_tool"",""index"":0}]]},""Create with Attendee1"":{""ai_tool"":[[{""node"":""Personal Assistant"",""type"":""ai_tool"",""index"":0}]]},""Update1"":{""ai_tool"":[[{""node"":""Personal Assistant"",""type"":""ai_tool"",""index"":0}]]},""Get2"":{""ai_tool"":[[{""node"":""Personal Assistant"",""type"":""ai_tool"",""index"":0}]]},""Remove1"":{""ai_tool"":[[{""node"":""Personal Assistant"",""type"":""ai_tool"",""index"":0}]]},""The Calendar Agent"":{""ai_tool"":[[{""node"":""Supervisor"",""type"":""ai_tool"",""index"":0}]]},""The Email Agent"":{""ai_tool"":[[{""node"":""Supervisor"",""type"":""ai_tool"",""index"":0}]]},""When chat message received"":{""main"":[[{""node"":""Supervisor"",""type"":""main"",""index"":0}]]},""Slack Contacts"":{""ai_tool"":[[{""node"":""Contacts Agent"",""type"":""ai_tool"",""index"":0}]]},""Crm Contacts"":{""ai_tool"":[[{""node"":""Contacts Agent"",""type"":""ai_tool"",""index"":0}]]},""Contacts GPT"":{""ai_languageModel"":[[{""node"":""Contacts Agent"",""type"":""ai_languageModel"",""index"":0}]]},""Slack Contacts1"":{""ai_tool"":[[{""node"":""Personal Assistant"",""type"":""ai_tool"",""index"":0}]]},""Crm Contacts1"":{""ai_tool"":[[{""node"":""Personal Assistant"",""type"":""ai_tool"",""index"":0}]]},""The Contacts Agent"":{""ai_tool"":[[{""node"":""Supervisor"",""type"":""ai_tool"",""index"":0},{""node"":""Email Agent"",""type"":""ai_tool"",""index"":0}]]},""Simple Memory1"":{""ai_memory"":[[{""node"":""Personal Assistant"",""type"":""ai_memory"",""index"":0}]]},""Calendar GPT"":{""ai_languageModel"":[[{""node"":""Calendar Agent"",""type"":""ai_languageModel"",""index"":0}]]},""Supervisor GPT"":{""ai_languageModel"":[[{""node"":""Supervisor"",""type"":""ai_languageModel"",""index"":0}]]},""Simple Memory"":{""ai_memory"":[[{""node"":""Supervisor"",""type"":""ai_memory"",""index"":0}]]}}",2025-03-26 21:35:20.135+00,2025-03-26 21:39:11.985+00,"{""executionOrder"":""v1""}",,{},eca8caec-d35f-45b8-8764-a68777a0a341,0,nDASdqpHaPTANgnj,"{""templateCredsSetupCompleted"":true}",
Workflow Templates,f,"[{""parameters"":{""content"":""# PROMPT-CHAINING\nPrompt chaining decomposes a task into a sequence of steps, where each LLM call processes the output of the previous one.\n\n![Image Description](https://www.anthropic.com/_next/image?url=https%3A%2F%2Fwww-cdn.anthropic.com%2Fimages%2F4zrzovbb%2Fwebsite%2F7418719e3dab222dccb379b8879e1dc08ad34c78-2401x1000.png&w=3840&q=75)\n## When to use this workflow: \nThis workflow is ideal for situations where the task can be easily and cleanly decomposed into fixed subtasks. The main goal is to trade off latency for higher accuracy, by making each LLM call an easier task.\n\nBenefits\n- Breaking down the work into simpler chunks, making it easier for each of the LLM to work on.\n- Allows for more flexibility, being able to use different model in each stage of a task.\n- Easier to debug, as the process is divided into simpler parts."",""height"":660,""width"":740,""color"":7},""type"":""n8n-nodes-base.stickyNote"",""typeVersion"":1,""position"":[0,0],""id"":""2da91a5d-eae2-47b3-8a65-78c37c10269d"",""name"":""Sticky Note""},{""parameters"":{""content"":""# ROUTING\nRouting classifies an input and directs it to a specialized followup task. This workflow allows for separation of concerns, and building more specialized prompts. Without this workflow, optimizing for one kind of input can hurt performance on other inputs.\n\n![Image Description](https://www.anthropic.com/_next/image?url=https%3A%2F%2Fwww-cdn.anthropic.com%2Fimages%2F4zrzovbb%2Fwebsite%2F5c0c0e9fe4def0b584c04d37849941da55e5e71c-2401x1000.png&w=3840&q=75)\n## When to use this workflow: \nRouting works well for complex tasks where there are distinct categories that are better handled separately, and where classification can be handled accurately, either by an LLM or a more traditional classification model/algorithm."",""height"":580,""width"":740,""color"":7},""type"":""n8n-nodes-base.stickyNote"",""typeVersion"":1,""position"":[0,720],""id"":""57b49870-194b-4386-ae74-a8fcfab376cd"",""name"":""Sticky Note1""},{""parameters"":{""content"":""# Parallelization\nLLMs can sometimes work simultaneously on a task and have their outputs aggregated programmatically. This workflow, parallelization, manifests in two key variations:\n## Sectioning: \nBreaking a task into independent subtasks that run in parallel.\n## Voting: \nRunning the same task multiple times to get diverse outputs.\n![Image Description](https://www.anthropic.com/_next/image?url=https%3A%2F%2Fwww-cdn.anthropic.com%2Fimages%2F4zrzovbb%2Fwebsite%2F406bb032ca007fd1624f261af717d70e6ca86286-2401x1000.png&w=3840&q=75)\n## When to use this workflow: \nParallelization is effective when the divided subtasks can be parallelized for speed, or when multiple perspectives or attempts are needed for higher confidence results. For complex tasks with multiple considerations, LLMs generally perform better when each consideration is handled by a separate LLM call, allowing focused attention on each specific aspect."",""height"":700,""width"":740,""color"":7},""type"":""n8n-nodes-base.stickyNote"",""typeVersion"":1,""position"":[0,1380],""id"":""c95e6196-de09-4f09-8010-6ccdce7c0f17"",""name"":""Sticky Note2""},{""parameters"":{""content"":""# Orchestrator-workers\nIn the orchestrator-workers workflow, a central LLM dynamically breaks down tasks, delegates them to worker LLMs, and synthesizes their results.\n![Image Description](https://www.anthropic.com/_next/image?url=https%3A%2F%2Fwww-cdn.anthropic.com%2Fimages%2F4zrzovbb%2Fwebsite%2F8985fc683fae4780fb34eab1365ab78c7e51bc8e-2401x1000.png&w=3840&q=75)\n## When to use this workflow: \nThis workflow is well-suited for complex tasks where you can’t predict the subtasks needed (in coding, for example, the number of files that need to be changed and the nature of the change in each file likely depend on the task). Whereas it’s topographically similar, the key difference from parallelization is its flexibility—subtasks aren't pre-defined, but determined by the orchestrator based on the specific input."",""height"":560,""width"":740,""color"":7},""type"":""n8n-nodes-base.stickyNote"",""typeVersion"":1,""position"":[0,2140],""id"":""f192e955-5bf8-46c2-b78f-fe60a94bd1aa"",""name"":""Sticky Note3""},{""parameters"":{""content"":""# Evaluator-optimizer\nIn the evaluator-optimizer workflow, one LLM call generates a response while another provides evaluation and feedback in a loop.\n![Image Description](https://www.anthropic.com/_next/image?url=https%3A%2F%2Fwww-cdn.anthropic.com%2Fimages%2F4zrzovbb%2Fwebsite%2F14f51e6406ccb29e695da48b17017e899a6119c7-2401x1000.png&w=3840&q=75)\n## When to use this workflow: \nThis workflow is particularly effective when we have clear evaluation criteria, and when iterative refinement provides measurable value. The two signs of good fit are, first, that LLM responses can be demonstrably improved when a human articulates their feedback; and second, that the LLM can provide such feedback. This is analogous to the iterative writing process a human writer might go through when producing a polished document.\n\n"",""height"":600,""width"":740,""color"":7},""type"":""n8n-nodes-base.stickyNote"",""typeVersion"":1,""position"":[0,2760],""id"":""6245c8e2-eb62-424d-8df1-aece32f8edc3"",""name"":""Sticky Note4""},{""parameters"":{""content"":""# Agents\nAgents rely on LLMs’ abilities to understand complex inputs, reason and plan, use tools reliably, and recover from errors. They typically start with either a direct command or an interactive conversation with the user. Once the task is clear, agents plan and operate on their own, but can return to the user for additional information or judgment. During execution, it’s important for them to gather real-time feedback (such as tool results or code execution outputs) to monitor progress. They may pause for human input at checkpoints or when facing obstacles. Tasks usually end upon completion, though stopping conditions (like a maximum number of iterations) are often set for control.\n\nEven though agents can manage complex tasks, their implementation is generally straightforward. They are essentially LLMs that loop through tool usage based on feedback from the environment. As a result, it’s crucial to design both the tools and their documentation with care.\n![Image Description](https://www.anthropic.com/_next/image?url=https%3A%2F%2Fwww-cdn.anthropic.com%2Fimages%2F4zrzovbb%2Fwebsite%2F58d9f10c985c4eb5d53798dea315f7bb5ab6249e-2401x1000.png&w=3840&q=75)\n## When to use this workflow: \nAgents can be used for open-ended problems where it’s difficult or impossible to predict the required number of steps, and where you can’t hardcode a fixed path. The LLM will potentially operate for many turns, and you must have some level of trust in its decision-making. Agents' autonomy makes them ideal for scaling tasks in trusted environments.\n\nThe autonomous nature of agents means higher costs, and the potential for compounding errors. We recommend extensive testing in sandboxed environments, along with the appropriate guardrails.\n\n"",""height"":820,""width"":740,""color"":7},""type"":""n8n-nodes-base.stickyNote"",""typeVersion"":1,""position"":[0,3420],""id"":""67bf57bb-702c-4b84-9321-fb17845b8f7e"",""name"":""Sticky Note5""},{""parameters"":{""modelName"":""models/gemini-2.0-flash-thinking-exp"",""options"":{}},""type"":""@n8n/n8n-nodes-langchain.lmChatGoogleGemini"",""typeVersion"":1,""position"":[1120,400],""id"":""cf7097b9-e796-4a21-ad6a-b2eea79bbfaa"",""name"":""2.0 Flash Thinking""},{""parameters"":{""promptType"":""define"",""text"":""=Write a detailed report in html for the following topic: \""{{ $('Prompt Chaining').item.json.topic }}}\""\n\nfollowing this outline:\n{{ $json.output }}\n\n"",""options"":{}},""type"":""@n8n/n8n-nodes-langchain.agent"",""typeVersion"":1.7,""position"":[1680,220],""id"":""2e4d6541-c871-4c9c-9dd0-7df00bee32bd"",""name"":""Report Generator""},{""parameters"":{""model"":{""__rl"":true,""value"":""o3-mini"",""mode"":""list"",""cachedResultName"":""o3-mini""},""options"":{}},""type"":""@n8n/n8n-nodes-langchain.lmChatOpenAi"",""typeVersion"":1.2,""position"":[1420,420],""id"":""7a242225-6e34-473f-aa2f-deed20e878ff"",""name"":""O3-MINI""},{""parameters"":{""options"":{}},""type"":""@n8n/n8n-nodes-langchain.lmChatAnthropic"",""typeVersion"":1.2,""position"":[1680,420],""id"":""f8df9134-116b-43e5-8ceb-69903c3451ba"",""name"":""Claude 3.5 Sonnet""},{""parameters"":{""inputText"":""=Your objective is to clearly understand what kind of content the user expects based on their request: {{ $json.chatInput }}"",""categories"":{""categories"":[{""category"":""Poem"",""description"":""User is asking for a poem on a topic""},{""category"":""Joke"",""description"":""User is asking for a joke on a topic""},{""category"":""Story"",""description"":""User is asking for a story on a topic""},{""category"":""Not Clear"",""description"":""If it is not clear what kind of content the user wants.""}]},""options"":{}},""type"":""@n8n/n8n-nodes-langchain.textClassifier"",""typeVersion"":1,""position"":[1220,920],""id"":""4d89e87b-cc25-4516-b6e8-626afe50f09f"",""name"":""Text Classifier""},{""parameters"":{""options"":{}},""type"":""@n8n/n8n-nodes-langchain.agent"",""typeVersion"":1.7,""position"":[1700,760],""id"":""38240d28-aac1-4566-93fe-8adcebd8221c"",""name"":""Poem Generator""},{""parameters"":{""options"":{}},""type"":""@n8n/n8n-nodes-langchain.agent"",""typeVersion"":1.7,""position"":[1700,900],""id"":""c05d651d-c7bc-4a49-8e7e-c5a583c0312b"",""name"":""Joke Generator""},{""parameters"":{""options"":{}},""type"":""@n8n/n8n-nodes-langchain.agent"",""typeVersion"":1.7,""position"":[1700,1040],""id"":""d6ca03a9-78f7-4493-8539-7a6276d13ff4"",""name"":""Story Generator""},{""parameters"":{""mode"":""raw"",""jsonOutput"":""{\n  \""output\"":  \""I'm not sure what type of content you're. Could you clarify if you'd like a **Poem**, a **Joke**, or a **Story**?\""\n}\n"",""options"":{}},""type"":""n8n-nodes-base.set"",""typeVersion"":3.4,""position"":[1700,1180],""id"":""8310d4d8-cc32-431e-910a-6388e2a9b659"",""name"":""Error Message""},{""parameters"":{""model"":{""__rl"":true,""value"":""o3-mini"",""mode"":""list"",""cachedResultName"":""o3-mini""},""options"":{}},""type"":""@n8n/n8n-nodes-langchain.lmChatOpenAi"",""typeVersion"":1.2,""position"":[1360,1180],""id"":""897700b3-eaf3-4f6a-98b0-aabc0d8d3ef2"",""name"":""O3-mini-Routing""},{""parameters"":{""promptType"":""define"",""text"":""=Search for top-rated hotels based on \""{{ $json.chatInput }}\"".  \nProvide a concise list including hotel names, price ranges, star ratings, and brief highlights.\n\nInstruction: Always use the SERP API tool."",""options"":{}},""type"":""@n8n/n8n-nodes-langchain.agent"",""typeVersion"":1.7,""position"":[1320,1660],""id"":""20da7106-013b-4d95-a05c-f34f81e9adfc"",""name"":""Hotel Finder""},{""parameters"":{""promptType"":""define"",""text"":""=Search for top-rated restaurants based on \""{{ $json.chatInput }}\"".  \nList 5 recommended restaurants, each with a short description highlighting cuisine type, rating, and popular dishes.\n\nInstruction: Always use the SERP API tool."",""options"":{}},""type"":""@n8n/n8n-nodes-langchain.agent"",""typeVersion"":1.7,""position"":[1320,1460],""id"":""2f2854c0-3926-4c8c-9b32-bb8865a6a787"",""name"":""Restaurant Finder""},{""parameters"":{""options"":{}},""type"":""@n8n/n8n-nodes-langchain.toolSerpApi"",""typeVersion"":1,""position"":[1120,1860],""id"":""0f7eb1b7-10ff-4460-b835-a6cff6002c53"",""name"":""SerpAPI""},{""parameters"":{""promptType"":""define"",""text"":""=Search for popular tourist attractions and activities based on \""{{ $json.chatInput }}\"".  \nGenerate a short list including activity names, types (cultural, outdoor, etc.), and brief descriptions.\n\nInstruction: Always use the SERP API tool."",""options"":{}},""type"":""@n8n/n8n-nodes-langchain.agent"",""typeVersion"":1.7,""position"":[1320,1860],""id"":""a713cef4-259b-4e94-a806-a259cb2cc8a0"",""name"":""Activity Finder""},{""parameters"":{""mode"":""raw"",""jsonOutput"":""={\n  \""output\"": {{ JSON.stringify(`\n🏨 Hotels Recommendations:\n${$('Merge').all()[0].json.output}\n\n👨‍🍳 Restaurant Recommendations:\n${$('Merge').all()[1].json.output}\n\n\n🎯 Activity Recommendations:\n${$('Merge').all()[2].json.output}\n`) }}\n}"",""options"":{}},""type"":""n8n-nodes-base.set"",""typeVersion"":3.4,""position"":[2020,1660],""id"":""53b64f9f-d05f-40d6-9b9e-cbe060032535"",""name"":""Aggregator"",""executeOnce"":true},{""parameters"":{""numberInputs"":3},""type"":""n8n-nodes-base.merge"",""typeVersion"":3,""position"":[1860,1660],""id"":""55cf95a8-0ceb-47d2-80a0-c95e14cbbd9c"",""name"":""Merge"",""executeOnce"":false},{""parameters"":{},""type"":""n8n-nodes-base.manualTrigger"",""typeVersion"":1,""position"":[820,220],""id"":""b5fab9b2-37d6-4eb2-8dfd-e68b012e3d40"",""name"":""When clicking ‘Test workflow’""},{""parameters"":{""promptType"":""define"",""text"":""=You are a creative copywriter.\nThe user wants 3 short, catchy slogans for their brand or product: \""{{ $json.chatInput }}\"".\nEmphasize originality, memorability, and brand appeal in each slogan.\nDo not include any extraneous details or explanations.\n\nFormat your response as follows:\n1. ...\n2. ...\n3. ..."",""options"":{}},""type"":""@n8n/n8n-nodes-langchain.agent"",""typeVersion"":1.7,""position"":[3060,1420],""id"":""d443128c-0b46-4522-b75f-019ef442a4fd"",""name"":""OpenAI CopyWriter""},{""parameters"":{""promptType"":""define"",""text"":""=You are a creative copywriter.\nThe user wants 3 short, catchy slogans for their brand or product: \""{{ $json.chatInput }}\"".\nEmphasize originality, memorability, and brand appeal in each slogan.\nDo not include any extraneous details or explanations.\n\nFormat your response as follows:\n1. ...\n2. ...\n3. ..."",""options"":{}},""type"":""@n8n/n8n-nodes-langchain.agent"",""typeVersion"":1.7,""position"":[3060,1660],""id"":""14afe3d7-6a3e-4fae-b91a-5da753cf3a64"",""name"":""Anthropic CopyWriter""},{""parameters"":{""promptType"":""define"",""text"":""=You are a creative copywriter.\nThe user wants 3 short, catchy slogans for their brand or product: \""{{ $json.chatInput }}\"".\nEmphasize originality, memorability, and brand appeal in each slogan.\nDo not include any extraneous details or explanations.\n\nFormat your response as follows:\n1. ...\n2. ...\n3. ..."",""options"":{}},""type"":""@n8n/n8n-nodes-langchain.agent"",""typeVersion"":1.7,""position"":[3060,1900],""id"":""20372096-ec50-449b-a2d0-92be0de8084e"",""name"":""Gemini CopyWriter""},{""parameters"":{""modelName"":""models/gemini-2.0-flash-thinking-exp"",""options"":{}},""type"":""@n8n/n8n-nodes-langchain.lmChatGoogleGemini"",""typeVersion"":1,""position"":[3060,1540],""id"":""b9a9d834-91c6-499b-85cb-1c4d5c2c482c"",""name"":""2.0 Flash CW""},{""parameters"":{""options"":{}},""type"":""@n8n/n8n-nodes-langchain.lmChatAnthropic"",""typeVersion"":1.2,""position"":[3060,1780],""id"":""46db5dc8-f0d3-4edf-88d8-17f7f85b92b6"",""name"":""Claude 3.5 CW""},{""parameters"":{""model"":{""__rl"":true,""value"":""o3-mini"",""mode"":""list"",""cachedResultName"":""o3-mini""},""options"":{}},""type"":""@n8n/n8n-nodes-langchain.lmChatOpenAi"",""typeVersion"":1.2,""position"":[3060,2020],""id"":""5b978d50-8b87-4250-84eb-415566b26df6"",""name"":""O3-MINI CW""},{""parameters"":{""numberInputs"":3},""type"":""n8n-nodes-base.merge"",""typeVersion"":3,""position"":[3600,1700],""id"":""f275b121-dceb-4967-af2f-15febc5385c4"",""name"":""Voting Merge""},{""parameters"":{""mode"":""raw"",""jsonOutput"":""={\n  \""output\"": {{ JSON.stringify(`\n2.0 Flash:\n${$('Voting Merge').all()[0].json.output}\n\nClaude 3.5:\n${$('Voting Merge').all()[1].json.output}\n\nO3-MINI:\n${$('Voting Merge').all()[2].json.output}\n`) }}\n}"",""options"":{}},""type"":""n8n-nodes-base.set"",""typeVersion"":3.4,""position"":[3800,1700],""id"":""efcab783-06ab-4507-a861-127a102ce8cb"",""name"":""CW Aggregator"",""executeOnce"":true},{""parameters"":{""sendTo"":""mahmutktech98@gmail.com"",""subject"":""Copy Writer Demo"",""emailType"":""text"",""message"":""={{ $json.output }}"",""options"":{}},""type"":""n8n-nodes-base.gmail"",""typeVersion"":2.1,""position"":[2220,1660],""id"":""ef3fc565-bce3-4da9-9d82-ef751290b52d"",""name"":""Sectioning Demo"",""webhookId"":""080228b9-3925-4009-8241-9b3854616590""},{""parameters"":{""sendTo"":""mahmutktech98@gmail.com"",""subject"":""Copy Writer Demo"",""emailType"":""text"",""message"":""={{ $json.output }}"",""options"":{}},""type"":""n8n-nodes-base.gmail"",""typeVersion"":2.1,""position"":[4000,1700],""id"":""86db4b14-7fd7-4b70-a0cc-a61bdc87bcfa"",""name"":""CW Demo"",""webhookId"":""080228b9-3925-4009-8241-9b3854616590""},{""parameters"":{""promptType"":""define"",""text"":""=Email Content: {{$json.output}}"",""hasOutputParser"":true,""options"":{""systemMessage"":""=You are the Email Evaluator for TechSpark\n\nYou will receive an email content\n\nEvaluate the email based on:\n- Clarity and completeness.\n- Tone (professional, friendly, etc.).\n- Proper sign-off as \""John Doe\"".\n- Text should not include the \""Subject\""\n\nReturn your evaluation as valid JSON with one of the following formats:\n\n1. If the email passes all criteria:\n{\n  \""pass\"": true\n}\n\n2. If the email does not meet all criteria:\n{\n  \""pass\"": false,\n  \""feedback\"": \""Provide concise, actionable suggestions here.\""\n}\n\nNo extra keys or text outside the JSON structure.""}},""type"":""@n8n/n8n-nodes-langchain.agent"",""typeVersion"":1.7,""position"":[1940,2900],""id"":""19dbca8d-800b-45b0-9ebf-f2f0efb4a9f8"",""name"":""Evaluator""},{""parameters"":{""conditions"":{""options"":{""caseSensitive"":true,""leftValue"":"""",""typeValidation"":""strict"",""version"":2},""conditions"":[{""id"":""c7cd25e9-31ab-4c2a-8880-0148aea726c2"",""leftValue"":""={{ $json.output.pass }}"",""rightValue"":"""",""operator"":{""type"":""boolean"",""operation"":""true"",""singleValue"":true}}],""combinator"":""and""},""options"":{}},""type"":""n8n-nodes-base.if"",""typeVersion"":2.2,""position"":[2260,2900],""id"":""3935cbb8-fa91-45cc-9702-6d4b21689ec9"",""name"":""If""},{""parameters"":{""jsonSchemaExample"":""{\n\t\""pass\"": true,\n\t\""feedback\"": \""this is empty when pass is true\""\n}""},""type"":""@n8n/n8n-nodes-langchain.outputParserStructured"",""typeVersion"":1.2,""position"":[2120,3120],""id"":""618d2f17-e409-4da5-912e-a8ca88f9f7ac"",""name"":""Structured Output Parser""},{""parameters"":{""model"":{""__rl"":true,""value"":""o3-mini"",""mode"":""list"",""cachedResultName"":""o3-mini""},""options"":{}},""type"":""@n8n/n8n-nodes-langchain.lmChatOpenAi"",""typeVersion"":1.2,""position"":[1600,3160],""id"":""e463bca6-c9db-440b-9353-9681b4bef062"",""name"":""EO - o3 mini""},{""parameters"":{""pollTimes"":{""item"":[{""mode"":""everyMinute""}]},""simple"":false,""filters"":{},""options"":{}},""type"":""n8n-nodes-base.gmailTrigger"",""typeVersion"":1.2,""position"":[840,2920],""id"":""d577c04f-3f42-4b6f-ae28-8c139967b974"",""name"":""Gmail Trigger""},{""parameters"":{""promptType"":""define"",""text"":""={{ $json.text }}"",""options"":{""systemMessage"":""=You are a Customer Support Specialist at TechSpark Solutions.\n\nYou will be provided with a customer inquiry\n\nPrepare a concise, polite, and helpful email response addressing the customer’s question or concern.  \n\nOutput only the final email text—no extra commentary or formatting.\n\n\n\n<feedback> (if any)\n{{ $json.feedback }}\n\n\n<preparedEmail> (if an email is already prepared, this is what the feedback is on)\n{{ $json.currentEmail }}\n</preparedEmail>\n</feedback>""}},""type"":""@n8n/n8n-nodes-langchain.agent"",""typeVersion"":1.7,""position"":[1560,2900],""id"":""ed864f96-8873-4fef-8bb0-c560fb377af1"",""name"":""Customer Support""},{""parameters"":{""resource"":""thread"",""operation"":""reply"",""threadId"":""={{ $('Gmail Trigger').first().json.threadId }}"",""messageId"":""={{ $('Gmail Trigger').first().json.id }}"",""message"":""={{ $('Customer Support').last().json.output }}"",""options"":{}},""type"":""n8n-nodes-base.gmail"",""typeVersion"":2.1,""position"":[2560,2880],""id"":""338b95a1-8688-4599-90e8-3932e35160b6"",""name"":""Gmail"",""webhookId"":""58be091c-293b-4fcc-8c56-56da568e0637""},{""parameters"":{""mode"":""raw"",""jsonOutput"":""={\n  \""currentEmail\"": {{ JSON.stringify($('Customer Support').last().json.output) }},\n  \""feedback\"": {{  JSON.stringify($json.output.feedback) }},\n  \""text\"": {{  JSON.stringify($('Gmail Trigger').first().json.text) }}\n}"",""options"":{}},""type"":""n8n-nodes-base.set"",""typeVersion"":3.4,""position"":[1840,3140],""id"":""ad7ce952-19c6-4dd3-ac15-c741944fd73f"",""name"":""feedback""},{""parameters"":{""inputText"":""={{ $json.text }}"",""categories"":{""categories"":[{""category"":""Customer Inquiry"",""description"":""Text where the user requests assistance, more information, or expresses a concern about a product or service.""},{""category"":""No Action Required"",""description"":""Text that does not ask a question, seek information, or require a direct response.""}]},""options"":{""systemPromptTemplate"":""You are a text classifier at TechSpark Solutions.\nPlease classify the text provided by the user into one of the following categories: {categories}, and use the provided formatting instructions below. Don't explain, and only output the json.""}},""type"":""@n8n/n8n-nodes-langchain.textClassifier"",""typeVersion"":1,""position"":[1120,2920],""id"":""48a8c49d-a5fd-484b-94de-aab5fdb4155e"",""name"":""Classify Email""},{""parameters"":{""mode"":""raw"",""jsonOutput"":""{\n  \""chatInput\"": \""Taksim, Istanbul\""\n}\n"",""options"":{}},""type"":""n8n-nodes-base.set"",""typeVersion"":3.4,""position"":[1060,1680],""id"":""4c170680-b08b-461c-be1d-e9ba1fa16691"",""name"":""Sectioning""},{""parameters"":{""mode"":""raw"",""jsonOutput"":""{\n  \""chatInput\"": \""Aithletic an AI Driven Fitness App, that will personalized exercises based on user profile\""\n}\n"",""options"":{}},""type"":""n8n-nodes-base.set"",""typeVersion"":3.4,""position"":[2700,1660],""id"":""23107e7a-4ab4-41e7-9506-e17d98732da2"",""name"":""Voting""},{""parameters"":{""mode"":""raw"",""jsonOutput"":""{\n  \""chatInput\"": \""tell me a joke about a cat\""\n}\n"",""options"":{}},""type"":""n8n-nodes-base.set"",""typeVersion"":3.4,""position"":[1060,920],""id"":""16a7a31c-6d69-4431-aa42-860325f58a54"",""name"":""Routing""},{""parameters"":{""mode"":""raw"",""jsonOutput"":""{\n  \""topic\"": \""obesity\""\n}\n"",""options"":{}},""type"":""n8n-nodes-base.set"",""typeVersion"":3.4,""position"":[960,220],""id"":""3c16902a-a86f-4bab-a78d-30a816c28ea4"",""name"":""Prompt Chaining""},{""parameters"":{""options"":{}},""type"":""@n8n/n8n-nodes-langchain.chatTrigger"",""typeVersion"":1.1,""position"":[900,3660],""id"":""215c4de2-0c07-46c4-a2bc-4c70b7588020"",""name"":""When chat message received"",""webhookId"":""03da4a05-c510-4577-b723-d695740de587""},{""parameters"":{""model"":{""__rl"":true,""value"":""o3-mini"",""mode"":""list"",""cachedResultName"":""o3-mini""},""options"":{}},""type"":""@n8n/n8n-nodes-langchain.lmChatOpenAi"",""typeVersion"":1.2,""position"":[980,3900],""id"":""fc514686-1cd5-4c22-a624-9361998c87cd"",""name"":""Agents - O3-MINI""},{""parameters"":{""operation"":""getAll"",""calendar"":{""__rl"":true,""value"":""mahmutktech98@gmail.com"",""mode"":""list"",""cachedResultName"":""mahmutktech98@gmail.com""},""limit"":""={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Limit', ``, 'number') }}"",""timeMin"":""={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('After', ``, 'string') }}"",""timeMax"":""={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Before', ``, 'string') }}"",""options"":{}},""type"":""n8n-nodes-base.googleCalendarTool"",""typeVersion"":1.3,""position"":[1560,3880],""id"":""f243b835-7881-49f8-8070-29c1d3d8a169"",""name"":""Get Events""},{""parameters"":{""calendar"":{""__rl"":true,""value"":""mahmutktech98@gmail.com"",""mode"":""list"",""cachedResultName"":""mahmutktech98@gmail.com""},""start"":""={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Start', ``, 'string') }}"",""end"":""={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('End', ``, 'string') }}"",""additionalFields"":{""attendees"":[""={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Attendees', `Event Attendees`, 'string') }}""],""description"":""={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Description', ``, 'string') }}"",""summary"":""={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Summary', `Event Title`, 'string') }}""}},""type"":""n8n-nodes-base.googleCalendarTool"",""typeVersion"":1.3,""position"":[1440,3880],""id"":""2d4a5e99-c150-4cec-800d-77eae3c4461e"",""name"":""Create Calendar Event""},{""parameters"":{""options"":{""systemMessage"":""=You are a helpful calendar assistant.\n\nContext:\nCurrent Date Time: {{ $now }}}""}},""type"":""@n8n/n8n-nodes-langchain.agent"",""typeVersion"":1.7,""position"":[1100,3660],""id"":""48f980b1-50e8-40d3-8176-e3efe90669ec"",""name"":""Calendar Agent""},{""parameters"":{""mode"":""raw"",""jsonOutput"":""{\n  \""input\"": \""Please translate the following to Spanish, Turkish, and French -> Hello! I just arrived in Barcelona, and I’m already captivated by the city’s vibrant atmosphere. The weather is sunny and warm, perfect for exploring the narrow streets and sampling local tapas. Tomorrow, I plan to visit the famous Sagrada Família, and next week I’ll head to Madrid for a brief business meeting. Traveling always broadens my perspective, and I can’t wait to discover more of Spain’s rich culture and history.\""\n}\n"",""options"":{}},""type"":""n8n-nodes-base.set"",""typeVersion"":3.4,""position"":[1040,2300],""id"":""e5ee8544-a092-44f6-a4b0-c4a45d657a72"",""name"":""Orchestrator""},{""parameters"":{""promptType"":""define"",""text"":""={{ $json.input }}\n"",""hasOutputParser"":true,""options"":{""systemMessage"":""=You are an Orchestrator. A user will provide a text and the language(s) they want to translate the text into.\n\nYour goal:\n1. Identify all languages the user wants to translate the text into.\n2. Identify the text\"".\n3. Produce a valid JSON array where each element has:\n   {\n     \""Language\"": \""<target language>\"",\n     \""text\"": \""<original text>\""\n   }\n\nConstraints:\n- Output only the JSON array, nothing else.\n- If multiple languages are listed, create one object per language.\n- If no languages are mentioned, output an empty array.\n\nExample Input:\n\""Please translate the following to Spanish, Turkish, and French -> Hello! I just arrived in Barcelona...\""\n\nExpected Output (valid JSON):\n[\n  {\n    \""Language\"": \""Spanish\"",\n    \""text\"": \""Hello! I just arrived in Barcelona...\""\n  },\n  {\n    \""Language\"": \""Turkish\"",\n    \""text\"": \""Hello! I just arrived in Barcelona...\""\n  },\n  {\n    \""Language\"": \""French\"",\n    \""text\"": \""Hello! I just arrived in Barcelona...\""\n  }\n]""}},""type"":""@n8n/n8n-nodes-langchain.agent"",""typeVersion"":1.7,""position"":[1220,2300],""id"":""dde8238b-0c33-406f-a80b-abce585d8707"",""name"":""Orchestrator Agent""},{""parameters"":{""model"":{""__rl"":true,""value"":""o3-mini"",""mode"":""list"",""cachedResultName"":""o3-mini""},""options"":{}},""type"":""@n8n/n8n-nodes-langchain.lmChatOpenAi"",""typeVersion"":1.2,""position"":[1660,2540],""id"":""159930b8-7c63-499f-aae1-23fabb1d9cc8"",""name"":""O3-mini-Routing2""},{""parameters"":{""model"":{""__rl"":true,""value"":""o3-mini"",""mode"":""list"",""cachedResultName"":""o3-mini""},""options"":{}},""type"":""@n8n/n8n-nodes-langchain.lmChatOpenAi"",""typeVersion"":1.2,""position"":[1120,1520],""id"":""415f5383-6fb0-48b4-9ca0-06468feb05d0"",""name"":""O3-mini-P""},{""parameters"":{},""type"":""@n8n/n8n-nodes-langchain.memoryBufferWindow"",""typeVersion"":1.3,""position"":[1120,3940],""id"":""5fdebf6c-6e73-469d-9e55-9f4d0dcaebdc"",""name"":""Window Buffer Memory""},{""parameters"":{""fieldToSplitOut"":""output"",""options"":{}},""type"":""n8n-nodes-base.splitOut"",""typeVersion"":1,""position"":[1560,2300],""id"":""152b3d18-4c05-4691-8a54-368930f4fc88"",""name"":""Split Out""},{""parameters"":{""jsonSchemaExample"":""[\n  {\n    \""Language\"": \""Spanish\"",\n    \""text\"": \""Sample text, Hi there, My name is John\""\n  }\n]""},""type"":""@n8n/n8n-nodes-langchain.outputParserStructured"",""typeVersion"":1.2,""position"":[1380,2560],""id"":""1c8aa339-e115-40ef-876b-0f234c058429"",""name"":""Translation Array""},{""parameters"":{""fieldsToAggregate"":{""fieldToAggregate"":[{""fieldToAggregate"":""output""}]},""options"":{}},""type"":""n8n-nodes-base.aggregate"",""typeVersion"":1,""position"":[2060,2300],""id"":""dae51242-cf86-49d2-b73a-0378ae255fdc"",""name"":""Translated Text""},{""parameters"":{""promptType"":""define"",""text"":""=You are a Translator Agent.\n\nPlease translate the text below into: {{ $json.Language }}\n\nText to translate:\n{{ $json.text }}\n\nOutput only the translated text With the translated language as the title, with no additional commentary."",""options"":{}},""type"":""@n8n/n8n-nodes-langchain.agent"",""typeVersion"":1.7,""position"":[1740,2300],""id"":""e26d89b1-23e6-4713-bd19-8e8359af0a98"",""name"":""Translator Agent""},{""parameters"":{""sendTo"":""oncekod98@gmail.com"",""subject"":""=Translated Text"",""emailType"":""text"",""message"":""={{ $json.output.join('\\n\\n') }}"",""options"":{}},""type"":""n8n-nodes-base.gmail"",""typeVersion"":2.1,""position"":[2280,2300],""id"":""b4fa86ff-b245-46f8-a004-ac0732fe8cce"",""name"":""Gmail3"",""webhookId"":""39a7f851-3576-477c-8ec6-792a05230062""},{""parameters"":{""promptType"":""define"",""text"":""=List concise, structured key points and angles about the following topic: {{ $json.topic }}"",""options"":{}},""type"":""@n8n/n8n-nodes-langchain.agent"",""typeVersion"":1.7,""position"":[1100,220],""id"":""f7c34a80-c3e5-44fe-8873-c3702a04facf"",""name"":""Key Points Generator"",""retryOnFail"":false},{""parameters"":{""sendTo"":""=mahmutktech98@gmail.com"",""subject"":""Prompt Chaining Demo"",""message"":""={{ $json.output }}"",""options"":{}},""type"":""n8n-nodes-base.gmail"",""typeVersion"":2.1,""position"":[1980,220],""id"":""08b17c69-a420-43df-b6f2-e7b92ed2e435"",""name"":""Gmail4"",""webhookId"":""4e66298d-d364-4ea5-846c-7673a94a9839""},{""parameters"":{""sendTo"":""={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('To', ``, 'string') }}"",""subject"":""={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Subject', ``, 'string') }}"",""message"":""={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Message', ``, 'string') }}"",""options"":{}},""type"":""n8n-nodes-base.gmailTool"",""typeVersion"":2.1,""position"":[1320,3880],""id"":""8923301f-3b9f-4d0e-bc0a-6c167be4316c"",""name"":""Send Email"",""webhookId"":""71a39428-8b08-4105-88fb-5c7ca0e4fa16""},{""parameters"":{""promptType"":""define"",""text"":""=Using the following notes as a reference:\n{{$json.output}}\n\nCreate a report outline for \""{{$('Prompt Chaining').item.json.topic}}\"".  \nInclude clearly named sections with brief descriptions, structured as follows:\n- Introduction\n- Main body sections\n- Conclusion"",""options"":{}},""type"":""@n8n/n8n-nodes-langchain.agent"",""typeVersion"":1.7,""position"":[1400,220],""id"":""f81b9df7-3c82-4560-bdb1-6ad57082f930"",""name"":""Report Planner""}]","{""2.0 Flash Thinking"":{""ai_languageModel"":[[{""node"":""Key Points Generator"",""type"":""ai_languageModel"",""index"":0}]]},""Report Generator"":{""main"":[[{""node"":""Gmail4"",""type"":""main"",""index"":0}]]},""O3-MINI"":{""ai_languageModel"":[[{""node"":""Report Planner"",""type"":""ai_languageModel"",""index"":0}]]},""Claude 3.5 Sonnet"":{""ai_languageModel"":[[{""node"":""Report Generator"",""type"":""ai_languageModel"",""index"":0}]]},""Text Classifier"":{""main"":[[{""node"":""Poem Generator"",""type"":""main"",""index"":0}],[{""node"":""Joke Generator"",""type"":""main"",""index"":0}],[{""node"":""Story Generator"",""type"":""main"",""index"":0}],[{""node"":""Error Message"",""type"":""main"",""index"":0}]]},""O3-mini-Routing"":{""ai_languageModel"":[[{""node"":""Text Classifier"",""type"":""ai_languageModel"",""index"":0},{""node"":""Poem Generator"",""type"":""ai_languageModel"",""index"":0},{""node"":""Joke Generator"",""type"":""ai_languageModel"",""index"":0},{""node"":""Story Generator"",""type"":""ai_languageModel"",""index"":0}]]},""SerpAPI"":{""ai_tool"":[[{""node"":""Restaurant Finder"",""type"":""ai_tool"",""index"":0},{""node"":""Hotel Finder"",""type"":""ai_tool"",""index"":0},{""node"":""Activity Finder"",""type"":""ai_tool"",""index"":0}]]},""Restaurant Finder"":{""main"":[[{""node"":""Merge"",""type"":""main"",""index"":0}]]},""Hotel Finder"":{""main"":[[{""node"":""Merge"",""type"":""main"",""index"":1}]]},""Activity Finder"":{""main"":[[{""node"":""Merge"",""type"":""main"",""index"":2}]]},""Merge"":{""main"":[[{""node"":""Aggregator"",""type"":""main"",""index"":0}]]},""When clicking ‘Test workflow’"":{""main"":[[{""node"":""Prompt Chaining"",""type"":""main"",""index"":0}]]},""2.0 Flash CW"":{""ai_languageModel"":[[{""node"":""OpenAI CopyWriter"",""type"":""ai_languageModel"",""index"":0}]]},""Claude 3.5 CW"":{""ai_languageModel"":[[{""node"":""Anthropic CopyWriter"",""type"":""ai_languageModel"",""index"":0}]]},""O3-MINI CW"":{""ai_languageModel"":[[{""node"":""Gemini CopyWriter"",""type"":""ai_languageModel"",""index"":0}]]},""OpenAI CopyWriter"":{""main"":[[{""node"":""Voting Merge"",""type"":""main"",""index"":0}]]},""Anthropic CopyWriter"":{""main"":[[{""node"":""Voting Merge"",""type"":""main"",""index"":1}]]},""Gemini CopyWriter"":{""main"":[[{""node"":""Voting Merge"",""type"":""main"",""index"":2}]]},""Voting Merge"":{""main"":[[{""node"":""CW Aggregator"",""type"":""main"",""index"":0}]]},""CW Aggregator"":{""main"":[[{""node"":""CW Demo"",""type"":""main"",""index"":0}]]},""Aggregator"":{""main"":[[{""node"":""Sectioning Demo"",""type"":""main"",""index"":0}]]},""Evaluator"":{""main"":[[{""node"":""If"",""type"":""main"",""index"":0}]]},""Structured Output Parser"":{""ai_outputParser"":[[{""node"":""Evaluator"",""type"":""ai_outputParser"",""index"":0}]]},""EO - o3 mini"":{""ai_languageModel"":[[{""node"":""Customer Support"",""type"":""ai_languageModel"",""index"":0},{""node"":""Evaluator"",""type"":""ai_languageModel"",""index"":0},{""node"":""Classify Email"",""type"":""ai_languageModel"",""index"":0}]]},""Gmail Trigger"":{""main"":[[{""node"":""Classify Email"",""type"":""main"",""index"":0}]]},""Customer Support"":{""main"":[[{""node"":""Evaluator"",""type"":""main"",""index"":0}]]},""If"":{""main"":[[{""node"":""Gmail"",""type"":""main"",""index"":0}],[{""node"":""feedback"",""type"":""main"",""index"":0}]]},""feedback"":{""main"":[[{""node"":""Customer Support"",""type"":""main"",""index"":0}]]},""Classify Email"":{""main"":[[{""node"":""Customer Support"",""type"":""main"",""index"":0}]]},""Sectioning"":{""main"":[[{""node"":""Restaurant Finder"",""type"":""main"",""index"":0},{""node"":""Hotel Finder"",""type"":""main"",""index"":0},{""node"":""Activity Finder"",""type"":""main"",""index"":0}]]},""Voting"":{""main"":[[{""node"":""OpenAI CopyWriter"",""type"":""main"",""index"":0},{""node"":""Anthropic CopyWriter"",""type"":""main"",""index"":0},{""node"":""Gemini CopyWriter"",""type"":""main"",""index"":0}]]},""Routing"":{""main"":[[{""node"":""Text Classifier"",""type"":""main"",""index"":0}]]},""Prompt Chaining"":{""main"":[[{""node"":""Key Points Generator"",""type"":""main"",""index"":0}]]},""When chat message received"":{""main"":[[{""node"":""Calendar Agent"",""type"":""main"",""index"":0}]]},""Agents - O3-MINI"":{""ai_languageModel"":[[{""node"":""Calendar Agent"",""type"":""ai_languageModel"",""index"":0}]]},""Get Events"":{""ai_tool"":[[{""node"":""Calendar Agent"",""type"":""ai_tool"",""index"":0}]]},""Create Calendar Event"":{""ai_tool"":[[{""node"":""Calendar Agent"",""type"":""ai_tool"",""index"":0}]]},""Orchestrator"":{""main"":[[{""node"":""Orchestrator Agent"",""type"":""main"",""index"":0}]]},""O3-mini-P"":{""ai_languageModel"":[[{""node"":""Restaurant Finder"",""type"":""ai_languageModel"",""index"":0},{""node"":""Hotel Finder"",""type"":""ai_languageModel"",""index"":0},{""node"":""Activity Finder"",""type"":""ai_languageModel"",""index"":0}]]},""O3-mini-Routing2"":{""ai_languageModel"":[[{""node"":""Orchestrator Agent"",""type"":""ai_languageModel"",""index"":0},{""node"":""Translator Agent"",""type"":""ai_languageModel"",""index"":0}]]},""Window Buffer Memory"":{""ai_memory"":[[{""node"":""Calendar Agent"",""type"":""ai_memory"",""index"":0}]]},""Orchestrator Agent"":{""main"":[[{""node"":""Split Out"",""type"":""main"",""index"":0}]]},""Split Out"":{""main"":[[{""node"":""Translator Agent"",""type"":""main"",""index"":0}]]},""Translation Array"":{""ai_outputParser"":[[{""node"":""Orchestrator Agent"",""type"":""ai_outputParser"",""index"":0}]]},""Translator Agent"":{""main"":[[{""node"":""Translated Text"",""type"":""main"",""index"":0}]]},""Translated Text"":{""main"":[[{""node"":""Gmail3"",""type"":""main"",""index"":0}]]},""Key Points Generator"":{""main"":[[{""node"":""Report Planner"",""type"":""main"",""index"":0}]]},""Send Email"":{""ai_tool"":[[{""node"":""Calendar Agent"",""type"":""ai_tool"",""index"":0}]]},""Report Planner"":{""main"":[[{""node"":""Report Generator"",""type"":""main"",""index"":0}]]}}",2025-03-26 21:39:40.039+00,2025-03-26 21:39:40.039+00,"{""executionOrder"":""v1""}",,{},059e1d59-3a2c-44ef-a754-751994ebbef8,0,y8tcO4PE6l5eor4p,,
Revised RAG Strategy,f,"[{""parameters"":{""pollTimes"":{""item"":[{""mode"":""everyMinute""}]},""triggerOn"":""specificFolder"",""folderToWatch"":{""__rl"":true,""value"":""1D6zsbD669KBrIAySAAxVrVIOsI-LwZQN"",""mode"":""list"",""cachedResultName"":""Traditional RAG"",""cachedResultUrl"":""https://drive.google.com/drive/folders/1D6zsbD669KBrIAySAAxVrVIOsI-LwZQN""},""event"":""fileCreated"",""options"":{}},""type"":""n8n-nodes-base.googleDriveTrigger"",""typeVersion"":1,""position"":[960,120],""id"":""9700f603-be84-4946-a0be-a284deb601bb"",""name"":""Traditional Rag""},{""parameters"":{""operation"":""pdf"",""options"":{}},""type"":""n8n-nodes-base.extractFromFile"",""typeVersion"":1,""position"":[2040,0],""id"":""a92a5402-6cb1-4139-81a0-0e909a2730ed"",""name"":""Extract from PDF""},{""parameters"":{""mode"":""insert"",""pineconeIndex"":{""__rl"":true,""value"":""traditionalrag"",""mode"":""list"",""cachedResultName"":""traditionalrag""},""options"":{""pineconeNamespace"":""={{$('TR FILE INFO').item.json.namespace}}""}},""type"":""@n8n/n8n-nodes-langchain.vectorStorePinecone"",""typeVersion"":1,""position"":[2760,100],""id"":""dad32820-d874-4a1d-b70f-be5b558ed0ac"",""name"":""Pinecone Vector Store""},{""parameters"":{""jsonMode"":""=expressionData"",""jsonData"":""={{ $json.data }}"",""options"":{""metadata"":{""metadataValues"":[{""name"":""file_url"",""value"":""={{ $('TR FILE INFO').item.json.file_url }}""}]}}},""type"":""@n8n/n8n-nodes-langchain.documentDefaultDataLoader"",""typeVersion"":1,""position"":[2840,280],""id"":""ad050e95-717f-4842-b49d-05f37a3350cf"",""name"":""Default Data Loader""},{""parameters"":{""options"":{}},""type"":""@n8n/n8n-nodes-langchain.embeddingsOpenAi"",""typeVersion"":1.2,""position"":[2720,320],""id"":""e5e6c1e6-1c0c-4c47-8889-566fe6388f60"",""name"":""Embeddings OpenAI""},{""parameters"":{""operation"":""text"",""options"":{}},""type"":""n8n-nodes-base.extractFromFile"",""typeVersion"":1,""position"":[2040,200],""id"":""b87fc848-46dd-4aeb-a438-2149d5061562"",""name"":""Extract from Text""},{""parameters"":{""options"":{}},""type"":""@n8n/n8n-nodes-langchain.chatTrigger"",""typeVersion"":1.1,""position"":[3480,280],""id"":""2169c5e2-61e5-4bbe-8179-d39eb3c023a5"",""name"":""When chat message received"",""webhookId"":""4bb02f4f-104a-4a9c-90f1-8fcda075475b""},{""parameters"":{""model"":{""__rl"":true,""value"":""o3-mini"",""mode"":""list"",""cachedResultName"":""o3-mini""},""options"":{}},""type"":""@n8n/n8n-nodes-langchain.lmChatOpenAi"",""typeVersion"":1.2,""position"":[3500,500],""id"":""05eb9b56-48bc-4c8c-82cb-7950f6bd59f1"",""name"":""OpenAI Chat Model""},{""parameters"":{},""type"":""@n8n/n8n-nodes-langchain.memoryBufferWindow"",""typeVersion"":1.3,""position"":[3640,540],""id"":""7dbb8fbc-dbbd-4923-a89d-6cd6b0b0264e"",""name"":""Window Buffer Memory""},{""parameters"":{""options"":{}},""type"":""@n8n/n8n-nodes-langchain.embeddingsOpenAi"",""typeVersion"":1.2,""position"":[3800,620],""id"":""d91668c7-f7a8-443b-950c-1bd42b39089a"",""name"":""Embeddings OpenAI1""},{""parameters"":{""mode"":""retrieve-as-tool"",""toolName"":""companyinformation"",""toolDescription"":""This is Pinecone's Vector Store tool"",""pineconeIndex"":{""__rl"":true,""value"":""contextualrag"",""mode"":""list"",""cachedResultName"":""contextualrag""},""topK"":10,""options"":{""pineconeNamespace"":""=Financial""}},""type"":""@n8n/n8n-nodes-langchain.vectorStorePinecone"",""typeVersion"":1,""position"":[3760,480],""id"":""46821373-d1b8-448c-a888-86138f7c9e1c"",""name"":""Pinecone VS""},{""parameters"":{""mode"":""raw"",""jsonOutput"":""={\n  \""data\"": {{JSON.stringify($json.text)}}\n}\n"",""options"":{}},""type"":""n8n-nodes-base.set"",""typeVersion"":3.4,""position"":[2060,820],""id"":""01c665b0-5c7c-42d8-b0cc-9c17d710db84"",""name"":""PDF TO DATA""},{""parameters"":{""mode"":""raw"",""jsonOutput"":""={\n  \""data\"": {{ JSON.stringify($json.data) }}\n}\n"",""options"":{}},""type"":""n8n-nodes-base.set"",""typeVersion"":3.4,""position"":[2200,880],""id"":""bab7585b-58ca-4e8b-ac1b-2709bf16959a"",""name"":""Document Data""},{""parameters"":{""pollTimes"":{""item"":[{""mode"":""everyMinute""}]},""triggerOn"":""specificFolder"",""folderToWatch"":{""__rl"":true,""value"":""1NCA5mw1B_S7qVfShntWM9sjJ4vzOGsj4"",""mode"":""list"",""cachedResultName"":""Contextual RAG"",""cachedResultUrl"":""https://drive.google.com/drive/folders/1NCA5mw1B_S7qVfShntWM9sjJ4vzOGsj4""},""event"":""fileCreated"",""options"":{}},""type"":""n8n-nodes-base.googleDriveTrigger"",""typeVersion"":1,""position"":[960,820],""id"":""f5d511f6-b22a-45e0-b672-3732e7ea2111"",""name"":""Contextual Rag""},{""parameters"":{""fieldToSplitOut"":""chunks"",""options"":{""destinationFieldName"":""chunk""}},""type"":""n8n-nodes-base.splitOut"",""typeVersion"":1,""position"":[2460,880],""id"":""7a36381e-dc37-4501-82dc-12eefab3fa54"",""name"":""Split Chunks""},{""parameters"":{""promptType"":""define"",""text"":""=<document> \n{{ $('Document Data').item.json.data }}\n</document> \n\nHere is the chunk we want to situate within the overall document:\n\n<chunk> \n{{$json.chunk}} \n</chunk> \n\nPlease:\n- Provide a short and succinct **context** to situate this chunk within the document for improved search retrieval.\n- Return the **original chunk** exactly as provided unless a correction is necessary.\n- If the chunk contains an **incomplete number, percentage, or entity**, correct it using the full document.\n- If part of a **sentence is cut off**, reconstruct the missing words only if necessary for clarity.\n- If the chunk is part of a table, include the complete table entry to maintain data integrity\n- Do not add any additional explanations or formatting beyond the required output.\n\nFill in the following format:\n[succinct context] : [original chunk or corrected version if necessary]\n\nYour response should contain only the text that replaces these placeholders, without including the placeholder labels themselves.""},""type"":""@n8n/n8n-nodes-langchain.chainLlm"",""typeVersion"":1.5,""position"":[2680,880],""id"":""4303eed7-13c6-4cb6-b595-5aa2600f395b"",""name"":""Basic LLM Chain""},{""parameters"":{""modelName"":""models/gemini-2.0-flash"",""options"":{}},""type"":""@n8n/n8n-nodes-langchain.lmChatGoogleGemini"",""typeVersion"":1,""position"":[2600,1060],""id"":""baf20c42-dcfb-4ba2-9611-86c54d600ff2"",""name"":""Google Gemini Chat Model""},{""parameters"":{""fieldsToSummarize"":{""values"":[{""aggregation"":""concatenate"",""field"":""text"",""separateBy"":""other"",""customSeparator"":"" ###SPLIT### ""}]},""options"":{}},""type"":""n8n-nodes-base.summarize"",""typeVersion"":1.1,""position"":[2960,880],""id"":""e5448ee7-7bbf-4e1d-a7cd-f7d481433d4c"",""name"":""Summarize""},{""parameters"":{""separator"":"" ###SPLIT### "",""chunkSize"":1200},""type"":""@n8n/n8n-nodes-langchain.textSplitterCharacterTextSplitter"",""typeVersion"":1,""position"":[3020,1420],""id"":""717ce640-80fc-4e64-845c-e4640ffb65be"",""name"":""Character Text Splitter""},{""parameters"":{""model"":{""__rl"":true,""value"":""o3-mini"",""mode"":""list"",""cachedResultName"":""o3-mini""},""options"":{}},""type"":""@n8n/n8n-nodes-langchain.lmChatOpenAi"",""typeVersion"":1.2,""position"":[1140,280],""id"":""e247c8f5-63f4-48a5-9c3e-1febf3b78690"",""name"":""OpenAI Chat Model1""},{""parameters"":{""model"":{""__rl"":true,""value"":""o3-mini"",""mode"":""list"",""cachedResultName"":""o3-mini""},""options"":{}},""type"":""@n8n/n8n-nodes-langchain.lmChatOpenAi"",""typeVersion"":1.2,""position"":[1260,1040],""id"":""70963c06-1972-4d59-87ea-3a3a38ac37fa"",""name"":""OpenAI Chat Model2""},{""parameters"":{""assignments"":{""assignments"":[{""id"":""10646eae-ae46-4327-a4dc-9987c2d76173"",""name"":""file_id"",""value"":""={{ $('Traditional Rag').item.json.id }}"",""type"":""string""},{""id"":""f4536df5-d0b1-4392-bf17-b8137fb31a44"",""name"":""file_type"",""value"":""={{ $('Traditional Rag').item.json.mimeType }}"",""type"":""string""},{""id"":""9bde4d7f-e4f3-4ebd-9338-dce1350f9eab"",""name"":""file_url"",""value"":""={{ $('Traditional Rag').item.json.webViewLink }}"",""type"":""string""},{""id"":""77d782de-169d-4a46-8a8e-a3831c04d90f"",""name"":""file_title"",""value"":""={{ $('Traditional Rag').item.json.name }}"",""type"":""string""},{""id"":""d6cf9a9b-e79b-4ea6-912a-70e285e57429"",""name"":""namespace"",""value"":""={{ $json.output.namespace }}"",""type"":""string""}]},""options"":{}},""id"":""b841e728-c780-4a8a-a544-241d760e7f50"",""name"":""TR FILE INFO"",""type"":""n8n-nodes-base.set"",""typeVersion"":3.4,""position"":[1460,120]},{""parameters"":{""assignments"":{""assignments"":[{""id"":""10646eae-ae46-4327-a4dc-9987c2d76173"",""name"":""file_id"",""value"":""={{ $('Contextual Rag').item.json.id }}"",""type"":""string""},{""id"":""f4536df5-d0b1-4392-bf17-b8137fb31a44"",""name"":""file_type"",""value"":""={{ $('Contextual Rag').item.json.mimeType }}"",""type"":""string""},{""id"":""9bde4d7f-e4f3-4ebd-9338-dce1350f9eab"",""name"":""file_url"",""value"":""={{ $('Contextual Rag').item.json.webViewLink }}"",""type"":""string""},{""id"":""77d782de-169d-4a46-8a8e-a3831c04d90f"",""name"":""file_title"",""value"":""={{ $('Contextual Rag').item.json.name }}"",""type"":""string""},{""id"":""8c444ba2-e384-45a3-9492-3c9d21b82cd5"",""name"":""namespace"",""value"":""={{ $json.output.namespace }}"",""type"":""string""}]},""options"":{}},""id"":""56fa2e75-3e9a-4183-8a47-c99daa0f18aa"",""name"":""CR FILE INFO"",""type"":""n8n-nodes-base.set"",""typeVersion"":3.4,""position"":[1520,880]},{""parameters"":{""operation"":""download"",""fileId"":{""__rl"":true,""value"":""={{ $json.file_id }}"",""mode"":""id""},""options"":{""googleFileConversion"":{""conversion"":{""docsToFormat"":""text/plain""}}}},""type"":""n8n-nodes-base.googleDrive"",""typeVersion"":3,""position"":[1640,120],""id"":""7da1f250-b329-4ab0-b646-862a1d8eb8a4"",""name"":""TR GOOGLE DRIVE""},{""parameters"":{""operation"":""download"",""fileId"":{""__rl"":true,""value"":""={{ $json.file_id }}"",""mode"":""id""},""options"":{""googleFileConversion"":{""conversion"":{""docsToFormat"":""text/plain""}}}},""type"":""n8n-nodes-base.googleDrive"",""typeVersion"":3,""position"":[1640,880],""id"":""e45eaa89-1c96-4662-8e0b-8a42cb7a98f5"",""name"":""CR GOOGLE DRIVE""},{""parameters"":{""rules"":{""values"":[{""conditions"":{""options"":{""caseSensitive"":true,""leftValue"":"""",""typeValidation"":""strict"",""version"":1},""conditions"":[{""leftValue"":""={{ $('TR FILE INFO').item.json.file_type }}"",""rightValue"":""application/pdf"",""operator"":{""type"":""string"",""operation"":""equals""},""id"":""8d105126-f9ee-4b83-9afb-8f410c455124""}],""combinator"":""and""}},{""conditions"":{""options"":{""caseSensitive"":true,""leftValue"":"""",""typeValidation"":""strict"",""version"":1},""conditions"":[{""id"":""b69f5605-0179-4b02-9a32-e34bb085f82d"",""leftValue"":""={{ $('TR FILE INFO').item.json.file_type }}"",""rightValue"":""text/plain"",""operator"":{""type"":""string"",""operation"":""equals"",""name"":""filter.operator.equals""}}],""combinator"":""and""}}]},""options"":{}},""id"":""6f3a4dc8-59bd-4586-839c-68b6d6c40812"",""name"":""TR SWITCH"",""type"":""n8n-nodes-base.switch"",""typeVersion"":3,""position"":[1820,120]},{""parameters"":{""rules"":{""values"":[{""conditions"":{""options"":{""caseSensitive"":true,""leftValue"":"""",""typeValidation"":""strict"",""version"":1},""conditions"":[{""leftValue"":""={{ $('CR FILE INFO').item.json.file_type }}"",""rightValue"":""application/pdf"",""operator"":{""type"":""string"",""operation"":""equals""},""id"":""8d105126-f9ee-4b83-9afb-8f410c455124""}],""combinator"":""and""}},{""conditions"":{""options"":{""caseSensitive"":true,""leftValue"":"""",""typeValidation"":""strict"",""version"":1},""conditions"":[{""id"":""b69f5605-0179-4b02-9a32-e34bb085f82d"",""leftValue"":""={{ $('CR FILE INFO').item.json.file_type }}"",""rightValue"":""text/plain"",""operator"":{""type"":""string"",""operation"":""equals"",""name"":""filter.operator.equals""}}],""combinator"":""and""}}]},""options"":{}},""id"":""4cd88368-60a6-453b-adb9-a1159a52362b"",""name"":""CR SWITCH"",""type"":""n8n-nodes-base.switch"",""typeVersion"":3,""position"":[1760,880]},{""parameters"":{""operation"":""pdf"",""options"":{}},""type"":""n8n-nodes-base.extractFromFile"",""typeVersion"":1,""position"":[1920,820],""id"":""6e01a540-c132-489a-b2eb-57ac225b15aa"",""name"":""CR Extract from PDF""},{""parameters"":{""operation"":""text"",""options"":{}},""type"":""n8n-nodes-base.extractFromFile"",""typeVersion"":1,""position"":[1980,980],""id"":""f2221504-f7eb-4ddf-894b-4dba6e22b1df"",""name"":""CR Extract from Text""},{""parameters"":{""mode"":""insert"",""pineconeIndex"":{""__rl"":true,""value"":""contextualrag"",""mode"":""list"",""cachedResultName"":""contextualrag""},""options"":{""pineconeNamespace"":""={{ $('CR FILE INFO').item.json.namespace }}""}},""type"":""@n8n/n8n-nodes-langchain.vectorStorePinecone"",""typeVersion"":1,""position"":[3020,1020],""id"":""ae3565c2-2e0a-4cbd-a100-4a3607154814"",""name"":""CR Pinecone Vector Store""},{""parameters"":{""options"":{""metadata"":{""metadataValues"":[{""name"":""=file_url"",""value"":""={{ $('CR FILE INFO').item.json.file_url }}""}]}}},""type"":""@n8n/n8n-nodes-langchain.documentDefaultDataLoader"",""typeVersion"":1,""position"":[3020,1260],""id"":""ad2d92b8-38ed-47b9-9220-7753417d907c"",""name"":""CR Data Loader""},{""parameters"":{""options"":{}},""type"":""@n8n/n8n-nodes-langchain.embeddingsOpenAi"",""typeVersion"":1.2,""position"":[3000,1340],""id"":""00097515-629b-48fd-9c12-95ce40d87b17"",""name"":""CR EMBEDDING""},{""parameters"":{""text"":""={{ $json.name }}"",""attributes"":{""attributes"":[{""name"":""namespace"",""description"":""The category this document belongs to - 'Financial' Or 'FAQ'""}]},""options"":{""systemPromptTemplate"":""=You are an expert extraction algorithm.\nOnly extract relevant information from the text.\nIf you do not know the value of an attribute asked to extract, you may omit the attribute's value.\n\nDetermine the document category based on its title, it could either be 'Financial' Or 'FAQ'""}},""type"":""@n8n/n8n-nodes-langchain.informationExtractor"",""typeVersion"":1,""position"":[1240,880],""id"":""7ae981ba-376b-4d0b-a59e-fd581ee27b5d"",""name"":""CR Namespace Classifier""},{""parameters"":{""text"":""={{ $json.name }}"",""attributes"":{""attributes"":[{""name"":""namespace"",""description"":""The category this document belongs to - 'Financial' Or 'FAQ'""}]},""options"":{""systemPromptTemplate"":""=You are an expert extraction algorithm.\nOnly extract relevant information from the text.\nIf you do not know the value of an attribute asked to extract, you may omit the attribute's value.\n\nDetermine the document category based on its title, it could either be 'Financial' Or 'FAQ'""}},""type"":""@n8n/n8n-nodes-langchain.informationExtractor"",""typeVersion"":1,""position"":[1140,120],""id"":""fbba5fed-5c37-41dd-a40f-ed96f26fb3a6"",""name"":""TR Namespace Classifier""},{""parameters"":{""mode"":""raw"",""jsonOutput"":""={\n  \""data\"": {{JSON.stringify($json.text)}}\n}\n"",""options"":{}},""type"":""n8n-nodes-base.set"",""typeVersion"":3.4,""position"":[2220,0],""id"":""7bf72c45-d45a-4c1a-bb4f-b4d531cf7900"",""name"":""TR PDF TO DATA""},{""parameters"":{""mode"":""raw"",""jsonOutput"":""={\n  \""data\"": {{ JSON.stringify($json.data) }}\n}\n"",""options"":{}},""type"":""n8n-nodes-base.set"",""typeVersion"":3.4,""position"":[2500,100],""id"":""43bfe4f6-cc3f-4838-8472-63c0bf998477"",""name"":""TR Document Data""},{""parameters"":{""options"":{""systemMessage"":""=You are a RAG agent, who has access to a Pinecone's Vector Database. Your job is to fetch relevant information from the knowledge base that addresses the user query. \n\nThere are two kinds of namespaces, and they are the following: \n'FAQ' - Query this Vector Namepsace when a user query indicates frequently asked questions.\n'Financial' - This is for financial related queries \n""}},""type"":""@n8n/n8n-nodes-langchain.agent"",""typeVersion"":1.7,""position"":[3640,280],""id"":""b28e3946-a57c-4f68-82bc-1db7252b8592"",""name"":""RAG Agent""},{""parameters"":{""mode"":""runOnceForEachItem"",""jsCode"":""const chunkSize = 1000;\nconst chunkOverlap = 200;\nconst text = $input.item.json.data.replace(/\\n/, '');\n\nconst chunks = [];\nlet remainingText = text;\n\nwhile (remainingText.length > 0) {\n    let splitPoint;\n\n    // Try splitting at paragraph level first\n    splitPoint = remainingText.lastIndexOf(\""\\n\\n\"", chunkSize);\n    \n    // If no paragraph split, try splitting at sentence level\n    if (splitPoint === -1) {\n        splitPoint = remainingText.lastIndexOf(\"". \"", chunkSize);\n    }\n\n    // If no sentence split, try splitting at word level\n    if (splitPoint === -1) {\n        splitPoint = remainingText.lastIndexOf(\"" \"", chunkSize);\n    }\n\n    // If still no split point, force cut at chunkSize\n    if (splitPoint === -1 || splitPoint < chunkSize * 0.5) {  \n        splitPoint = chunkSize; // Hard split if no good split point\n    }\n\n    // Extract chunk and adjust remaining text with overlap\n    let chunk = remainingText.substring(0, splitPoint).trim();\n    chunks.push(chunk);\n\n    // Move the pointer forward while keeping the overlap\n    remainingText = remainingText.substring(Math.max(0, splitPoint - chunkOverlap)).trim();\n\n    // Break if remaining text is too small to form another chunk\n    if (remainingText.length < chunkSize * 0.2) {\n        chunks.push(remainingText);\n        break;\n    }\n}\n\nreturn { chunks };""},""type"":""n8n-nodes-base.code"",""typeVersion"":2,""position"":[2340,880],""id"":""c8fb8dca-1195-45ef-aadb-3c91c978674b"",""name"":""Recursive Splitter""},{""parameters"":{""options"":{}},""type"":""n8n-nodes-base.splitInBatches"",""typeVersion"":3,""position"":[1100,820],""id"":""14f176bd-e02f-4c55-84b0-e2d40a31c7d0"",""name"":""Loop Over Items""},{""parameters"":{""content"":""# TRADITIONAL RAG\n![Contextual RAG Diagram](https://i.imgur.com/cY5futu.png)\n### Steps – Basic Embedding Flow\n1. Break document into chunks.  \n2. Convert chunks into vector embeddings.  \n3. Insert the vector embeddings into a vector database.  "",""height"":500,""width"":860,""color"":7},""type"":""n8n-nodes-base.stickyNote"",""typeVersion"":1,""position"":[0,0],""id"":""48e63484-be8e-4d03-a81f-785cb226bc2a"",""name"":""Sticky Note""},{""parameters"":{""content"":""# CONTEXTUAL RAG\n![Contextual RAG Diagram](https://i.imgur.com/QnR5Jw0.png)\n### Steps – Contextualized Embedding Flow\n1. Break document into chunks.  \n2. Pass each chunk along with the whole document to an LLM to contextualize and fix possible data corruption.  \n3. Convert contextualized chunks into vector embeddings.  \n4. Insert the vector embeddings into a vector database.  "",""height"":420,""width"":860,""color"":7},""type"":""n8n-nodes-base.stickyNote"",""typeVersion"":1,""position"":[0,760],""id"":""42318e6c-7e35-4e98-978b-5d9c42fdd0cd"",""name"":""Sticky Note1""},{""parameters"":{""chunkOverlap"":200,""options"":{}},""type"":""@n8n/n8n-nodes-langchain.textSplitterRecursiveCharacterTextSplitter"",""typeVersion"":1,""position"":[2860,460],""id"":""6d45e483-a414-404e-8dde-1b839fba9eed"",""name"":""Recursive Character Text Splitter""}]","{""Traditional Rag"":{""main"":[[{""node"":""TR Namespace Classifier"",""type"":""main"",""index"":0}]]},""Extract from PDF"":{""main"":[[{""node"":""TR PDF TO DATA"",""type"":""main"",""index"":0}]]},""Default Data Loader"":{""ai_document"":[[{""node"":""Pinecone Vector Store"",""type"":""ai_document"",""index"":0}]]},""Embeddings OpenAI"":{""ai_embedding"":[[{""node"":""Pinecone Vector Store"",""type"":""ai_embedding"",""index"":0}]]},""Extract from Text"":{""main"":[[{""node"":""TR Document Data"",""type"":""main"",""index"":0}]]},""When chat message received"":{""main"":[[{""node"":""RAG Agent"",""type"":""main"",""index"":0}]]},""OpenAI Chat Model"":{""ai_languageModel"":[[{""node"":""RAG Agent"",""type"":""ai_languageModel"",""index"":0}]]},""Window Buffer Memory"":{""ai_memory"":[[{""node"":""RAG Agent"",""type"":""ai_memory"",""index"":0}]]},""Embeddings OpenAI1"":{""ai_embedding"":[[{""node"":""Pinecone VS"",""type"":""ai_embedding"",""index"":0}]]},""Pinecone VS"":{""ai_tool"":[[{""node"":""RAG Agent"",""type"":""ai_tool"",""index"":0}]]},""PDF TO DATA"":{""main"":[[{""node"":""Document Data"",""type"":""main"",""index"":0}]]},""Document Data"":{""main"":[[{""node"":""Recursive Splitter"",""type"":""main"",""index"":0}]]},""Contextual Rag"":{""main"":[[{""node"":""Loop Over Items"",""type"":""main"",""index"":0}]]},""Split Chunks"":{""main"":[[{""node"":""Basic LLM Chain"",""type"":""main"",""index"":0}]]},""Google Gemini Chat Model"":{""ai_languageModel"":[[{""node"":""Basic LLM Chain"",""type"":""ai_languageModel"",""index"":0}]]},""Basic LLM Chain"":{""main"":[[{""node"":""Summarize"",""type"":""main"",""index"":0}]]},""Summarize"":{""main"":[[{""node"":""CR Pinecone Vector Store"",""type"":""main"",""index"":0}]]},""Character Text Splitter"":{""ai_textSplitter"":[[{""node"":""CR Data Loader"",""type"":""ai_textSplitter"",""index"":0}]]},""OpenAI Chat Model1"":{""ai_languageModel"":[[{""node"":""TR Namespace Classifier"",""type"":""ai_languageModel"",""index"":0}]]},""OpenAI Chat Model2"":{""ai_languageModel"":[[{""node"":""CR Namespace Classifier"",""type"":""ai_languageModel"",""index"":0}]]},""TR FILE INFO"":{""main"":[[{""node"":""TR GOOGLE DRIVE"",""type"":""main"",""index"":0}]]},""CR FILE INFO"":{""main"":[[{""node"":""CR GOOGLE DRIVE"",""type"":""main"",""index"":0}]]},""TR GOOGLE DRIVE"":{""main"":[[{""node"":""TR SWITCH"",""type"":""main"",""index"":0}]]},""CR GOOGLE DRIVE"":{""main"":[[{""node"":""CR SWITCH"",""type"":""main"",""index"":0}]]},""TR SWITCH"":{""main"":[[{""node"":""Extract from PDF"",""type"":""main"",""index"":0}],[{""node"":""Extract from Text"",""type"":""main"",""index"":0}]]},""CR SWITCH"":{""main"":[[{""node"":""CR Extract from PDF"",""type"":""main"",""index"":0}],[{""node"":""CR Extract from Text"",""type"":""main"",""index"":0}]]},""CR Extract from PDF"":{""main"":[[{""node"":""PDF TO DATA"",""type"":""main"",""index"":0}]]},""CR Extract from Text"":{""main"":[[{""node"":""Document Data"",""type"":""main"",""index"":0}]]},""CR Data Loader"":{""ai_document"":[[{""node"":""CR Pinecone Vector Store"",""type"":""ai_document"",""index"":0}]]},""CR EMBEDDING"":{""ai_embedding"":[[{""node"":""CR Pinecone Vector Store"",""type"":""ai_embedding"",""index"":0}]]},""CR Namespace Classifier"":{""main"":[[{""node"":""CR FILE INFO"",""type"":""main"",""index"":0}]]},""TR Namespace Classifier"":{""main"":[[{""node"":""TR FILE INFO"",""type"":""main"",""index"":0}]]},""TR PDF TO DATA"":{""main"":[[{""node"":""TR Document Data"",""type"":""main"",""index"":0}]]},""TR Document Data"":{""main"":[[{""node"":""Pinecone Vector Store"",""type"":""main"",""index"":0}]]},""Recursive Splitter"":{""main"":[[{""node"":""Split Chunks"",""type"":""main"",""index"":0}]]},""Loop Over Items"":{""main"":[[],[{""node"":""CR Namespace Classifier"",""type"":""main"",""index"":0}]]},""CR Pinecone Vector Store"":{""main"":[[{""node"":""Loop Over Items"",""type"":""main"",""index"":0}]]},""Recursive Character Text Splitter"":{""ai_textSplitter"":[[{""node"":""Default Data Loader"",""type"":""ai_textSplitter"",""index"":0}]]}}",2025-03-26 22:04:44.036+00,2025-03-26 22:04:44.036+00,"{""executionOrder"":""v1""}",,{},afff3ffc-36b9-4587-860c-0928af763ba7,0,vAntP5LeDH9pEBt2,,
Local Adapted V1,f,"[{""parameters"":{""jsonMode"":""expressionData"",""jsonData"":""={{ $('Concatenate the context and section text').item.json.section_chunk || $json.text || $json.concatenated_data }}"",""options"":{""metadata"":{""metadataValues"":[{""name"":""=file_id"",""value"":""={{ $('Set File ID').first().json.file_id }}""},{""name"":""file_title"",""value"":""={{ $('Set File ID').first().json.file_title }}""},{""name"":""language"",""value"":""={{ $('Extract PDF Text')?.item.json.info.Language }}""}]}}},""id"":""1cae3c6a-23c4-48b5-a373-67d777d8bf78"",""name"":""Default Data Loader"",""type"":""@n8n/n8n-nodes-langchain.documentDefaultDataLoader"",""typeVersion"":1,""position"":[3280,1280]},{""parameters"":{""content"":""## Agent Tools for RAG"",""height"":528.85546469693,""width"":583.4552380860637,""color"":4},""id"":""e9321c49-18be-43dd-9b98-cf3f83ff519b"",""name"":""Sticky Note"",""type"":""n8n-nodes-base.stickyNote"",""typeVersion"":1,""position"":[2300,140]},{""parameters"":{""content"":""## Tool to Add a Google Drive File to Vector DB"",""height"":867,""width"":3073,""color"":5},""id"":""ada39d17-c5d9-4d55-8668-ee81f4c62cf4"",""name"":""Sticky Note1"",""type"":""n8n-nodes-base.stickyNote"",""typeVersion"":1,""position"":[560,680]},{""parameters"":{""operation"":""text"",""options"":{}},""id"":""382e8ec3-1d41-4858-a0b7-dc9cddd63a77"",""name"":""Extract Document Text"",""type"":""n8n-nodes-base.extractFromFile"",""typeVersion"":1,""position"":[2500,1280],""alwaysOutputData"":true},{""parameters"":{},""id"":""fc6ec2fb-b6d0-44c6-88dd-91f7fa9177a8"",""name"":""Postgres Chat Memory"",""type"":""@n8n/n8n-nodes-langchain.memoryPostgresChat"",""typeVersion"":1,""position"":[1700,500],""notesInFlow"":false,""credentials"":{""postgres"":{""id"":""i83SgkPKmlQ785tT"",""name"":""Postgres account""}}},{""parameters"":{""assignments"":{""assignments"":[{""id"":""10646eae-ae46-4327-a4dc-9987c2d76173"",""name"":""file_id"",""value"":""={{ $('Loop Over Items').item.json.path }}"",""type"":""string""},{""id"":""f4536df5-d0b1-4392-bf17-b8137fb31a44"",""name"":""file_type"",""value"":""={{ $('Loop Over Items').item.json.path.split(/[\\\\/]/).pop().split('.').pop(); }}"",""type"":""string""},{""id"":""77d782de-169d-4a46-8a8e-a3831c04d90f"",""name"":""file_title"",""value"":""={{ $('Loop Over Items').item.json.path.split(/[\\\\/]/).pop().split('.').slice(0, -1).join('.'); }}"",""type"":""string""},{""id"":""2b905513-2e63-4f52-be63-e5344553af2d"",""name"":""namespace"",""value"":""={{ $json.output.namespace }}"",""type"":""string""}]},""options"":{}},""id"":""30fe7b1f-6dff-4895-be06-c4ce69b9bd34"",""name"":""Set File ID"",""type"":""n8n-nodes-base.set"",""typeVersion"":3.4,""position"":[960,1020]},{""parameters"":{""content"":""## RAG AI Agent with Chat Interface"",""height"":464.8027193303974,""width"":1035.6381264595484},""id"":""60f67ff8-101c-4864-afe7-cf775419630e"",""name"":""Sticky Note2"",""type"":""n8n-nodes-base.stickyNote"",""typeVersion"":1,""position"":[1260,200]},{""parameters"":{""operation"":""pdf"",""options"":{}},""id"":""aef1930f-4911-43c3-a1b6-ad73e91a1883"",""name"":""Extract PDF Text"",""type"":""n8n-nodes-base.extractFromFile"",""typeVersion"":1,""position"":[2500,720]},{""parameters"":{""aggregate"":""aggregateAllItemData"",""options"":{}},""id"":""bb625819-ab15-4178-870a-9473426a88a5"",""name"":""Aggregate"",""type"":""n8n-nodes-base.aggregate"",""typeVersion"":1,""position"":[2540,900]},{""parameters"":{""fieldsToSummarize"":{""values"":[{""aggregation"":""concatenate"",""field"":""data""}]},""options"":{}},""id"":""4908a617-600b-47f4-8228-baa76392a616"",""name"":""Summarize"",""type"":""n8n-nodes-base.summarize"",""typeVersion"":1,""position"":[2740,980]},{""parameters"":{""promptType"":""define"",""text"":""={{ $json.chatInput }}"",""options"":{""systemMessage"":""You are a personal assistant who helps answer questions from a corpus of documents. The documents are either text based (Txt, docs, extracted PDFs, etc.) or tabular data (CSVs or Excel documents).\n\nYou are given tools to perform RAG in the 'documents' table, look up the documents available in your knowledge base in the 'document_metadata' table, extract all the text from a given document, and query the tabular files with SQL in the 'document_rows' table.\n\nAlways start by performing RAG unless the users asks you to check a document or the question requires a SQL query for tabular data (fetching a sum, finding a max, something a RAG lookup would be unreliable for). If RAG doesn't help, then look at the documents that are available to you, find a few that you think would contain the answer, and then analyze those.\n\nAlways tell the user if you didn't find the answer. Don't make something up just to please them.""}},""id"":""913692ca-fba3-4c4b-a94e-1c402ad0a3af"",""name"":""RAG AI Agent"",""type"":""@n8n/n8n-nodes-langchain.agent"",""typeVersion"":1.6,""position"":[1780,280],""notesInFlow"":true},{""parameters"":{""rules"":{""values"":[{""conditions"":{""options"":{""caseSensitive"":true,""leftValue"":"""",""typeValidation"":""strict"",""version"":1},""conditions"":[{""leftValue"":""={{ $('Set File ID').item.json.file_type }}"",""rightValue"":""pdf"",""operator"":{""type"":""string"",""operation"":""equals""}}],""combinator"":""and""}},{""conditions"":{""options"":{""caseSensitive"":true,""leftValue"":"""",""typeValidation"":""strict"",""version"":1},""conditions"":[{""id"":""2ae7faa7-a936-4621-a680-60c512163034"",""leftValue"":""={{ $('Set File ID').item.json.file_type }}"",""rightValue"":""xlsx"",""operator"":{""type"":""string"",""operation"":""equals"",""name"":""filter.operator.equals""}}],""combinator"":""and""}},{""conditions"":{""options"":{""caseSensitive"":true,""leftValue"":"""",""typeValidation"":""strict"",""version"":1},""conditions"":[{""id"":""fc193b06-363b-4699-a97d-e5a850138b0e"",""leftValue"":""={{ $('Set File ID').item.json.file_type }}"",""rightValue"":""=csv"",""operator"":{""type"":""string"",""operation"":""equals"",""name"":""filter.operator.equals""}}],""combinator"":""and""}},{""conditions"":{""options"":{""caseSensitive"":true,""leftValue"":"""",""typeValidation"":""strict"",""version"":1},""conditions"":[{""id"":""b69f5605-0179-4b02-9a32-e34bb085f82d"",""leftValue"":""={{ $('Set File ID').item.json.file_type }}"",""rightValue"":""txt"",""operator"":{""type"":""string"",""operation"":""equals"",""name"":""filter.operator.equals""}}],""combinator"":""and""}}]},""options"":{""fallbackOutput"":3}},""id"":""208b1471-8ac3-4f4c-abf1-65f9184306bf"",""name"":""Switch"",""type"":""n8n-nodes-base.switch"",""typeVersion"":3,""position"":[1840,940]},{""parameters"":{""operation"":""xlsx"",""options"":{}},""id"":""5651b444-e5dc-4993-80ca-714b4852f811"",""name"":""Extract from Excel"",""type"":""n8n-nodes-base.extractFromFile"",""typeVersion"":1,""position"":[2320,900]},{""parameters"":{""assignments"":{""assignments"":[{""id"":""f422e2e0-381c-46ea-8f38-3f58c501d8b9"",""name"":""schema"",""value"":""={{ $('Extract from Excel').isExecuted ? $('Extract from Excel').first().json.keys().toJsonString() : $('Extract from CSV').first().json.keys().toJsonString() }}"",""type"":""string""},{""id"":""bb07c71e-5b60-4795-864c-cc3845b6bc46"",""name"":""data"",""value"":""={{ $json.concatenated_data }}"",""type"":""string""}]},""options"":{}},""type"":""n8n-nodes-base.set"",""typeVersion"":3.4,""position"":[3180,840],""id"":""cf24de3f-ce47-437c-a295-904ab2e6ab50"",""name"":""Set Schema""},{""parameters"":{""options"":{}},""type"":""n8n-nodes-base.extractFromFile"",""typeVersion"":1,""position"":[2320,1080],""id"":""1cb9f9bb-848d-4065-af10-6d898d8c8655"",""name"":""Extract from CSV""},{""parameters"":{""content"":""## Run Each Node Once to Set Up Database Tables"",""height"":300,""width"":680,""color"":3},""type"":""n8n-nodes-base.stickyNote"",""position"":[560,360],""typeVersion"":1,""id"":""1775e61f-4094-437f-84c0-7fb5a27b2f83"",""name"":""Sticky Note3""},{""parameters"":{""operation"":""executeQuery"",""query"":""CREATE TABLE document_metadata (\n    id TEXT PRIMARY KEY,\n    title TEXT,\n    created_at TIMESTAMP DEFAULT NOW(),\n    schema TEXT,\n    NAMESPACE TEXT,\n    LANGUAGE TEXT\n);"",""options"":{}},""type"":""n8n-nodes-base.postgres"",""typeVersion"":2.5,""position"":[680,460],""id"":""5915c7b4-b01b-492c-8841-067bc498e6b0"",""name"":""Create Document Metadata Table"",""credentials"":{""postgres"":{""id"":""i83SgkPKmlQ785tT"",""name"":""Postgres account""}}},{""parameters"":{""operation"":""executeQuery"",""query"":""CREATE TABLE document_rows (\n    id SERIAL PRIMARY KEY,\n    dataset_id TEXT REFERENCES document_metadata(id),\n    row_data JSONB  -- Store the actual row data\n);"",""options"":{}},""type"":""n8n-nodes-base.postgres"",""typeVersion"":2.5,""position"":[980,460],""id"":""0f916c19-3666-4146-a957-9d521e1372c9"",""name"":""Create Document Rows Table (for Tabular Data)"",""credentials"":{""postgres"":{""id"":""i83SgkPKmlQ785tT"",""name"":""Postgres account""}}},{""parameters"":{""descriptionType"":""manual"",""toolDescription"":""Use this tool to fetch all available documents, including the table schema if the file is a CSV or Excel file."",""operation"":""select"",""schema"":{""__rl"":true,""mode"":""list"",""value"":""public""},""table"":{""__rl"":true,""value"":""document_metadata"",""mode"":""list"",""cachedResultName"":""document_metadata""},""returnAll"":true,""options"":{}},""type"":""n8n-nodes-base.postgresTool"",""typeVersion"":2.5,""position"":[1840,500],""id"":""9a565ae0-d7f8-4827-adaa-744f273dbab4"",""name"":""List Documents"",""credentials"":{""postgres"":{""id"":""i83SgkPKmlQ785tT"",""name"":""Postgres account""}}},{""parameters"":{""descriptionType"":""manual"",""toolDescription"":""Given a file ID, fetches the text from the document."",""operation"":""executeQuery"",""query"":""SELECT \n    string_agg(text, ' ') as document_text\nFROM documents_pg\n  WHERE metadata->>'file_id' = $1\nGROUP BY metadata->>'file_id';"",""options"":{""queryReplacement"":""={{ $fromAI('file_id') }}""}},""type"":""n8n-nodes-base.postgresTool"",""typeVersion"":2.5,""position"":[1980,500],""id"":""ccf81f44-4a22-4649-84a9-bbefa7dfe878"",""name"":""Get File Contents"",""credentials"":{""postgres"":{""id"":""i83SgkPKmlQ785tT"",""name"":""Postgres account""}}},{""parameters"":{""descriptionType"":""manual"",""toolDescription"":""Run a SQL query - use this to query from the document_rows table once you know the file ID (which is the file path) you are querying. dataset_id is the file_id (file path) and you are always using the row_data for filtering, which is a jsonb field that has all the keys from the file schema given in the document_metadata table.\n\nExample query:\n\nSELECT AVG((row_data->>'revenue')::numeric)\nFROM document_rows\nWHERE dataset_id = '/data/shared/document.csv';\n\nExample query 2:\n\nSELECT \n    row_data->>'category' as category,\n    SUM((row_data->>'sales')::numeric) as total_sales\nFROM dataset_rows\nWHERE dataset_id = '/data/shared/document2.csv'\nGROUP BY row_data->>'category';"",""operation"":""executeQuery"",""query"":""{{ $fromAI('sql_query') }}"",""options"":{}},""type"":""n8n-nodes-base.postgresTool"",""typeVersion"":2.5,""position"":[2140,500],""id"":""687105a8-85d6-4dd3-b95d-52fd85c88d4d"",""name"":""Query Document Rows"",""credentials"":{""postgres"":{""id"":""i83SgkPKmlQ785tT"",""name"":""Postgres account""}}},{""parameters"":{""options"":{""reset"":false}},""type"":""n8n-nodes-base.splitInBatches"",""typeVersion"":3,""position"":[880,760],""id"":""4d76769f-8f64-4607-9515-ccbf66620aaf"",""name"":""Loop Over Items""},{""parameters"":{""operation"":""upsert"",""schema"":{""__rl"":true,""mode"":""list"",""value"":""public""},""table"":{""__rl"":true,""value"":""document_metadata"",""mode"":""list"",""cachedResultName"":""document_metadata""},""columns"":{""mappingMode"":""defineBelow"",""value"":{""id"":""={{ $('Set File ID').item.json.file_id }}"",""title"":""={{ $('Set File ID').item.json.file_title }}"",""namespace"":""={{ $('Set File ID').item.json.namespace }}""},""matchingColumns"":[""id""],""schema"":[{""id"":""id"",""displayName"":""id"",""required"":true,""defaultMatch"":true,""display"":true,""type"":""string"",""canBeUsedToMatch"":true,""removed"":false},{""id"":""title"",""displayName"":""title"",""required"":false,""defaultMatch"":false,""display"":true,""type"":""string"",""canBeUsedToMatch"":false},{""id"":""created_at"",""displayName"":""created_at"",""required"":false,""defaultMatch"":false,""display"":true,""type"":""dateTime"",""canBeUsedToMatch"":false},{""id"":""schema"",""displayName"":""schema"",""required"":false,""defaultMatch"":false,""display"":true,""type"":""string"",""canBeUsedToMatch"":false,""removed"":true},{""id"":""namespace"",""displayName"":""namespace"",""required"":false,""defaultMatch"":false,""display"":true,""type"":""string"",""canBeUsedToMatch"":false,""removed"":false},{""id"":""language"",""displayName"":""language"",""required"":false,""defaultMatch"":false,""display"":true,""type"":""string"",""canBeUsedToMatch"":false,""removed"":false}],""attemptToConvertTypes"":false,""convertFieldsToString"":false},""options"":{}},""type"":""n8n-nodes-base.postgres"",""typeVersion"":2.5,""position"":[1480,820],""id"":""2ff5afbc-4823-4706-b48a-c486bf3ff2fd"",""name"":""Insert Document Metadata"",""executeOnce"":true,""credentials"":{""postgres"":{""id"":""i83SgkPKmlQ785tT"",""name"":""Postgres account""}}},{""parameters"":{""schema"":{""__rl"":true,""mode"":""list"",""value"":""public""},""table"":{""__rl"":true,""value"":""document_rows"",""mode"":""list"",""cachedResultName"":""document_rows""},""columns"":{""mappingMode"":""defineBelow"",""value"":{""dataset_id"":""={{ $('Set File ID').item.json.file_id }}"",""row_data"":""={{ $json.toJsonString().replaceAll(/'/g, \""''\"") }}""},""matchingColumns"":[""id""],""schema"":[{""id"":""id"",""displayName"":""id"",""required"":false,""defaultMatch"":true,""display"":true,""type"":""number"",""canBeUsedToMatch"":true,""removed"":true},{""id"":""dataset_id"",""displayName"":""dataset_id"",""required"":false,""defaultMatch"":false,""display"":true,""type"":""string"",""canBeUsedToMatch"":true,""removed"":false},{""id"":""row_data"",""displayName"":""row_data"",""required"":false,""defaultMatch"":false,""display"":true,""type"":""object"",""canBeUsedToMatch"":true,""removed"":false}],""attemptToConvertTypes"":false,""convertFieldsToString"":false},""options"":{}},""type"":""n8n-nodes-base.postgres"",""typeVersion"":2.5,""position"":[2540,1080],""id"":""10d13cab-1948-4362-9384-960e1575abb3"",""name"":""Insert Table Rows"",""credentials"":{""postgres"":{""id"":""i83SgkPKmlQ785tT"",""name"":""Postgres account""}}},{""parameters"":{""operation"":""upsert"",""schema"":{""__rl"":true,""mode"":""list"",""value"":""public""},""table"":{""__rl"":true,""value"":""document_metadata"",""mode"":""list"",""cachedResultName"":""document_metadata""},""columns"":{""mappingMode"":""defineBelow"",""value"":{""id"":""={{ $('Set File ID').item.json.file_id }}"",""schema"":""={{ $json.schema }}""},""matchingColumns"":[""id""],""schema"":[{""id"":""id"",""displayName"":""id"",""required"":true,""defaultMatch"":true,""display"":true,""type"":""string"",""canBeUsedToMatch"":true,""removed"":false},{""id"":""title"",""displayName"":""title"",""required"":false,""defaultMatch"":false,""display"":true,""type"":""string"",""canBeUsedToMatch"":false,""removed"":true},{""id"":""url"",""displayName"":""url"",""required"":false,""defaultMatch"":false,""display"":true,""type"":""string"",""canBeUsedToMatch"":false,""removed"":true},{""id"":""created_at"",""displayName"":""created_at"",""required"":false,""defaultMatch"":false,""display"":true,""type"":""dateTime"",""canBeUsedToMatch"":false},{""id"":""schema"",""displayName"":""schema"",""required"":false,""defaultMatch"":false,""display"":true,""type"":""string"",""canBeUsedToMatch"":false,""removed"":false}],""attemptToConvertTypes"":false,""convertFieldsToString"":false},""options"":{}},""type"":""n8n-nodes-base.postgres"",""typeVersion"":2.5,""position"":[3400,840],""id"":""f03d7dde-0eac-470f-9ffa-ee90271c4738"",""name"":""Update Schema for Document Metadata"",""credentials"":{""postgres"":{""id"":""i83SgkPKmlQ785tT"",""name"":""Postgres account""}}},{""parameters"":{""content"":""## 🚀 n8n Local AI Agentic RAG Template\n\n**Author:** [Cole Medin](https://www.youtube.com/@ColeMedin)\n\n## What is this?\nThis template provides an entirely local implementation of an **Agentic RAG (Retrieval Augmented Generation)** system in n8n that can be extended easily for your specific use case and knowledge base. Unlike standard RAG which only performs simple lookups, this agent can reason about your knowledge base, self-improve retrieval, and dynamically switch between different tools based on the specific question. This workflow can be used with the [local AI package](https://github.com/coleam00/local-ai-packaged) for your LLMs (Ollama) and database (Supabase or \""vanilla\"" Postgres).\n\n## Why Agentic RAG?\nStandard RAG has significant limitations:\n- Poor analysis of numerical/tabular data\n- Missing context due to document chunking\n- Inability to connect information across documents\n- No dynamic tool selection based on question type\n\n## What makes this template powerful:\n- **Intelligent tool selection**: Switches between RAG lookups, SQL queries, or full document retrieval based on the question\n- **Complete document context**: Accesses entire documents when needed instead of just chunks\n- **Accurate numerical analysis**: Uses SQL for precise calculations on spreadsheet/tabular data\n- **Cross-document insights**: Connects information across your entire knowledge base\n- **Multi-file processing**: Handles multiple documents in a single workflow loop\n- **Efficient storage**: Uses JSONB in Supabase to store tabular data without creating new tables for each CSV\n\n## Getting Started\n1. Run the table creation nodes first to set up your database tables in Supabase\n2. Upload your documents to the folder on your computer that is mounted to /data/shared in the n8n container. This folder by default is the \""shared\"" folder in the local AI package.\n3. The agent will process them automatically (chunking text, storing tabular data in Supabase)\n4. Start asking questions that leverage the agent's multiple reasoning approaches\n\n## Customization\nThis template provides a solid foundation that you can extend by:\n- Tuning the system prompt for your specific use case\n- Adding document metadata like summaries\n- Implementing more advanced RAG techniques\n- Optimizing for larger knowledge bases\n\n---\n\nThe non-local (\""cloud\"") version of this Agentic RAG agent can be [found here](https://github.com/coleam00/ottomator-agents/tree/main/n8n-agentic-rag-agent)."",""height"":1320,""width"":540,""color"":6},""type"":""n8n-nodes-base.stickyNote"",""position"":[0,0],""typeVersion"":1,""id"":""6a58a6c3-24dd-4ecf-b23b-4cea1af0e600"",""name"":""Sticky Note9""},{""parameters"":{""triggerOn"":""folder"",""path"":""/data/shared"",""events"":[""add"",""change"",""unlink""],""options"":{""awaitWriteFinish"":true,""followSymlinks"":false,""ignoreInitial"":true,""usePolling"":false}},""type"":""n8n-nodes-base.localFileTrigger"",""typeVersion"":1,""position"":[560,760],""id"":""478b422f-378a-4aa7-b94b-ffe2e738bd92"",""name"":""Local File Trigger""},{""parameters"":{""fileSelector"":""={{ $('Set File ID').item.json.file_id }}"",""options"":{""dataPropertyName"":""=data""}},""type"":""n8n-nodes-base.readWriteFile"",""typeVersion"":1,""position"":[1640,960],""id"":""d2f63497-929d-4f05-b52a-2e58e91a85ed"",""name"":""Read/Write Files from Disk""},{""parameters"":{""model"":""nomic-embed-text:latest""},""type"":""@n8n/n8n-nodes-langchain.embeddingsOllama"",""typeVersion"":1,""position"":[3160,1280],""id"":""51eca60d-06a7-4630-a4f5-73bb426ef86e"",""name"":""Embeddings Ollama"",""credentials"":{""ollamaApi"":{""id"":""C0BctVXe93bO063x"",""name"":""Ollama account""}}},{""parameters"":{""model"":""nomic-embed-text:latest""},""type"":""@n8n/n8n-nodes-langchain.embeddingsOllama"",""typeVersion"":1,""position"":[2560,480],""id"":""6820bd0e-980d-4d81-bfa2-a0ce4487a49c"",""name"":""Embeddings Ollama1"",""credentials"":{""ollamaApi"":{""id"":""C0BctVXe93bO063x"",""name"":""Ollama account""}}},{""parameters"":{""chunkSize"":10000,""chunkOverlap"":null,""options"":{}},""type"":""@n8n/n8n-nodes-langchain.textSplitterRecursiveCharacterTextSplitter"",""typeVersion"":1,""position"":[3380,1400],""id"":""f175f0e4-cb6a-4bb9-84fd-1233c12d092c"",""name"":""Recursive Character Text Splitter""},{""parameters"":{""model"":{""__rl"":true,""value"":""qwen2.5:14b-12k"",""mode"":""list"",""cachedResultName"":""qwen2.5:14b-12k""},""options"":{}},""type"":""@n8n/n8n-nodes-langchain.lmChatOpenAi"",""typeVersion"":1.2,""position"":[1560,500],""id"":""db62e842-81c5-4cfc-8f30-50d2a970749a"",""name"":""Ollama (Change Base URL)"",""credentials"":{""openAiApi"":{""id"":""tRHsMPxbW4YJD93X"",""name"":""Ollama OpenAI""}}},{""parameters"":{""content"":""## NOTE\n\nThe Ollama chat model node doesn't work with the RAG nodes - known issue with n8n.\n\nSo for now, we are using the OpenAI chat model but changing the base URL to Ollama when creating the credentials (i.e. http://ollama:11434/v1). The API key can be set to whatever, it isn't used for local LLMs."",""height"":200,""width"":540,""color"":6},""type"":""n8n-nodes-base.stickyNote"",""position"":[0,1340],""typeVersion"":1,""id"":""9f06b041-993f-4c6d-9232-ba0ac5188812"",""name"":""Sticky Note4""},{""parameters"":{""operation"":""executeQuery"",""query"":""DO $$\nBEGIN\n    IF EXISTS (SELECT 1 FROM information_schema.tables WHERE table_name = 'documents_pg') THEN\n        EXECUTE 'DELETE FROM documents_pg WHERE metadata->>''file_id'' LIKE ''%' || $1 || '%''';\n    END IF;\nEND\n$$;"",""options"":{""queryReplacement"":""={{ $json.file_id }}""}},""type"":""n8n-nodes-base.postgres"",""typeVersion"":2.5,""position"":[1160,820],""id"":""2527096d-b62d-4f58-9e98-6de29f06d070"",""name"":""Delete Old Doc Records"",""credentials"":{""postgres"":{""id"":""i83SgkPKmlQ785tT"",""name"":""Postgres account""}}},{""parameters"":{""operation"":""executeQuery"",""query"":""DELETE FROM document_rows\nWHERE dataset_id LIKE '%' || $1 || '%';"",""options"":{""queryReplacement"":""={{ $('Set File ID').item.json.file_id }}""}},""type"":""n8n-nodes-base.postgres"",""typeVersion"":2.5,""position"":[1320,960],""id"":""0039ebde-45fa-4516-82bb-5202ed752f29"",""name"":""Delete Old Data Records"",""credentials"":{""postgres"":{""id"":""i83SgkPKmlQ785tT"",""name"":""Postgres account""}}},{""parameters"":{""mode"":""insert"",""tableName"":""documents_pg"",""options"":{}},""type"":""@n8n/n8n-nodes-langchain.vectorStorePGVector"",""typeVersion"":1,""position"":[3180,1060],""id"":""b5d93143-bf98-47ee-8ee0-84b230476688"",""name"":""Postgres PGVector Store"",""credentials"":{""postgres"":{""id"":""i83SgkPKmlQ785tT"",""name"":""Postgres account""}}},{""parameters"":{""mode"":""retrieve-as-tool"",""toolName"":""documents"",""toolDescription"":""Use RAG to look up information in the knowledgebase."",""tableName"":""documents_pg"",""options"":{}},""type"":""@n8n/n8n-nodes-langchain.vectorStorePGVector"",""typeVersion"":1,""position"":[2460,280],""id"":""c17143c1-3eb1-4917-9b7d-445e84c63de8"",""name"":""Postgres PGVector Store1"",""credentials"":{""postgres"":{""id"":""i83SgkPKmlQ785tT"",""name"":""Postgres account""}}},{""parameters"":{""conditions"":{""options"":{""caseSensitive"":true,""leftValue"":"""",""typeValidation"":""strict"",""version"":2},""conditions"":[{""id"":""edd8d1dd-ea1f-451f-8d6c-7633fbd8297f"",""leftValue"":""={{ $json.path }}"",""rightValue"":""/data/shared/.DS_Store"",""operator"":{""type"":""string"",""operation"":""notEquals""}}],""combinator"":""and""},""options"":{""ignoreCase"":false}},""type"":""n8n-nodes-base.filter"",""typeVersion"":2.2,""position"":[720,760],""id"":""90e62210-002d-4eee-8b4f-e3afdef2fb37"",""name"":""Filter""},{""parameters"":{""promptType"":""define"",""text"":""=Task: Translate the Query to English, if applicable. Try to be as literate as possible. If you do not know or understand a word, use it as it is.\n\nQuery:\n{{ $json?.chatInput || $json.body.chatInput }}"",""messages"":{""messageValues"":[{""message"":""You are a translator. Output your translation in plain english.""}]}},""type"":""@n8n/n8n-nodes-langchain.chainLlm"",""typeVersion"":1.5,""position"":[1280,-360],""id"":""1621268b-0901-4bac-ae34-86b425b7c8b1"",""name"":""Basic LLM Chain""},{""parameters"":{""model"":""hf.co/unsloth/gemma-3-12b-it-GGUF:Q4_K_M"",""options"":{}},""type"":""@n8n/n8n-nodes-langchain.lmChatOllama"",""typeVersion"":1,""position"":[1440,-240],""id"":""97dcb454-98a9-494d-95ee-c4f8b2c03c71"",""name"":""Ollama Chat Model"",""credentials"":{""ollamaApi"":{""id"":""C0BctVXe93bO063x"",""name"":""Ollama account""}}},{""parameters"":{""content"":""## I/O Operations \nInput from Open WebUI or direct text message"",""height"":520,""width"":2240,""color"":7},""type"":""n8n-nodes-base.stickyNote"",""typeVersion"":1,""position"":[940,-400],""id"":""18d256f2-d919-41f6-b339-13e64a94226c"",""name"":""Sticky Note10""},{""parameters"":{""promptType"":""define"",""text"":""=You are a translation assistant.\n\n1. The user’s query is in the following language:\n{{ $json.text }}\n\n2. The text to translate is:\n{{ $json.output }}\n\n3. Your task:\n  - If the text is already in the user's language, forward the text without a translation.\n  - If a specific or non-native term (jargon) has no direct translation or you are unsure how to translate it, leave it in the original language.\n  - Preserve the original structure, formatting, and style of the text. Do not add or remove sections.\n  - Provide only the translated text, with no extra explanation or commentary.""},""type"":""@n8n/n8n-nodes-langchain.chainLlm"",""typeVersion"":1.5,""position"":[2280,-100],""id"":""a2bdeb30-4b73-4e0d-a7ec-e2b21d323e30"",""name"":""Basic LLM Chain1""},{""parameters"":{""model"":""llama3.2:latest"",""options"":{""numCtx"":4096}},""type"":""@n8n/n8n-nodes-langchain.lmOllama"",""typeVersion"":1,""position"":[2440,20],""id"":""4390344f-8204-4f1f-b286-24c0de932be1"",""name"":""Ollama Model"",""credentials"":{""ollamaApi"":{""id"":""C0BctVXe93bO063x"",""name"":""Ollama account""}}},{""parameters"":{""model"":""llama3.2:latest"",""options"":{}},""type"":""@n8n/n8n-nodes-langchain.lmOllama"",""typeVersion"":1,""position"":[1440,0],""id"":""20679206-d193-47a2-b062-fa4ccda48717"",""name"":""Ollama Model1"",""credentials"":{""ollamaApi"":{""id"":""C0BctVXe93bO063x"",""name"":""Ollama account""}}},{""parameters"":{""promptType"":""define"",""text"":""=Task: Determine the language of the following text.\n\n{{ $json?.chatInput || $json.body.chatInput }}\n\nProvide only the name of the language in English with no additional commentary or explanation."",""messages"":{""messageValues"":[{""message"":""You are a language detection assistant""}]}},""type"":""@n8n/n8n-nodes-langchain.chainLlm"",""typeVersion"":1.5,""position"":[1280,-120],""id"":""2feef32f-ca9f-43a8-ade4-cd5b26ee1d18"",""name"":""Basic LLM Chain2""},{""parameters"":{""mode"":""combine"",""combineBy"":""combineByPosition"",""options"":{}},""type"":""n8n-nodes-base.merge"",""typeVersion"":3,""position"":[2140,-100],""id"":""b9bdb154-bc71-47fc-8a8b-aa04e6b02842"",""name"":""Merge""},{""parameters"":{""assignments"":{""assignments"":[{""id"":""fb165c82-ee5f-4cdd-badc-60e853ea5ff5"",""name"":""output"",""value"":""={{ $json.text }}"",""type"":""string""}]},""options"":{}},""type"":""n8n-nodes-base.set"",""typeVersion"":3.4,""position"":[2580,-100],""id"":""d0af7491-b297-480f-bbd2-aa1ee9ddbd6f"",""name"":""to_output""},{""parameters"":{""public"":true,""options"":{}},""id"":""11eab80d-91e3-44ce-ae5a-83e19bbcd919"",""name"":""message_received"",""type"":""@n8n/n8n-nodes-langchain.chatTrigger"",""typeVersion"":1.1,""position"":[1000,-300],""webhookId"":""e104e40e-6134-4825-a6f0-8a646d882662""},{""parameters"":{""httpMethod"":""POST"",""path"":""bf4dd093-bb02-472c-9454-7ab9af97bd1d"",""authentication"":""basicAuth"",""responseMode"":""responseNode"",""options"":{}},""type"":""n8n-nodes-base.webhook"",""typeVersion"":2,""position"":[1000,-120],""id"":""1b500584-a956-4ff0-92ed-0d8ac85180c5"",""name"":""message_webhook"",""webhookId"":""b3e7d885-0c39-4425-a239-ae065759dbb5"",""credentials"":{""httpBasicAuth"":{""id"":""LRDSxubbcczOIOAy"",""name"":""Unnamed credential""}}},{""parameters"":{""jsCode"":""// Helper function to safely get node data\nconst getNodeData = (nodeName) => {\n\ttry {\n\t\treturn eval(`$('${nodeName}').first()`);\n\t} catch (e) {\n\t\treturn null;\n\t}\n};\n\nconst output = [];\n\n// Get the input text for the chat\nconst chatInput = $input.first().json.text;\n\n// Default to the webhook id, since it is almost always present\nlet sessionId = null;\nconst webhookData = getNodeData(\""message_webhook\"");\nif (webhookData && webhookData.json && webhookData.json.body && webhookData.json.body.chat_id) {\n\tsessionId = webhookData.json.body.chat_id;\n}\n\n// Optionally override with the message_received sessionId, if available\nconst messageData = getNodeData(\""message_received\"");\nif (messageData && messageData.json && messageData.json.sessionId) {\n\tsessionId = messageData.json.sessionId;\n}\n\n// Return an array of objects with both the chat input and the session id\noutput.push({ json: { chatInput, sessionId } });\nreturn output;""},""type"":""n8n-nodes-base.code"",""typeVersion"":2,""position"":[1600,-360],""id"":""3d5881c5-59bd-4486-a57a-67090f328c4b"",""name"":""Code""},{""parameters"":{""options"":{}},""id"":""05854887-e11f-4904-9bb7-9f7208035532"",""name"":""response_webhook"",""type"":""n8n-nodes-base.respondToWebhook"",""typeVersion"":1.1,""position"":[2720,-100]},{""parameters"":{""text"":""={{ $json.path.split(/[\\\\/]/).pop().split('.').slice(0, -1).join('.'); }}"",""attributes"":{""attributes"":[{""name"":""namespace"",""description"":""The category this document belongs to - 'Textbook' or 'Paper' or 'Guideline' or 'Summary of Product Characteristics'""}]},""options"":{""systemPromptTemplate"":""=You are an expert extraction algorithm.\nOnly extract relevant information from the text.\nIf you do not know the value of an attribute asked to extract, you may omit the attribute's value.\n\nDetermine the document category based on its title, it could either be 'Textbook' or 'Paper' or 'Guideline' or 'Summary of Product Characteristics'""}},""type"":""@n8n/n8n-nodes-langchain.informationExtractor"",""typeVersion"":1,""position"":[620,1020],""id"":""4982eb0f-f95d-440a-bbcd-cd389b14e7ed"",""name"":""CR Namespace Classifier1""},{""parameters"":{""model"":""hf.co/unsloth/gemma-3-4b-it-GGUF:Q4_K_M"",""options"":{""numCtx"":2048}},""type"":""@n8n/n8n-nodes-langchain.lmOllama"",""typeVersion"":1,""position"":[620,1160],""id"":""10ba9382-c81f-4f45-ab11-d719daf69e3e"",""name"":""Ollama Model2"",""credentials"":{""ollamaApi"":{""id"":""C0BctVXe93bO063x"",""name"":""Ollama account""}}},{""parameters"":{""mode"":""raw"",""jsonOutput"":""={\n  \""data\"": {{ JSON.stringify($json.text) }}\n}\n"",""options"":{}},""type"":""n8n-nodes-base.set"",""typeVersion"":3.4,""position"":[1800,1640],""id"":""caad293f-9ea1-4cfd-8555-d7f2475dc058"",""name"":""Document Data""},{""parameters"":{""fieldToSplitOut"":""chunks"",""options"":{""destinationFieldName"":""chunk_large""}},""type"":""n8n-nodes-base.splitOut"",""typeVersion"":1,""position"":[2060,1640],""id"":""d45ac5b3-4788-4ea4-bd56-52228d489881"",""name"":""Split Chunks""},{""parameters"":{""model"":""hf.co/unsloth/gemma-3-4b-it-GGUF:Q4_K_M"",""options"":{""numCtx"":6144}},""type"":""@n8n/n8n-nodes-langchain.lmOllama"",""typeVersion"":1,""position"":[2740,1760],""id"":""1e1fe685-005f-4ba9-8f30-71b337b1531d"",""name"":""Ollama Model3"",""credentials"":{""ollamaApi"":{""id"":""C0BctVXe93bO063x"",""name"":""Ollama account""}}},{""parameters"":{""fieldToSplitOut"":""chunks"",""options"":{""destinationFieldName"":""chunk_small""}},""type"":""n8n-nodes-base.splitOut"",""typeVersion"":1,""position"":[2300,1640],""id"":""96246ff4-b377-419c-8d42-4aa794bffc80"",""name"":""Split Chunks2""},{""parameters"":{""mode"":""runOnceForEachItem"",""jsCode"":""const chunkSize = 15000;\nconst chunkOverlap = 1000;\nconst text = $input.item.json.data.replace(/\\n/, '');\n\nconst chunks = [];\nlet remainingText = text;\n\nwhile (remainingText.length > 0) {\n    let splitPoint;\n\n    // Try splitting at paragraph level first\n    splitPoint = remainingText.lastIndexOf(\""\\n\\n\"", chunkSize);\n    \n    // If no paragraph split, try splitting at sentence level\n    if (splitPoint === -1) {\n        splitPoint = remainingText.lastIndexOf(\"". \"", chunkSize);\n    }\n\n    // If no sentence split, try splitting at word level\n    if (splitPoint === -1) {\n        splitPoint = remainingText.lastIndexOf(\"" \"", chunkSize);\n    }\n\n    // If still no split point, force cut at chunkSize\n    if (splitPoint === -1 || splitPoint < chunkSize * 0.5) {  \n        splitPoint = chunkSize; // Hard split if no good split point\n    }\n\n    // Extract chunk and adjust remaining text with overlap\n    let chunk = remainingText.substring(0, splitPoint).trim();\n    chunks.push(chunk);\n\n    // Move the pointer forward while keeping the overlap\n    remainingText = remainingText.substring(Math.max(0, splitPoint - chunkOverlap)).trim();\n\n    // Break if remaining text is too small to form another chunk\n    if (remainingText.length < chunkSize * 0.2) {\n        chunks.push(remainingText);\n        break;\n    }\n}\n\nreturn { chunks };""},""type"":""n8n-nodes-base.code"",""typeVersion"":2,""position"":[1940,1640],""id"":""2fc16fb7-07aa-4e6c-848b-63601abeb6a3"",""name"":""Recursive Splitter Large""},{""parameters"":{""mode"":""runOnceForEachItem"",""jsCode"":""const chunkSize = 3250;\nconst chunkOverlap = 1000;\n\n// Get the text from the previous node.\nlet text = $('Split Chunks').item.json.chunk_large;\n\n// Ensure text is a string. If it's an array, join its items.\nif (Array.isArray(text)) {\n    text = text.join(\"" \"");\n} else if (typeof text !== 'string') {\n    text = String(text);\n}\n\n// Replace single newlines with spaces but keep double newlines intact for paragraph splits.\ntext = text.replace(/\\n\\n/g, '<<<PARA>>>')  // Temporarily mark paragraphs\n           .replace(/\\n/g, ' ')             // Replace remaining single newlines with spaces\n           .replace(/<<<PARA>>>/g, '\\n\\n');  // Restore paragraph breaks\n\nconst chunks = [];\nlet remainingText = text;\n\nwhile (remainingText.length > 0) {\n    let splitPoint;\n    \n    // Try splitting at paragraph level first\n    splitPoint = remainingText.lastIndexOf(\""\\n\\n\"", chunkSize);\n    \n    // If no paragraph break is found, try splitting at sentence level\n    if (splitPoint === -1) {\n        splitPoint = remainingText.lastIndexOf(\"". \"", chunkSize);\n    }\n    \n    // If no sentence boundary is found, try splitting at word level\n    if (splitPoint === -1) {\n        splitPoint = remainingText.lastIndexOf(\"" \"", chunkSize);\n    }\n    \n    // If still no split point or the split is too early, force a hard split at chunkSize\n    if (splitPoint === -1 || splitPoint < chunkSize * 0.5) {  \n        splitPoint = chunkSize;\n    }\n    \n    // Extract the chunk and add it to the array (trim to remove extra whitespace)\n    const chunk = remainingText.substring(0, splitPoint).trim();\n    chunks.push(chunk);\n    \n    // Advance the pointer while keeping an overlap for context\n    remainingText = remainingText.substring(Math.max(0, splitPoint - chunkOverlap)).trim();\n    \n    // If the remaining text is too short, add it as the final chunk (if not empty) and exit the loop\n    if (remainingText.length < chunkSize * 0.2) {\n        if (remainingText.length > 0) {\n            chunks.push(remainingText);\n        }\n        break;\n    }\n}\n\nreturn { chunks };""},""type"":""n8n-nodes-base.code"",""typeVersion"":2,""position"":[2180,1640],""id"":""7e3a4c02-84a4-4f03-a8b9-a5b1b038b472"",""name"":""Recursive Splitter Small""},{""parameters"":{""promptType"":""define"",""text"":""=<document> \n{{ $('Split Chunks').item.json.chunk_large }}\n</document>\n\nHere is the chunk we want to situate within the whole document \n<chunk> \n{{ $json.chunk_small }}\n</chunk>\n\nPlease give a short succinct context to situate this chunk within the overall document for the purposes of improving search retrieval of the chunk. Answer only with the succinct context and nothing else. Do not decorate your answer or explain your reasoning.""},""type"":""@n8n/n8n-nodes-langchain.chainLlm"",""typeVersion"":1.5,""position"":[2580,1640],""id"":""5550b35c-64bb-4ea1-a7be-bc3c9b004ddd"",""name"":""Basic LLM Chain4""},{""parameters"":{""assignments"":{""assignments"":[{""id"":""e5fb0381-5d23-46e2-a0d1-438240b80a3e"",""name"":""=section_chunk"",""type"":""string"",""value"":""=<summary>\n{{ $json.text }}\n</summary>\n<text>\n{{ $('Loop Over Items1').item.json.chunk_small }} \n</text>""}]},""options"":{}},""id"":""97d03263-601a-4ad4-85bb-1ff338435651"",""name"":""Concatenate the context and section text"",""type"":""n8n-nodes-base.set"",""position"":[2860,1640],""typeVersion"":3.4},{""parameters"":{""options"":{}},""id"":""ef130734-a2e5-4ed4-ac57-74182a0641da"",""name"":""Loop Over Items1"",""type"":""n8n-nodes-base.splitInBatches"",""position"":[2440,1640],""typeVersion"":3}]","{""Extract Document Text"":{""main"":[[{""node"":""Document Data"",""type"":""main"",""index"":0}]]},""Default Data Loader"":{""ai_document"":[[{""node"":""Postgres PGVector Store"",""type"":""ai_document"",""index"":0}]]},""Postgres Chat Memory"":{""ai_memory"":[[{""node"":""RAG AI Agent"",""type"":""ai_memory"",""index"":0}]]},""Set File ID"":{""main"":[[{""node"":""Delete Old Doc Records"",""type"":""main"",""index"":0}]]},""Extract PDF Text"":{""main"":[[{""node"":""Document Data"",""type"":""main"",""index"":0}]]},""Aggregate"":{""main"":[[{""node"":""Summarize"",""type"":""main"",""index"":0}]]},""Summarize"":{""main"":[[{""node"":""Set Schema"",""type"":""main"",""index"":0},{""node"":""Postgres PGVector Store"",""type"":""main"",""index"":0}]]},""RAG AI Agent"":{""main"":[[{""node"":""Merge"",""type"":""main"",""index"":1}]]},""Switch"":{""main"":[[{""node"":""Extract PDF Text"",""type"":""main"",""index"":0}],[{""node"":""Extract from Excel"",""type"":""main"",""index"":0}],[{""node"":""Extract from CSV"",""type"":""main"",""index"":0}],[{""node"":""Extract Document Text"",""type"":""main"",""index"":0}]]},""Extract from Excel"":{""main"":[[{""node"":""Aggregate"",""type"":""main"",""index"":0},{""node"":""Insert Table Rows"",""type"":""main"",""index"":0}]]},""Set Schema"":{""main"":[[{""node"":""Update Schema for Document Metadata"",""type"":""main"",""index"":0}]]},""Extract from CSV"":{""main"":[[{""node"":""Aggregate"",""type"":""main"",""index"":0},{""node"":""Insert Table Rows"",""type"":""main"",""index"":0}]]},""List Documents"":{""ai_tool"":[[{""node"":""RAG AI Agent"",""type"":""ai_tool"",""index"":0}]]},""Get File Contents"":{""ai_tool"":[[{""node"":""RAG AI Agent"",""type"":""ai_tool"",""index"":0}]]},""Query Document Rows"":{""ai_tool"":[[{""node"":""RAG AI Agent"",""type"":""ai_tool"",""index"":0}]]},""Loop Over Items"":{""main"":[[],[{""node"":""CR Namespace Classifier1"",""type"":""main"",""index"":0}]]},""Insert Document Metadata"":{""main"":[[{""node"":""Read/Write Files from Disk"",""type"":""main"",""index"":0}]]},""Local File Trigger"":{""main"":[[{""node"":""Filter"",""type"":""main"",""index"":0}]]},""Read/Write Files from Disk"":{""main"":[[{""node"":""Switch"",""type"":""main"",""index"":0}]]},""Embeddings Ollama"":{""ai_embedding"":[[{""node"":""Postgres PGVector Store"",""type"":""ai_embedding"",""index"":0}]]},""Embeddings Ollama1"":{""ai_embedding"":[[{""node"":""Postgres PGVector Store1"",""type"":""ai_embedding"",""index"":0}]]},""Recursive Character Text Splitter"":{""ai_textSplitter"":[[{""node"":""Default Data Loader"",""type"":""ai_textSplitter"",""index"":0}]]},""Ollama (Change Base URL)"":{""ai_languageModel"":[[{""node"":""RAG AI Agent"",""type"":""ai_languageModel"",""index"":0}]]},""Delete Old Doc Records"":{""main"":[[{""node"":""Delete Old Data Records"",""type"":""main"",""index"":0}]]},""Delete Old Data Records"":{""main"":[[{""node"":""Insert Document Metadata"",""type"":""main"",""index"":0}]]},""Postgres PGVector Store"":{""main"":[[{""node"":""Loop Over Items"",""type"":""main"",""index"":0},{""node"":""Loop Over Items1"",""type"":""main"",""index"":0}]]},""Postgres PGVector Store1"":{""ai_tool"":[[{""node"":""RAG AI Agent"",""type"":""ai_tool"",""index"":0}]]},""Filter"":{""main"":[[{""node"":""Loop Over Items"",""type"":""main"",""index"":0}]]},""Ollama Chat Model"":{""ai_languageModel"":[[{""node"":""Basic LLM Chain"",""type"":""ai_languageModel"",""index"":0}]]},""Basic LLM Chain"":{""main"":[[{""node"":""Code"",""type"":""main"",""index"":0}]]},""Ollama Model"":{""ai_languageModel"":[[{""node"":""Basic LLM Chain1"",""type"":""ai_languageModel"",""index"":0}]]},""Basic LLM Chain1"":{""main"":[[{""node"":""to_output"",""type"":""main"",""index"":0}]]},""Ollama Model1"":{""ai_languageModel"":[[{""node"":""Basic LLM Chain2"",""type"":""ai_languageModel"",""index"":0}]]},""Basic LLM Chain2"":{""main"":[[{""node"":""Merge"",""type"":""main"",""index"":0}]]},""Merge"":{""main"":[[{""node"":""Basic LLM Chain1"",""type"":""main"",""index"":0}]]},""to_output"":{""main"":[[{""node"":""response_webhook"",""type"":""main"",""index"":0}]]},""message_received"":{""main"":[[{""node"":""Basic LLM Chain"",""type"":""main"",""index"":0},{""node"":""Basic LLM Chain2"",""type"":""main"",""index"":0}]]},""message_webhook"":{""main"":[[{""node"":""Basic LLM Chain"",""type"":""main"",""index"":0},{""node"":""Basic LLM Chain2"",""type"":""main"",""index"":0}]]},""Code"":{""main"":[[{""node"":""RAG AI Agent"",""type"":""main"",""index"":0}]]},""Ollama Model2"":{""ai_languageModel"":[[{""node"":""CR Namespace Classifier1"",""type"":""ai_languageModel"",""index"":0}]]},""CR Namespace Classifier1"":{""main"":[[{""node"":""Set File ID"",""type"":""main"",""index"":0}]]},""Document Data"":{""main"":[[{""node"":""Recursive Splitter Large"",""type"":""main"",""index"":0}]]},""Split Chunks"":{""main"":[[{""node"":""Recursive Splitter Small"",""type"":""main"",""index"":0}]]},""Ollama Model3"":{""ai_languageModel"":[[{""node"":""Basic LLM Chain4"",""type"":""ai_languageModel"",""index"":0}]]},""Split Chunks2"":{""main"":[[{""node"":""Loop Over Items1"",""type"":""main"",""index"":0}]]},""Recursive Splitter Large"":{""main"":[[{""node"":""Split Chunks"",""type"":""main"",""index"":0}]]},""Recursive Splitter Small"":{""main"":[[{""node"":""Split Chunks2"",""type"":""main"",""index"":0}]]},""Basic LLM Chain4"":{""main"":[[{""node"":""Concatenate the context and section text"",""type"":""main"",""index"":0}]]},""Concatenate the context and section text"":{""main"":[[{""node"":""Postgres PGVector Store"",""type"":""main"",""index"":0}]]},""Loop Over Items1"":{""main"":[[],[{""node"":""Basic LLM Chain4"",""type"":""main"",""index"":0}]]}}",2025-03-22 12:12:24.92+00,2025-03-27 11:10:12.767+00,"{""executionOrder"":""v1""}",,{},41e823b6-5ffb-407d-bb8c-723fc5ddac4e,4,LKyO0wz9z29U0AOp,"{""templateCredsSetupCompleted"":true}",
Med_Disc_Lett_W_V1,f,"[{""parameters"":{""content"":""# PROMPT-CHAINING\nPrompt chaining decomposes a task into a sequence of steps, where each LLM call processes the output of the previous one.\n\n![Image Description](https://www.anthropic.com/_next/image?url=https%3A%2F%2Fwww-cdn.anthropic.com%2Fimages%2F4zrzovbb%2Fwebsite%2F7418719e3dab222dccb379b8879e1dc08ad34c78-2401x1000.png&w=3840&q=75)\n## When to use this workflow: \nThis workflow is ideal for situations where the task can be easily and cleanly decomposed into fixed subtasks. The main goal is to trade off latency for higher accuracy, by making each LLM call an easier task.\n\nBenefits\n- Breaking down the work into simpler chunks, making it easier for each of the LLM to work on.\n- Allows for more flexibility, being able to use different model in each stage of a task.\n- Easier to debug, as the process is divided into simpler parts."",""height"":660,""width"":740,""color"":7},""type"":""n8n-nodes-base.stickyNote"",""typeVersion"":1,""position"":[-500,-240],""id"":""78fc0ec1-3834-4e02-abac-083bf8320ea9"",""name"":""Sticky Note""},{""parameters"":{""content"":""# ROUTING\nRouting classifies an input and directs it to a specialized followup task. This workflow allows for separation of concerns, and building more specialized prompts. Without this workflow, optimizing for one kind of input can hurt performance on other inputs.\n\n![Image Description](https://www.anthropic.com/_next/image?url=https%3A%2F%2Fwww-cdn.anthropic.com%2Fimages%2F4zrzovbb%2Fwebsite%2F5c0c0e9fe4def0b584c04d37849941da55e5e71c-2401x1000.png&w=3840&q=75)\n## When to use this workflow: \nRouting works well for complex tasks where there are distinct categories that are better handled separately, and where classification can be handled accurately, either by an LLM or a more traditional classification model/algorithm."",""height"":580,""width"":740,""color"":7},""type"":""n8n-nodes-base.stickyNote"",""typeVersion"":1,""position"":[-500,480],""id"":""a8e5bc3a-9409-46ad-b608-7189ed5b0c35"",""name"":""Sticky Note1""},{""parameters"":{""content"":""# Parallelization\nLLMs can sometimes work simultaneously on a task and have their outputs aggregated programmatically. This workflow, parallelization, manifests in two key variations:\n## Sectioning: \nBreaking a task into independent subtasks that run in parallel.\n## Voting: \nRunning the same task multiple times to get diverse outputs.\n![Image Description](https://www.anthropic.com/_next/image?url=https%3A%2F%2Fwww-cdn.anthropic.com%2Fimages%2F4zrzovbb%2Fwebsite%2F406bb032ca007fd1624f261af717d70e6ca86286-2401x1000.png&w=3840&q=75)\n## When to use this workflow: \nParallelization is effective when the divided subtasks can be parallelized for speed, or when multiple perspectives or attempts are needed for higher confidence results. For complex tasks with multiple considerations, LLMs generally perform better when each consideration is handled by a separate LLM call, allowing focused attention on each specific aspect."",""height"":700,""width"":740,""color"":7},""type"":""n8n-nodes-base.stickyNote"",""typeVersion"":1,""position"":[-500,1140],""id"":""5946b8af-8e15-4b9a-a06d-e3f9c4b06372"",""name"":""Sticky Note2""},{""parameters"":{""content"":""# Orchestrator-workers\nIn the orchestrator-workers workflow, a central LLM dynamically breaks down tasks, delegates them to worker LLMs, and synthesizes their results.\n![Image Description](https://www.anthropic.com/_next/image?url=https%3A%2F%2Fwww-cdn.anthropic.com%2Fimages%2F4zrzovbb%2Fwebsite%2F8985fc683fae4780fb34eab1365ab78c7e51bc8e-2401x1000.png&w=3840&q=75)\n## When to use this workflow: \nThis workflow is well-suited for complex tasks where you can’t predict the subtasks needed (in coding, for example, the number of files that need to be changed and the nature of the change in each file likely depend on the task). Whereas it’s topographically similar, the key difference from parallelization is its flexibility—subtasks aren't pre-defined, but determined by the orchestrator based on the specific input."",""height"":560,""width"":740,""color"":7},""type"":""n8n-nodes-base.stickyNote"",""typeVersion"":1,""position"":[-500,1900],""id"":""aaf569ed-b582-466a-8ef1-11273bf52f7d"",""name"":""Sticky Note3""},{""parameters"":{""content"":""# Evaluator-optimizer\nIn the evaluator-optimizer workflow, one LLM call generates a response while another provides evaluation and feedback in a loop.\n![Image Description](https://www.anthropic.com/_next/image?url=https%3A%2F%2Fwww-cdn.anthropic.com%2Fimages%2F4zrzovbb%2Fwebsite%2F14f51e6406ccb29e695da48b17017e899a6119c7-2401x1000.png&w=3840&q=75)\n## When to use this workflow: \nThis workflow is particularly effective when we have clear evaluation criteria, and when iterative refinement provides measurable value. The two signs of good fit are, first, that LLM responses can be demonstrably improved when a human articulates their feedback; and second, that the LLM can provide such feedback. This is analogous to the iterative writing process a human writer might go through when producing a polished document.\n\n"",""height"":600,""width"":740,""color"":7},""type"":""n8n-nodes-base.stickyNote"",""typeVersion"":1,""position"":[-500,2520],""id"":""d60c8346-f9c3-4104-a0e8-cb76f7eaed11"",""name"":""Sticky Note4""},{""parameters"":{""content"":""# Agents\nAgents rely on LLMs’ abilities to understand complex inputs, reason and plan, use tools reliably, and recover from errors. They typically start with either a direct command or an interactive conversation with the user. Once the task is clear, agents plan and operate on their own, but can return to the user for additional information or judgment. During execution, it’s important for them to gather real-time feedback (such as tool results or code execution outputs) to monitor progress. They may pause for human input at checkpoints or when facing obstacles. Tasks usually end upon completion, though stopping conditions (like a maximum number of iterations) are often set for control.\n\nEven though agents can manage complex tasks, their implementation is generally straightforward. They are essentially LLMs that loop through tool usage based on feedback from the environment. As a result, it’s crucial to design both the tools and their documentation with care.\n![Image Description](https://www.anthropic.com/_next/image?url=https%3A%2F%2Fwww-cdn.anthropic.com%2Fimages%2F4zrzovbb%2Fwebsite%2F58d9f10c985c4eb5d53798dea315f7bb5ab6249e-2401x1000.png&w=3840&q=75)\n## When to use this workflow: \nAgents can be used for open-ended problems where it’s difficult or impossible to predict the required number of steps, and where you can’t hardcode a fixed path. The LLM will potentially operate for many turns, and you must have some level of trust in its decision-making. Agents' autonomy makes them ideal for scaling tasks in trusted environments.\n\nThe autonomous nature of agents means higher costs, and the potential for compounding errors. We recommend extensive testing in sandboxed environments, along with the appropriate guardrails.\n\n"",""height"":820,""width"":740,""color"":7},""type"":""n8n-nodes-base.stickyNote"",""typeVersion"":1,""position"":[-500,3180],""id"":""133eeba0-a42a-4c41-881e-da25ae530854"",""name"":""Sticky Note5""},{""parameters"":{""modelName"":""models/gemini-2.0-flash-thinking-exp"",""options"":{}},""type"":""@n8n/n8n-nodes-langchain.lmChatGoogleGemini"",""typeVersion"":1,""position"":[620,160],""id"":""9e1328d8-9b3c-41a2-840e-8a3c2e0dd6af"",""name"":""2.0 Flash Thinking""},{""parameters"":{""promptType"":""define"",""text"":""=Write a detailed report in html for the following topic: \""{{ $('Prompt Chaining').item.json.topic }}}\""\n\nfollowing this outline:\n{{ $json.output }}\n\n"",""options"":{}},""type"":""@n8n/n8n-nodes-langchain.agent"",""typeVersion"":1.7,""position"":[1180,-20],""id"":""27e344fc-a600-4ffa-83c4-eee05a0f4009"",""name"":""Report Generator""},{""parameters"":{""model"":{""__rl"":true,""value"":""o3-mini"",""mode"":""list"",""cachedResultName"":""o3-mini""},""options"":{}},""type"":""@n8n/n8n-nodes-langchain.lmChatOpenAi"",""typeVersion"":1.2,""position"":[920,180],""id"":""e88986aa-0d58-4afe-8f64-3193fa03b89f"",""name"":""O3-MINI""},{""parameters"":{""options"":{}},""type"":""@n8n/n8n-nodes-langchain.lmChatAnthropic"",""typeVersion"":1.2,""position"":[1180,180],""id"":""6669105e-7af4-491d-b058-a195a65cf615"",""name"":""Claude 3.5 Sonnet""},{""parameters"":{""inputText"":""=Your objective is to clearly understand what kind of content the user expects based on their request: {{ $json.chatInput }}"",""categories"":{""categories"":[{""category"":""Poem"",""description"":""User is asking for a poem on a topic""},{""category"":""Joke"",""description"":""User is asking for a joke on a topic""},{""category"":""Story"",""description"":""User is asking for a story on a topic""},{""category"":""Not Clear"",""description"":""If it is not clear what kind of content the user wants.""}]},""options"":{}},""type"":""@n8n/n8n-nodes-langchain.textClassifier"",""typeVersion"":1,""position"":[720,680],""id"":""812ee9c9-9032-4689-9321-823118bc3ef7"",""name"":""Text Classifier""},{""parameters"":{""options"":{}},""type"":""@n8n/n8n-nodes-langchain.agent"",""typeVersion"":1.7,""position"":[1200,520],""id"":""40856d96-edf0-4aad-9b2a-5768e1593365"",""name"":""Poem Generator""},{""parameters"":{""options"":{}},""type"":""@n8n/n8n-nodes-langchain.agent"",""typeVersion"":1.7,""position"":[1200,660],""id"":""d3470365-9ace-407e-9616-2f982f2a1753"",""name"":""Joke Generator""},{""parameters"":{""options"":{}},""type"":""@n8n/n8n-nodes-langchain.agent"",""typeVersion"":1.7,""position"":[1200,800],""id"":""f40eae3a-f4ba-4018-95bd-0fcee557a50b"",""name"":""Story Generator""},{""parameters"":{""mode"":""raw"",""jsonOutput"":""{\n  \""output\"":  \""I'm not sure what type of content you're. Could you clarify if you'd like a **Poem**, a **Joke**, or a **Story**?\""\n}\n"",""options"":{}},""type"":""n8n-nodes-base.set"",""typeVersion"":3.4,""position"":[1200,940],""id"":""110cae3e-e267-424a-b6f1-0091243430b7"",""name"":""Error Message""},{""parameters"":{""model"":{""__rl"":true,""value"":""o3-mini"",""mode"":""list"",""cachedResultName"":""o3-mini""},""options"":{}},""type"":""@n8n/n8n-nodes-langchain.lmChatOpenAi"",""typeVersion"":1.2,""position"":[860,940],""id"":""10d3206c-04d2-4eba-aaa4-855df9a063ff"",""name"":""O3-mini-Routing""},{""parameters"":{""promptType"":""define"",""text"":""=Search for top-rated hotels based on \""{{ $json.chatInput }}\"".  \nProvide a concise list including hotel names, price ranges, star ratings, and brief highlights.\n\nInstruction: Always use the SERP API tool."",""options"":{}},""type"":""@n8n/n8n-nodes-langchain.agent"",""typeVersion"":1.7,""position"":[820,1420],""id"":""965ae8e5-456b-4afc-beee-6a33a6431e0b"",""name"":""Hotel Finder""},{""parameters"":{""promptType"":""define"",""text"":""=Search for top-rated restaurants based on \""{{ $json.chatInput }}\"".  \nList 5 recommended restaurants, each with a short description highlighting cuisine type, rating, and popular dishes.\n\nInstruction: Always use the SERP API tool."",""options"":{}},""type"":""@n8n/n8n-nodes-langchain.agent"",""typeVersion"":1.7,""position"":[820,1220],""id"":""d6502130-eeb0-4dda-a89c-cba20e2407ff"",""name"":""Restaurant Finder""},{""parameters"":{""options"":{}},""type"":""@n8n/n8n-nodes-langchain.toolSerpApi"",""typeVersion"":1,""position"":[620,1620],""id"":""f9af358f-d2c6-44d6-b54f-97093c9a2ec6"",""name"":""SerpAPI""},{""parameters"":{""promptType"":""define"",""text"":""=Search for popular tourist attractions and activities based on \""{{ $json.chatInput }}\"".  \nGenerate a short list including activity names, types (cultural, outdoor, etc.), and brief descriptions.\n\nInstruction: Always use the SERP API tool."",""options"":{}},""type"":""@n8n/n8n-nodes-langchain.agent"",""typeVersion"":1.7,""position"":[820,1620],""id"":""8ba743dc-79ef-4e79-bdda-8571f42f7ab6"",""name"":""Activity Finder""},{""parameters"":{""mode"":""raw"",""jsonOutput"":""={\n  \""output\"": {{ JSON.stringify(`\n🏨 Hotels Recommendations:\n${$('Merge').all()[0].json.output}\n\n👨‍🍳 Restaurant Recommendations:\n${$('Merge').all()[1].json.output}\n\n\n🎯 Activity Recommendations:\n${$('Merge').all()[2].json.output}\n`) }}\n}"",""options"":{}},""type"":""n8n-nodes-base.set"",""typeVersion"":3.4,""position"":[1520,1420],""id"":""c3fbd3f4-fdb6-4873-bef9-e248fc5d3792"",""name"":""Aggregator"",""executeOnce"":true},{""parameters"":{""numberInputs"":3},""type"":""n8n-nodes-base.merge"",""typeVersion"":3,""position"":[1360,1420],""id"":""ae07d30e-f68f-428f-94ec-f62b5f083fcf"",""name"":""Merge"",""executeOnce"":false},{""parameters"":{""promptType"":""define"",""text"":""=You are a creative copywriter.\nThe user wants 3 short, catchy slogans for their brand or product: \""{{ $json.chatInput }}\"".\nEmphasize originality, memorability, and brand appeal in each slogan.\nDo not include any extraneous details or explanations.\n\nFormat your response as follows:\n1. ...\n2. ...\n3. ..."",""options"":{}},""type"":""@n8n/n8n-nodes-langchain.agent"",""typeVersion"":1.7,""position"":[2560,1180],""id"":""e7a20a8d-9120-434e-bf77-c0e9fa4bc8cb"",""name"":""OpenAI CopyWriter""},{""parameters"":{""promptType"":""define"",""text"":""=You are a creative copywriter.\nThe user wants 3 short, catchy slogans for their brand or product: \""{{ $json.chatInput }}\"".\nEmphasize originality, memorability, and brand appeal in each slogan.\nDo not include any extraneous details or explanations.\n\nFormat your response as follows:\n1. ...\n2. ...\n3. ..."",""options"":{}},""type"":""@n8n/n8n-nodes-langchain.agent"",""typeVersion"":1.7,""position"":[2560,1420],""id"":""53e691e0-3219-4f18-a4bc-cb4b8517b686"",""name"":""Anthropic CopyWriter""},{""parameters"":{""promptType"":""define"",""text"":""=You are a creative copywriter.\nThe user wants 3 short, catchy slogans for their brand or product: \""{{ $json.chatInput }}\"".\nEmphasize originality, memorability, and brand appeal in each slogan.\nDo not include any extraneous details or explanations.\n\nFormat your response as follows:\n1. ...\n2. ...\n3. ..."",""options"":{}},""type"":""@n8n/n8n-nodes-langchain.agent"",""typeVersion"":1.7,""position"":[2560,1660],""id"":""d915bbd3-de4b-432a-ad8b-e33afeb398c5"",""name"":""Gemini CopyWriter""},{""parameters"":{""modelName"":""models/gemini-2.0-flash-thinking-exp"",""options"":{}},""type"":""@n8n/n8n-nodes-langchain.lmChatGoogleGemini"",""typeVersion"":1,""position"":[2560,1300],""id"":""249b2d9f-b4ff-467d-a4d1-79c6101e62d8"",""name"":""2.0 Flash CW""},{""parameters"":{""options"":{}},""type"":""@n8n/n8n-nodes-langchain.lmChatAnthropic"",""typeVersion"":1.2,""position"":[2560,1540],""id"":""85a24b72-87e8-4434-a250-acc74278a26f"",""name"":""Claude 3.5 CW""},{""parameters"":{""model"":{""__rl"":true,""value"":""o3-mini"",""mode"":""list"",""cachedResultName"":""o3-mini""},""options"":{}},""type"":""@n8n/n8n-nodes-langchain.lmChatOpenAi"",""typeVersion"":1.2,""position"":[2560,1780],""id"":""bc925ae4-850b-44f4-a1fd-fdfb9e44b6fa"",""name"":""O3-MINI CW""},{""parameters"":{""numberInputs"":3},""type"":""n8n-nodes-base.merge"",""typeVersion"":3,""position"":[3100,1460],""id"":""98f47a2a-5779-4561-9eed-3b337f7af2d8"",""name"":""Voting Merge""},{""parameters"":{""mode"":""raw"",""jsonOutput"":""={\n  \""output\"": {{ JSON.stringify(`\n2.0 Flash:\n${$('Voting Merge').all()[0].json.output}\n\nClaude 3.5:\n${$('Voting Merge').all()[1].json.output}\n\nO3-MINI:\n${$('Voting Merge').all()[2].json.output}\n`) }}\n}"",""options"":{}},""type"":""n8n-nodes-base.set"",""typeVersion"":3.4,""position"":[3300,1460],""id"":""8eeb0413-80f5-4217-b260-6a8a779e7163"",""name"":""CW Aggregator"",""executeOnce"":true},{""parameters"":{""sendTo"":""mahmutktech98@gmail.com"",""subject"":""Copy Writer Demo"",""emailType"":""text"",""message"":""={{ $json.output }}"",""options"":{}},""type"":""n8n-nodes-base.gmail"",""typeVersion"":2.1,""position"":[1720,1420],""id"":""b16cd86b-064d-4d49-abf9-9e60a5969255"",""name"":""Sectioning Demo"",""webhookId"":""080228b9-3925-4009-8241-9b3854616590""},{""parameters"":{""sendTo"":""mahmutktech98@gmail.com"",""subject"":""Copy Writer Demo"",""emailType"":""text"",""message"":""={{ $json.output }}"",""options"":{}},""type"":""n8n-nodes-base.gmail"",""typeVersion"":2.1,""position"":[3500,1460],""id"":""206ff04e-a7ff-42c6-aef3-367ba1d56fbd"",""name"":""CW Demo"",""webhookId"":""080228b9-3925-4009-8241-9b3854616590""},{""parameters"":{""promptType"":""define"",""text"":""=Email Content: {{$json.output}}"",""hasOutputParser"":true,""options"":{""systemMessage"":""=You are the Email Evaluator for TechSpark\n\nYou will receive an email content\n\nEvaluate the email based on:\n- Clarity and completeness.\n- Tone (professional, friendly, etc.).\n- Proper sign-off as \""John Doe\"".\n- Text should not include the \""Subject\""\n\nReturn your evaluation as valid JSON with one of the following formats:\n\n1. If the email passes all criteria:\n{\n  \""pass\"": true\n}\n\n2. If the email does not meet all criteria:\n{\n  \""pass\"": false,\n  \""feedback\"": \""Provide concise, actionable suggestions here.\""\n}\n\nNo extra keys or text outside the JSON structure.""}},""type"":""@n8n/n8n-nodes-langchain.agent"",""typeVersion"":1.7,""position"":[1440,2660],""id"":""8c84fe48-f6e0-4b08-a419-46e909ba4ec8"",""name"":""Evaluator""},{""parameters"":{""conditions"":{""options"":{""caseSensitive"":true,""leftValue"":"""",""typeValidation"":""strict"",""version"":2},""conditions"":[{""id"":""c7cd25e9-31ab-4c2a-8880-0148aea726c2"",""leftValue"":""={{ $json.output.pass }}"",""rightValue"":"""",""operator"":{""type"":""boolean"",""operation"":""true"",""singleValue"":true}}],""combinator"":""and""},""options"":{}},""type"":""n8n-nodes-base.if"",""typeVersion"":2.2,""position"":[1760,2660],""id"":""c2f0823c-8fbe-466e-b423-de854228fde0"",""name"":""If""},{""parameters"":{""jsonSchemaExample"":""{\n\t\""pass\"": true,\n\t\""feedback\"": \""this is empty when pass is true\""\n}""},""type"":""@n8n/n8n-nodes-langchain.outputParserStructured"",""typeVersion"":1.2,""position"":[1620,2880],""id"":""f097f1f0-48b8-42bb-a17d-124fca005522"",""name"":""Structured Output Parser""},{""parameters"":{""model"":{""__rl"":true,""value"":""o3-mini"",""mode"":""list"",""cachedResultName"":""o3-mini""},""options"":{}},""type"":""@n8n/n8n-nodes-langchain.lmChatOpenAi"",""typeVersion"":1.2,""position"":[1100,2920],""id"":""829624e3-3752-436e-b1ca-eb919e4de113"",""name"":""EO - o3 mini""},{""parameters"":{""pollTimes"":{""item"":[{""mode"":""everyMinute""}]},""simple"":false,""filters"":{},""options"":{}},""type"":""n8n-nodes-base.gmailTrigger"",""typeVersion"":1.2,""position"":[340,2680],""id"":""6085eabd-fd08-43f7-8af8-92769a59654a"",""name"":""Gmail Trigger""},{""parameters"":{""promptType"":""define"",""text"":""={{ $json.text }}"",""options"":{""systemMessage"":""=You are a Customer Support Specialist at TechSpark Solutions.\n\nYou will be provided with a customer inquiry\n\nPrepare a concise, polite, and helpful email response addressing the customer’s question or concern.  \n\nOutput only the final email text—no extra commentary or formatting.\n\n\n\n<feedback> (if any)\n{{ $json.feedback }}\n\n\n<preparedEmail> (if an email is already prepared, this is what the feedback is on)\n{{ $json.currentEmail }}\n</preparedEmail>\n</feedback>""}},""type"":""@n8n/n8n-nodes-langchain.agent"",""typeVersion"":1.7,""position"":[1060,2660],""id"":""63cd4cd1-a720-4174-9a17-dee452bf693e"",""name"":""Customer Support""},{""parameters"":{""resource"":""thread"",""operation"":""reply"",""threadId"":""={{ $('Gmail Trigger').first().json.threadId }}"",""messageId"":""={{ $('Gmail Trigger').first().json.id }}"",""message"":""={{ $('Customer Support').last().json.output }}"",""options"":{}},""type"":""n8n-nodes-base.gmail"",""typeVersion"":2.1,""position"":[2060,2640],""id"":""7281218b-1580-4d26-9331-97794c20f11c"",""name"":""Gmail"",""webhookId"":""58be091c-293b-4fcc-8c56-56da568e0637""},{""parameters"":{""mode"":""raw"",""jsonOutput"":""={\n  \""currentEmail\"": {{ JSON.stringify($('Customer Support').last().json.output) }},\n  \""feedback\"": {{  JSON.stringify($json.output.feedback) }},\n  \""text\"": {{  JSON.stringify($('Gmail Trigger').first().json.text) }}\n}"",""options"":{}},""type"":""n8n-nodes-base.set"",""typeVersion"":3.4,""position"":[1340,2900],""id"":""789b5346-3971-4b7d-b3bc-6436eea2e82d"",""name"":""feedback""},{""parameters"":{""inputText"":""={{ $json.text }}"",""categories"":{""categories"":[{""category"":""Customer Inquiry"",""description"":""Text where the user requests assistance, more information, or expresses a concern about a product or service.""},{""category"":""No Action Required"",""description"":""Text that does not ask a question, seek information, or require a direct response.""}]},""options"":{""systemPromptTemplate"":""You are a text classifier at TechSpark Solutions.\nPlease classify the text provided by the user into one of the following categories: {categories}, and use the provided formatting instructions below. Don't explain, and only output the json.""}},""type"":""@n8n/n8n-nodes-langchain.textClassifier"",""typeVersion"":1,""position"":[620,2680],""id"":""b2a6357f-7ef9-4e9e-b208-ff7169ff5f67"",""name"":""Classify Email""},{""parameters"":{""mode"":""raw"",""jsonOutput"":""{\n  \""chatInput\"": \""Taksim, Istanbul\""\n}\n"",""options"":{}},""type"":""n8n-nodes-base.set"",""typeVersion"":3.4,""position"":[560,1440],""id"":""91f8b2e7-f843-49bd-bdd1-18a6bacafaf0"",""name"":""Sectioning""},{""parameters"":{""mode"":""raw"",""jsonOutput"":""{\n  \""chatInput\"": \""Aithletic an AI Driven Fitness App, that will personalized exercises based on user profile\""\n}\n"",""options"":{}},""type"":""n8n-nodes-base.set"",""typeVersion"":3.4,""position"":[2200,1420],""id"":""1fcb6b6f-5661-4c6b-a168-b21b2498defe"",""name"":""Voting""},{""parameters"":{""mode"":""raw"",""jsonOutput"":""{\n  \""chatInput\"": \""tell me a joke about a cat\""\n}\n"",""options"":{}},""type"":""n8n-nodes-base.set"",""typeVersion"":3.4,""position"":[560,680],""id"":""d8429574-325f-41c0-9487-3e3680816c03"",""name"":""Routing""},{""parameters"":{""mode"":""raw"",""jsonOutput"":""{\n  \""topic\"": \""obesity\""\n}\n"",""options"":{}},""type"":""n8n-nodes-base.set"",""typeVersion"":3.4,""position"":[460,-20],""id"":""85fcca7d-8d1d-4915-99cc-320e2ec6b3c9"",""name"":""Prompt Chaining""},{""parameters"":{""options"":{}},""type"":""@n8n/n8n-nodes-langchain.chatTrigger"",""typeVersion"":1.1,""position"":[400,3420],""id"":""3d150392-6237-42aa-98f4-a4c76ef13bf7"",""name"":""When chat message received"",""webhookId"":""03da4a05-c510-4577-b723-d695740de587""},{""parameters"":{""model"":{""__rl"":true,""value"":""o3-mini"",""mode"":""list"",""cachedResultName"":""o3-mini""},""options"":{}},""type"":""@n8n/n8n-nodes-langchain.lmChatOpenAi"",""typeVersion"":1.2,""position"":[480,3660],""id"":""b29f99f2-fbaa-4e3d-b851-f518ceb03ff2"",""name"":""Agents - O3-MINI""},{""parameters"":{""operation"":""getAll"",""calendar"":{""__rl"":true,""value"":""mahmutktech98@gmail.com"",""mode"":""list"",""cachedResultName"":""mahmutktech98@gmail.com""},""limit"":""={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Limit', ``, 'number') }}"",""timeMin"":""={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('After', ``, 'string') }}"",""timeMax"":""={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Before', ``, 'string') }}"",""options"":{}},""type"":""n8n-nodes-base.googleCalendarTool"",""typeVersion"":1.3,""position"":[1060,3640],""id"":""24612323-2dd8-4bc4-86de-a76b359d70d0"",""name"":""Get Events""},{""parameters"":{""calendar"":{""__rl"":true,""value"":""mahmutktech98@gmail.com"",""mode"":""list"",""cachedResultName"":""mahmutktech98@gmail.com""},""start"":""={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Start', ``, 'string') }}"",""end"":""={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('End', ``, 'string') }}"",""additionalFields"":{""attendees"":[""={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Attendees', `Event Attendees`, 'string') }}""],""description"":""={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Description', ``, 'string') }}"",""summary"":""={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Summary', `Event Title`, 'string') }}""}},""type"":""n8n-nodes-base.googleCalendarTool"",""typeVersion"":1.3,""position"":[940,3640],""id"":""7921baec-03a4-47b8-9d0f-a784accc65af"",""name"":""Create Calendar Event""},{""parameters"":{""options"":{""systemMessage"":""=You are a helpful calendar assistant.\n\nContext:\nCurrent Date Time: {{ $now }}}""}},""type"":""@n8n/n8n-nodes-langchain.agent"",""typeVersion"":1.7,""position"":[600,3420],""id"":""39e0d2ed-6841-4104-b041-b0e2d96b52ea"",""name"":""Calendar Agent""},{""parameters"":{""mode"":""raw"",""jsonOutput"":""{\n  \""input\"": \""Please translate the following to Spanish, Turkish, and French -> Hello! I just arrived in Barcelona, and I’m already captivated by the city’s vibrant atmosphere. The weather is sunny and warm, perfect for exploring the narrow streets and sampling local tapas. Tomorrow, I plan to visit the famous Sagrada Família, and next week I’ll head to Madrid for a brief business meeting. Traveling always broadens my perspective, and I can’t wait to discover more of Spain’s rich culture and history.\""\n}\n"",""options"":{}},""type"":""n8n-nodes-base.set"",""typeVersion"":3.4,""position"":[540,2060],""id"":""ae2f1c28-90ea-483d-99cb-810033b87f3d"",""name"":""Orchestrator""},{""parameters"":{""promptType"":""define"",""text"":""={{ $json.input }}\n"",""hasOutputParser"":true,""options"":{""systemMessage"":""=You are an Orchestrator. A user will provide a text and the language(s) they want to translate the text into.\n\nYour goal:\n1. Identify all languages the user wants to translate the text into.\n2. Identify the text\"".\n3. Produce a valid JSON array where each element has:\n   {\n     \""Language\"": \""<target language>\"",\n     \""text\"": \""<original text>\""\n   }\n\nConstraints:\n- Output only the JSON array, nothing else.\n- If multiple languages are listed, create one object per language.\n- If no languages are mentioned, output an empty array.\n\nExample Input:\n\""Please translate the following to Spanish, Turkish, and French -> Hello! I just arrived in Barcelona...\""\n\nExpected Output (valid JSON):\n[\n  {\n    \""Language\"": \""Spanish\"",\n    \""text\"": \""Hello! I just arrived in Barcelona...\""\n  },\n  {\n    \""Language\"": \""Turkish\"",\n    \""text\"": \""Hello! I just arrived in Barcelona...\""\n  },\n  {\n    \""Language\"": \""French\"",\n    \""text\"": \""Hello! I just arrived in Barcelona...\""\n  }\n]""}},""type"":""@n8n/n8n-nodes-langchain.agent"",""typeVersion"":1.7,""position"":[720,2060],""id"":""b0886668-3fcc-4f37-b827-189f6713de7f"",""name"":""Orchestrator Agent""},{""parameters"":{""model"":{""__rl"":true,""value"":""o3-mini"",""mode"":""list"",""cachedResultName"":""o3-mini""},""options"":{}},""type"":""@n8n/n8n-nodes-langchain.lmChatOpenAi"",""typeVersion"":1.2,""position"":[1160,2300],""id"":""7d78b346-0619-4251-953d-e4fb48252278"",""name"":""O3-mini-Routing2""},{""parameters"":{""model"":{""__rl"":true,""value"":""o3-mini"",""mode"":""list"",""cachedResultName"":""o3-mini""},""options"":{}},""type"":""@n8n/n8n-nodes-langchain.lmChatOpenAi"",""typeVersion"":1.2,""position"":[620,1280],""id"":""99bdce63-1f15-47d9-9940-c4987ae5b51f"",""name"":""O3-mini-P""},{""parameters"":{},""type"":""@n8n/n8n-nodes-langchain.memoryBufferWindow"",""typeVersion"":1.3,""position"":[620,3700],""id"":""2c7a0d5f-99fe-4566-a632-283da549c3c3"",""name"":""Window Buffer Memory""},{""parameters"":{""fieldToSplitOut"":""output"",""options"":{}},""type"":""n8n-nodes-base.splitOut"",""typeVersion"":1,""position"":[1060,2060],""id"":""e25feefb-ae70-4c8f-865e-76a92950c84c"",""name"":""Split Out""},{""parameters"":{""jsonSchemaExample"":""[\n  {\n    \""Language\"": \""Spanish\"",\n    \""text\"": \""Sample text, Hi there, My name is John\""\n  }\n]""},""type"":""@n8n/n8n-nodes-langchain.outputParserStructured"",""typeVersion"":1.2,""position"":[880,2320],""id"":""8842230d-9e78-4339-aca7-04e00ce57ed5"",""name"":""Translation Array""},{""parameters"":{""fieldsToAggregate"":{""fieldToAggregate"":[{""fieldToAggregate"":""output""}]},""options"":{}},""type"":""n8n-nodes-base.aggregate"",""typeVersion"":1,""position"":[1560,2060],""id"":""ef929e73-e7a9-4e9e-b849-f731967974db"",""name"":""Translated Text""},{""parameters"":{""promptType"":""define"",""text"":""=You are a Translator Agent.\n\nPlease translate the text below into: {{ $json.Language }}\n\nText to translate:\n{{ $json.text }}\n\nOutput only the translated text With the translated language as the title, with no additional commentary."",""options"":{}},""type"":""@n8n/n8n-nodes-langchain.agent"",""typeVersion"":1.7,""position"":[1240,2060],""id"":""06055c74-0503-4d69-8d3d-b83bfa64ad23"",""name"":""Translator Agent""},{""parameters"":{""sendTo"":""oncekod98@gmail.com"",""subject"":""=Translated Text"",""emailType"":""text"",""message"":""={{ $json.output.join('\\n\\n') }}"",""options"":{}},""type"":""n8n-nodes-base.gmail"",""typeVersion"":2.1,""position"":[1780,2060],""id"":""7c2e9288-6ae1-4281-8ff1-3a1087e618b6"",""name"":""Gmail3"",""webhookId"":""39a7f851-3576-477c-8ec6-792a05230062""},{""parameters"":{""promptType"":""define"",""text"":""=List concise, structured key points and angles about the following topic: {{ $json.topic }}"",""options"":{}},""type"":""@n8n/n8n-nodes-langchain.agent"",""typeVersion"":1.7,""position"":[600,-20],""id"":""b928dc86-539a-41a8-aeb6-ab0fb2778f23"",""name"":""Key Points Generator"",""retryOnFail"":false},{""parameters"":{""sendTo"":""=mahmutktech98@gmail.com"",""subject"":""Prompt Chaining Demo"",""message"":""={{ $json.output }}"",""options"":{}},""type"":""n8n-nodes-base.gmail"",""typeVersion"":2.1,""position"":[1480,-20],""id"":""be148bae-f695-44b3-b0d5-b2852cc17768"",""name"":""Gmail4"",""webhookId"":""4e66298d-d364-4ea5-846c-7673a94a9839""},{""parameters"":{""sendTo"":""={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('To', ``, 'string') }}"",""subject"":""={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Subject', ``, 'string') }}"",""message"":""={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Message', ``, 'string') }}"",""options"":{}},""type"":""n8n-nodes-base.gmailTool"",""typeVersion"":2.1,""position"":[820,3640],""id"":""db1f7119-595c-4eaf-ab14-6a6efd6ee54e"",""name"":""Send Email"",""webhookId"":""71a39428-8b08-4105-88fb-5c7ca0e4fa16""},{""parameters"":{""promptType"":""define"",""text"":""=Using the following notes as a reference:\n{{$json.output}}\n\nCreate a report outline for \""{{$('Prompt Chaining').item.json.topic}}\"".  \nInclude clearly named sections with brief descriptions, structured as follows:\n- Introduction\n- Main body sections\n- Conclusion"",""options"":{}},""type"":""@n8n/n8n-nodes-langchain.agent"",""typeVersion"":1.7,""position"":[900,-20],""id"":""f072193c-fdac-4e8f-9ea4-9b219582ec79"",""name"":""Report Planner""},{""parameters"":{""mode"":""jsonKeyValue""},""type"":""n8n-nodes-base.code"",""typeVersion"":1,""position"":[2860,4280],""id"":""902729b6-c2a3-4526-b394-cbe4e89d0fcd"",""name"":""Parse Patient Data""},{""parameters"":{""mode"":""raw"",""jsonOutput"":""{\n  \""workflowState\"": {\n    \""currentPhase\"": \""initialization\"",\n    \""patientId\"": null,\n    \""letterType\"": \""discharge\"",\n    \""sections\"": {\n      \""patientDemographics\"": {\n        \""status\"": \""pending\"",\n        \""data\"": null\n      },\n      \""diagnosis\"": {\n        \""status\"": \""pending\"",\n        \""data\"": null\n      },\n      \""medicalHistory\"": {\n        \""status\"": \""pending\"",\n        \""data\"": null\n      },\n      \""treatment\"": {\n        \""status\"": \""pending\"",\n        \""data\"": null\n      },\n      \""medication\"": {\n        \""status\"": \""pending\"",\n        \""data\"": null\n      },\n      \""followUp\"": {\n        \""status\"": \""pending\"",\n        \""data\"": null\n      }\n    },\n    \""quality\"": {\n      \""status\"": \""pending\"",\n      \""feedbackCycles\"": 0\n    }\n  },\n  \""patientData\"": $json.data,\n  \""templateData\"": {\n    \""hospitalName\"": \""University Medical Center\"",\n    \""departmentName\"": \""Internal Medicine\"",\n    \""hospitalAddress\"": \""123 Medical Center Blvd, Medicalville, 12345\"",\n    \""phoneNumber\"": \""+1-555-123-4567\"",\n    \""faxNumber\"": \""+1-555-123-4568\"",\n    \""headerLogo\"": \""hospital_logo.png\""\n  }\n}"",""options"":{}},""type"":""n8n-nodes-base.set"",""typeVersion"":3.4,""position"":[3140,4280],""id"":""2aac259e-c69c-4c84-9b3f-196728fff5d8"",""name"":""Initialize Workflow State""},{""parameters"":{""model"":{""__rl"":true,""value"":""hf.co/unsloth/gemma-3-4b-it-GGUF:Q4_K_M"",""mode"":""list"",""cachedResultName"":""hf.co/unsloth/gemma-3-4b-it-GGUF:Q4_K_M""},""options"":{}},""type"":""@n8n/n8n-nodes-langchain.lmChatOpenAi"",""typeVersion"":1.2,""position"":[3520,4460],""id"":""d75b9ad1-9b55-4b03-aa1b-571376651296"",""name"":""Router LLM"",""credentials"":{""openAiApi"":{""id"":""tRHsMPxbW4YJD93X"",""name"":""Ollama OpenAI""}}},{""parameters"":{""options"":{""systemMessage"":""You are a medical documentation router that determines the appropriate workflow for medical document generation requests.\n\nYou will receive patient data and determine what type of discharge letter is needed based on the available information.\n\nFormat your response as JSON:\n{\n  \""documentType\"": \""dischargeLetter\"",\n  \""department\"": \""[department determined from data]\"",\n  \""patientId\"": \""[extracted ID if available]\"",\n  \""requiredSections\"": [\""list\"", \""of\"", \""required\"", \""sections\""],\n  \""additionalInstructions\"": \""[any special requirements]\""\n}""}},""type"":""@n8n/n8n-nodes-langchain.agent"",""typeVersion"":1.8,""position"":[3580,4280],""id"":""1e6101e0-3b65-4057-b17a-ff20eddef999"",""name"":""LLM Router""},{""parameters"":{""mode"":""raw"",""jsonOutput"":""={\n  \""workflowState\"": {\n    ...($json.workflowState),\n    \""currentPhase\"": \""routing\"",\n    \""routingDecision\"": $json.output\n  }\n}"",""options"":{}},""type"":""n8n-nodes-base.set"",""typeVersion"":3.4,""position"":[3960,4280],""id"":""9458ecae-872d-4ea6-bf0e-f604991bdef4"",""name"":""Update Workflow State""},{""parameters"":{""content"":""# Sample Patient Data Input\n\nProvide a sample text file containing patient data in this format:\n\n```\nPatientID: 12345\nName: John Doe\nDateOfBirth: 15-05-1970\nAdmissionDate: 10-01-2024\nDischargeDate: 20-01-2024\nPrimaryDiagnosis: Type 2 Diabetes Mellitus with hyperglycemia\nSecondaryDiagnoses: Essential Hypertension, Hyperlipidemia\nProcedures: Blood glucose monitoring, Insulin therapy adjustment\nMedications: Metformin 1000mg BID, Lisinopril 10mg daily, Atorvastatin 20mg at bedtime\nFollowup: Endocrinology clinic in 2 weeks\n```\n\nThis text would be uploaded or entered by the user."",""height"":440,""width"":460},""type"":""n8n-nodes-base.stickyNote"",""typeVersion"":1,""position"":[2360,3720],""id"":""b3f5bf63-112e-450a-a882-bbfd527137c9"",""name"":""Sample Data Format""},{""parameters"":{""content"":""# State Management\n\nThis node initializes a JSON structure that will track:\n1. Overall workflow state\n2. Status of each section\n3. Patient data\n4. Template information\n\nThis state will be updated throughout the workflow."",""height"":220,""width"":260},""type"":""n8n-nodes-base.stickyNote"",""typeVersion"":1,""position"":[3060,4060],""id"":""fa3b101f-d20f-4772-acc9-9351aa0208c1"",""name"":""State Management Note""},{""parameters"":{""content"":""# LLM Router\n\nThis agent determines what type of discharge letter is needed and which sections should be included based on the patient data."",""height"":200,""width"":260},""type"":""n8n-nodes-base.stickyNote"",""typeVersion"":1,""position"":[3580,4060],""id"":""dc8a92e8-dccf-4d3e-b271-6a759c123ff0"",""name"":""Router Note""},{""parameters"":{""fileSelector"":""/data/shared/"",""options"":{""fileName"":""ward_documentation.txt""}},""type"":""n8n-nodes-base.readWriteFile"",""typeVersion"":1,""position"":[2400,4280],""id"":""58178eda-c7f2-4930-bff0-e02324ab80ef"",""name"":""Read/Write Files from Disk""},{""parameters"":{""operation"":""text"",""options"":{}},""type"":""n8n-nodes-base.extractFromFile"",""typeVersion"":1,""position"":[2600,4280],""id"":""ba00b869-b28b-450b-9146-529dc3e28d88"",""name"":""Extract from File""},{""parameters"":{},""type"":""n8n-nodes-base.code"",""typeVersion"":1.1,""position"":[2580,3460],""id"":""dcf5d060-6b6c-4c34-93d4-5b2595e95270"",""name"":""Ward Documentation Reader""},{""parameters"":{""functionCode"":""if (Object.keys($input.first().json).includes('error')) {\n  // Handle error in file reading\n  return {\n    success: false,\n    error: $input.first().json.error,\n    errorType: $input.first().json.errorType || 'unknown_error'\n  };\n} else {\n  // Successful file read\n  return {\n    success: true,\n    patientData: $input.first().json.patientData,\n    rawFileContent: $input.first().json.rawFileContent\n  };\n}""},""type"":""n8n-nodes-base.function"",""typeVersion"":1,""position"":[2780,3460],""id"":""4aa3a60b-9801-4953-b170-45a01e1ef01b"",""name"":""Handle File Read Result""},{""parameters"":{""conditions"":{""options"":{""caseSensitive"":true,""leftValue"":"""",""typeValidation"":""strict""},""conditions"":[{""id"":""c7cd25e9-31ab-4c2a-8880-0148aea726c2"",""leftValue"":""={{ $json.success }}"",""rightValue"":""true"",""operator"":{""type"":""boolean"",""operation"":""equals"",""singleValue"":true}}],""combinator"":""and""},""options"":{}},""type"":""n8n-nodes-base.if"",""typeVersion"":2,""position"":[2980,3460],""id"":""ca8e029e-a9a1-41a7-8a45-fe27fd37e289"",""name"":""File Read Success?""},{""parameters"":{""mode"":""raw"",""jsonOutput"":""{\n  \""success\"": false,\n  \""error\"": \""Failed to read or parse ward documentation file\"",\n  \""details\"": $json.error,\n  \""errorType\"": $json.errorType\n}"",""options"":{}},""type"":""n8n-nodes-base.set"",""typeVersion"":3.4,""position"":[3200,3560],""id"":""c2576d14-79d9-4508-a112-0fbe91e83086"",""name"":""Set Error State""},{""parameters"":{""content"":""# Ward Documentation Parser\n\nThis node reads the ward documentation file from the specified path and parses it into structured data with these sections:\n\n- Demographics\n- Admission details\n- Diagnoses\n- Procedures\n- Medications\n- Course of treatment\n- Lab results\n- Follow-up instructions\n\nThe parser is designed to handle various text formats commonly found in medical documentation."",""height"":320,""width"":300},""type"":""n8n-nodes-base.stickyNote"",""typeVersion"":1,""position"":[2560,3240],""id"":""d61c35f3-fc35-431b-913d-7f96936d693e"",""name"":""Parser Note""},{""parameters"":{""content"":""# Error Handling\n\nThese nodes check if the file was read successfully and handle any errors that might occur during the file reading or parsing process."",""width"":260},""type"":""n8n-nodes-base.stickyNote"",""typeVersion"":1,""position"":[2880,3240],""id"":""13bd762a-bfff-47fc-bc8c-2c3462e2db18"",""name"":""Error Handling Note""},{""parameters"":{""content"":""# Router Agent\n\nThis LLM agent analyzes the patient data to determine:\n- Appropriate letter type\n- Required and optional sections\n- Special instructions based on the patient's condition\n- Medical specialty relevant to the case"",""height"":220,""width"":260},""type"":""n8n-nodes-base.stickyNote"",""typeVersion"":1,""position"":[3580,3240],""id"":""0763af6b-ee08-4d88-8946-76a81180ea47"",""name"":""Router Agent Note""},{""parameters"":{""mode"":""raw"",""jsonOutput"":""{\n  \""workflowState\"": {\n    \""currentPhase\"": \""initialization\"",\n    \""patientId\"": \""{{ $json.patientData.patientId || 'unknown' }}\"",\n    \""letterType\"": \""discharge\"",\n    \""sections\"": {\n      \""patientDemographics\"": {\n        \""status\"": \""pending\"",\n        \""data\"": $json.patientData.demographics\n      },\n      \""diagnosis\"": {\n        \""status\"": \""pending\"",\n        \""data\"": {\n          \""primary\"": $json.patientData.primaryDiagnosis,\n          \""secondary\"": $json.patientData.secondaryDiagnoses\n        }\n      },\n      \""medicalHistory\"": {\n        \""status\"": \""pending\"",\n        \""data\"": null\n      },\n      \""treatment\"": {\n        \""status\"": \""pending\"",\n        \""data\"": $json.patientData.procedures\n      },\n      \""medication\"": {\n        \""status\"": \""pending\"",\n        \""data\"": $json.patientData.medications\n      },\n      \""courseOfTreatment\"": {\n        \""status\"": \""pending\"",\n        \""data\"": $json.patientData.courseOfTreatment\n      },\n      \""labResults\"": {\n        \""status\"": \""pending\"",\n        \""data\"": $json.patientData.labResults\n      },\n      \""followUp\"": {\n        \""status\"": \""pending\"",\n        \""data\"": $json.patientData.followUp\n      }\n    },\n    \""quality\"": {\n      \""status\"": \""pending\"",\n      \""feedbackCycles\"": 0\n    }\n  },\n  \""parsedPatientData\"": $json.patientData,\n  \""rawPatientData\"": $json.rawFileContent,\n  \""templateData\"": {\n    \""hospitalName\"": \""University Medical Center\"",\n    \""departmentName\"": \""Internal Medicine\"",\n    \""hospitalAddress\"": \""123 Medical Center Blvd, Medicalville, 12345\"",\n    \""phoneNumber\"": \""+1-555-123-4567\"",\n    \""faxNumber\"": \""+1-555-123-4568\"",\n    \""headerLogo\"": \""hospital_logo.png\""\n  }\n}"",""options"":{}},""type"":""n8n-nodes-base.set"",""typeVersion"":3.4,""position"":[3200,3400],""id"":""303a43b2-875e-4df5-aa3c-a2dae0542483"",""name"":""Initialize Workflow State1""},{""parameters"":{""model"":{""__rl"":true,""value"":""gpt-4o"",""mode"":""list"",""cachedResultName"":""gpt-4o""},""options"":{}},""type"":""@n8n/n8n-nodes-langchain.lmChatOpenAi"",""typeVersion"":1.2,""position"":[3620,3660],""id"":""87aa6d80-2b29-41bb-9e52-ef3fdfce816c"",""name"":""Router LLM1""},{""parameters"":{""options"":{""systemMessage"":""You are a medical documentation router that determines the appropriate workflow for medical document generation requests.\n\nYou will receive patient data and determine what type of discharge letter is needed based on the available information. Analyze the patient's condition, treatments, and department to determine which sections are required in the discharge letter.\n\nFormat your response as JSON:\n{\n  \""documentType\"": \""dischargeLetter\"",\n  \""department\"": \""[department determined from data]\"",\n  \""specialtyType\"": \""[specialty type, e.g., cardiology, orthopedics, etc.]\"",\n  \""patientId\"": \""[extracted ID if available]\"",\n  \""requiredSections\"": [\""list\"", \""of\"", \""required\"", \""sections\""],\n  \""optionalSections\"": [\""list\"", \""of\"", \""optional\"", \""sections\""],\n  \""additionalInstructions\"": \""[any special requirements based on patient's condition]\""\n}""}},""type"":""@n8n/n8n-nodes-langchain.agent"",""typeVersion"":1.8,""position"":[3620,3480],""id"":""1b022ca1-58a6-4c28-a783-5e13a78ecc77"",""name"":""LLM Router1""},{""parameters"":{""mode"":""raw"",""jsonOutput"":""={\n  \""workflowState\"": {\n    ...($json.workflowState),\n    \""currentPhase\"": \""routing\"",\n    \""routingDecision\"": $json.output\n  }\n}"",""options"":{}},""type"":""n8n-nodes-base.set"",""typeVersion"":3.4,""position"":[3940,3420],""id"":""100ce19d-3a6e-4a3a-bc09-83861fa5fe81"",""name"":""Update Workflow State1""},{""parameters"":{""content"":""# State Management\n\nThis node creates a comprehensive workflow state that includes:\n- Patient data organized by section\n- Current workflow phase\n- Document section statuses\n- Template information\n\nThis state will be updated throughout the workflow."",""height"":220,""width"":260},""type"":""n8n-nodes-base.stickyNote"",""typeVersion"":1,""position"":[3200,3160],""id"":""d5110633-8bb0-444a-9843-6cd374f19e17"",""name"":""State Management Note1""},{""parameters"":{""conditions"":{""options"":{""caseSensitive"":true,""leftValue"":"""",""typeValidation"":""strict"",""version"":2},""conditions"":[{""id"":""c7cd25e9-31ab-4c2a-8880-0148aea726c2"",""leftValue"":""={{ $json.output.pass }}"",""rightValue"":"""",""operator"":{""type"":""boolean"",""operation"":""true"",""singleValue"":true}}],""combinator"":""and""},""options"":{}},""type"":""n8n-nodes-base.if"",""typeVersion"":2.2,""position"":[4540,2740],""id"":""2f3ba8bc-5e6c-4872-8107-61319ddbd027"",""name"":""If1""},{""parameters"":{""jsonSchemaExample"":""{\n\t\""pass\"": true,\n\t\""feedback\"": \""this is empty when pass is true\""\n}""},""type"":""@n8n/n8n-nodes-langchain.outputParserStructured"",""typeVersion"":1.2,""position"":[4400,2960],""id"":""030c473c-a94e-4ca9-a85d-1a010168a60f"",""name"":""Structured Output Parser1""},{""parameters"":{""model"":{""__rl"":true,""value"":""qwen2.5:14b-corrected8k"",""mode"":""list"",""cachedResultName"":""qwen2.5:14b-corrected8k""},""options"":{}},""type"":""@n8n/n8n-nodes-langchain.lmChatOpenAi"",""typeVersion"":1.2,""position"":[3640,2940],""id"":""a8bc505b-2236-451c-a0b9-35ed7e5a47f7"",""name"":""EO - o3 mini1"",""credentials"":{""openAiApi"":{""id"":""tRHsMPxbW4YJD93X"",""name"":""Ollama OpenAI""}}},{""parameters"":{""mode"":""raw"",""jsonOutput"":""={\n  \""currentAnamnesis\"": {{ JSON.stringify($('Anamnesis Writer').last().json.output) }},\n  \""feedback\"": {{  JSON.stringify($json.output.feedback) }}\n}"",""options"":{}},""type"":""n8n-nodes-base.set"",""typeVersion"":3.4,""position"":[4120,2980],""id"":""36984ace-d67f-4b7d-ac23-5aa0d620618f"",""name"":""feedback1""},{""parameters"":{""sessionIdType"":""customKey"",""sessionKey"":""={{ $('Patient Data').item.json.json_agg[0].encounter_id }}.anamnesis.agent.supervisor_id"",""tableName"":""=llm_memory"",""contextWindowLength"":3},""type"":""@n8n/n8n-nodes-langchain.memoryPostgresChat"",""typeVersion"":1.3,""position"":[3860,2940],""id"":""1ea01e33-add9-4f54-a289-86aae35daf18"",""name"":""Postgres Chat Memory"",""credentials"":{""postgres"":{""id"":""i83SgkPKmlQ785tT"",""name"":""Postgres account""}}},{""parameters"":{""operation"":""executeQuery"",""query"":""SELECT json_agg(row_to_json(a))\nFROM med_disc.anamnesis a\nWHERE encounter_id = $1;"",""options"":{""queryReplacement"":""={{ $json.encounter_id }}""}},""type"":""n8n-nodes-base.postgres"",""typeVersion"":2.6,""position"":[2980,2940],""id"":""f98052ab-32c0-4163-99a6-965fd2182af8"",""name"":""Patient Data"",""credentials"":{""postgres"":{""id"":""i83SgkPKmlQ785tT"",""name"":""Postgres account""}}},{""parameters"":{""operation"":""executeQuery"",""query"":""SELECT json_agg(row_to_json(a))\nFROM med_disc.llm_prompt_template a\nWHERE name = $1;"",""options"":{""queryReplacement"":""anamnesis_template""}},""type"":""n8n-nodes-base.postgres"",""typeVersion"":2.6,""position"":[4420,3220],""id"":""73e2f9b7-1b3b-4cbc-8fa8-0a50c9793448"",""name"":""Template1"",""credentials"":{""postgres"":{""id"":""i83SgkPKmlQ785tT"",""name"":""Postgres account""}}},{""parameters"":{""promptType"":""define"",""text"":""=## Feedback (if any):\n{{ $json.feedback }}\n\nChief Complaint:\n{{ $('Patient Data').item.json.json_agg[0].chief_complaint }}\nVegetative State:\n{{ $('Patient Data').item.json.json_agg[0].vegetative_state }}\nHistory of Present Illness:\n{{ $('Patient Data').item.json.json_agg[0].history_of_present_illness }}\nPast Medical History:\n{{ $('Patient Data').item.json.json_agg[0].past_medical_history }}\nFamily History:\n{{ $('Patient Data').item.json.json_agg[0].family_history }}\nSocial History:\n{{ $('Patient Data').item.json.json_agg[0].social_history }}\nReview of Systems:\n{{ $('Patient Data').item.json.json_agg[0].review_of_systems }}"",""options"":{""systemMessage"":""={{ $('Template Creator').item.json.json_agg[0].template_content }}"",""maxIterations"":5}},""type"":""@n8n/n8n-nodes-langchain.agent"",""typeVersion"":1.7,""position"":[3840,2740],""id"":""720c9d2e-5d26-43ca-a1d0-7e0122abc9b9"",""name"":""Anamnesis Writer""},{""parameters"":{""promptType"":""define"",""text"":""=Anamnesis Content: {{$json.output}}"",""hasOutputParser"":true,""options"":{""systemMessage"":""={{ $('Template Evaluator').item.json.json_agg[0].template_content }}""}},""type"":""@n8n/n8n-nodes-langchain.agent"",""typeVersion"":1.7,""position"":[4220,2740],""id"":""8650ee3d-ede3-4e1e-b1e9-00df9627cb51"",""name"":""Anamnesis Evaluator""},{""parameters"":{""operation"":""executeQuery"",""query"":""SELECT json_agg(row_to_json(a))\nFROM med_disc.llm_prompt_template a\nWHERE name = $1;"",""options"":{""queryReplacement"":""anamnesis_template""}},""type"":""n8n-nodes-base.postgres"",""typeVersion"":2.6,""position"":[3120,2940],""id"":""42d4e4ac-bfb2-40fd-b189-eda9e2de2212"",""name"":""Template Creator"",""credentials"":{""postgres"":{""id"":""i83SgkPKmlQ785tT"",""name"":""Postgres account""}}},{""parameters"":{""operation"":""executeQuery"",""query"":""SELECT json_agg(row_to_json(a))\nFROM med_disc.llm_prompt_template a\nWHERE name = $1;"",""options"":{""queryReplacement"":""anamnesis_evaluator""}},""type"":""n8n-nodes-base.postgres"",""typeVersion"":2.5,""position"":[3260,2940],""id"":""071badaf-5a3c-4380-9eb2-535177f165e4"",""name"":""Template Evaluator"",""credentials"":{""postgres"":{""id"":""i83SgkPKmlQ785tT"",""name"":""Postgres account""}}},{""parameters"":{""conditions"":{""options"":{""caseSensitive"":true,""leftValue"":"""",""typeValidation"":""strict"",""version"":2},""conditions"":[{""id"":""c7cd25e9-31ab-4c2a-8880-0148aea726c2"",""leftValue"":""={{ $json.output.pass }}"",""rightValue"":"""",""operator"":{""type"":""boolean"",""operation"":""true"",""singleValue"":true}}],""combinator"":""and""},""options"":{}},""type"":""n8n-nodes-base.if"",""typeVersion"":2.2,""position"":[4480,2240],""id"":""83a08bcd-d44a-41e5-80b8-7e37ad36ce7e"",""name"":""If2""},{""parameters"":{""jsonSchemaExample"":""{\n\t\""pass\"": true,\n\t\""feedback\"": \""this is empty when pass is true\""\n}""},""type"":""@n8n/n8n-nodes-langchain.outputParserStructured"",""typeVersion"":1.2,""position"":[4340,2460],""id"":""4c6980f3-e7ce-446d-8756-373c1d2bfd5b"",""name"":""Structured Output Parser2""},{""parameters"":{""model"":{""__rl"":true,""value"":""qwen2.5:14b-corrected8k"",""mode"":""list"",""cachedResultName"":""qwen2.5:14b-corrected8k""},""options"":{}},""type"":""@n8n/n8n-nodes-langchain.lmChatOpenAi"",""typeVersion"":1.2,""position"":[3580,2440],""id"":""e6db8e65-0b88-460b-94ef-442098735467"",""name"":""EO - o3 mini2"",""credentials"":{""openAiApi"":{""id"":""tRHsMPxbW4YJD93X"",""name"":""Ollama OpenAI""}}},{""parameters"":{""mode"":""raw"",""jsonOutput"":""={\n  \""currentAnamnesis\"": {{ JSON.stringify($('Diagnosis Writer').last().json.output) }},\n  \""feedback\"": {{  JSON.stringify($json.output.feedback) }}\n}"",""options"":{}},""type"":""n8n-nodes-base.set"",""typeVersion"":3.4,""position"":[4060,2480],""id"":""4676c848-ae8e-4b77-b65e-2bb6a51882a6"",""name"":""feedback2""},{""parameters"":{""sessionIdType"":""customKey"",""sessionKey"":""={{ $('Patient Data1').item.json.json_agg[0].encounter_id }}.diagnosis.agent.supervisor_id"",""tableName"":""=llm_memory"",""contextWindowLength"":3},""type"":""@n8n/n8n-nodes-langchain.memoryPostgresChat"",""typeVersion"":1.3,""position"":[3800,2440],""id"":""942f99fe-7008-4133-839f-59747510843c"",""name"":""Postgres Chat Memory1"",""credentials"":{""postgres"":{""id"":""i83SgkPKmlQ785tT"",""name"":""Postgres account""}}},{""parameters"":{""operation"":""executeQuery"",""query"":""SELECT json_agg(row_to_json(a))\nFROM med_disc.diagnosis a\nWHERE encounter_id = $1;"",""options"":{""queryReplacement"":""E001""}},""type"":""n8n-nodes-base.postgres"",""typeVersion"":2.6,""position"":[2920,2440],""id"":""b7e1675f-840e-43b2-a119-921010c4dede"",""name"":""Patient Data1"",""credentials"":{""postgres"":{""id"":""i83SgkPKmlQ785tT"",""name"":""Postgres account""}}},{""parameters"":{""operation"":""executeQuery"",""query"":""SELECT json_agg(row_to_json(a))\nFROM med_disc.llm_prompt_template a\nWHERE name = $1;"",""options"":{""queryReplacement"":""anamnesis_template""}},""type"":""n8n-nodes-base.postgres"",""typeVersion"":2.6,""position"":[3060,2440],""id"":""4e7c9ae7-7d05-405a-939b-39aa0ecc0a70"",""name"":""Template Creator1"",""credentials"":{""postgres"":{""id"":""i83SgkPKmlQ785tT"",""name"":""Postgres account""}}},{""parameters"":{""operation"":""executeQuery"",""query"":""SELECT json_agg(row_to_json(a))\nFROM med_disc.llm_prompt_template a\nWHERE name = $1;"",""options"":{""queryReplacement"":""anamnesis_evaluator""}},""type"":""n8n-nodes-base.postgres"",""typeVersion"":2.5,""position"":[3200,2440],""id"":""fbd8e901-ea59-4dc6-8a97-be48b7c41610"",""name"":""Template Evaluator1"",""credentials"":{""postgres"":{""id"":""i83SgkPKmlQ785tT"",""name"":""Postgres account""}}},{""parameters"":{""workflowInputs"":{""values"":[{""name"":""encounter_id""}]}},""type"":""n8n-nodes-base.executeWorkflowTrigger"",""typeVersion"":1.1,""position"":[2840,2940],""id"":""8977338f-ffbd-4830-9097-77dd3f6f202f"",""name"":""When Executed by Another Workflow""},{""parameters"":{""options"":{}},""type"":""n8n-nodes-base.respondToWebhook"",""typeVersion"":1.1,""position"":[4900,2940],""id"":""9a9ba876-52a3-4727-9cda-f7c176ab9121"",""name"":""Respond to Webhook""},{""parameters"":{""promptType"":""define"",""text"":""=## Feedback (if any):\n{{ $json.feedback }}\n\nChief Complaint:\n{{ $('Patient Data1').item.json.json_agg[0].chief_complaint }}\nVegetative State:\n{{ $('Patient Data1').item.json.json_agg[0].vegetative_state }}\nHistory of Present Illness:\n{{ $('Patient Data1').item.json.json_agg[0].history_of_present_illness }}\nPast Medical History:\n{{ $('Patient Data1').item.json.json_agg[0].past_medical_history }}\nFamily History:\n{{ $('Patient Data1').item.json.json_agg[0].family_history }}\nSocial History:\n{{ $('Patient Data1').item.json.json_agg[0].social_history }}\nReview of Systems:\n{{ $('Patient Data1').item.json.json_agg[0].review_of_systems }}"",""options"":{""systemMessage"":""={{ $('Template Creator1').item.json.json_agg[0].template_content }}"",""maxIterations"":5}},""type"":""@n8n/n8n-nodes-langchain.agent"",""typeVersion"":1.7,""position"":[3780,2240],""id"":""c0d30462-319c-45bb-bb9a-0369cfe19b5f"",""name"":""Diagnosis Writer""},{""parameters"":{""promptType"":""define"",""text"":""=Diagnosis Content: {{$json.output}}"",""hasOutputParser"":true,""options"":{""systemMessage"":""={{ $('Template Evaluator1').item.json.json_agg[0].template_content }}""}},""type"":""@n8n/n8n-nodes-langchain.agent"",""typeVersion"":1.7,""position"":[4160,2240],""id"":""8758060b-be57-44c6-8893-88da3dc38739"",""name"":""Diagnosis Evaluator""},{""parameters"":{},""type"":""n8n-nodes-base.manualTrigger"",""typeVersion"":1,""position"":[2420,2120],""id"":""ba57dd87-788a-47dd-9ce4-db5fe6ebc3b1"",""name"":""When clicking ‘Test workflow’""},{""parameters"":{""mode"":""raw"",""jsonOutput"":""{\n  \""input\"": \""Acute Ischemic Stroke – Left Middle Cerebral Artery (MCA) Territory, Hypertension (Essential/Primary Hypertension), Dyslipidemia, Mild Hepatic Steatosis\""\n}\n"",""options"":{}},""type"":""n8n-nodes-base.set"",""typeVersion"":3.4,""position"":[2560,2120],""id"":""225fe2d4-a204-4ed7-b82d-f6f325c0978e"",""name"":""Diagnosis Example""}]","{""2.0 Flash Thinking"":{""ai_languageModel"":[[{""node"":""Key Points Generator"",""type"":""ai_languageModel"",""index"":0}]]},""Report Generator"":{""main"":[[{""node"":""Gmail4"",""type"":""main"",""index"":0}]]},""O3-MINI"":{""ai_languageModel"":[[{""node"":""Report Planner"",""type"":""ai_languageModel"",""index"":0}]]},""Claude 3.5 Sonnet"":{""ai_languageModel"":[[{""node"":""Report Generator"",""type"":""ai_languageModel"",""index"":0}]]},""Text Classifier"":{""main"":[[{""node"":""Poem Generator"",""type"":""main"",""index"":0}],[{""node"":""Joke Generator"",""type"":""main"",""index"":0}],[{""node"":""Story Generator"",""type"":""main"",""index"":0}],[{""node"":""Error Message"",""type"":""main"",""index"":0}]]},""O3-mini-Routing"":{""ai_languageModel"":[[{""node"":""Text Classifier"",""type"":""ai_languageModel"",""index"":0},{""node"":""Poem Generator"",""type"":""ai_languageModel"",""index"":0},{""node"":""Joke Generator"",""type"":""ai_languageModel"",""index"":0},{""node"":""Story Generator"",""type"":""ai_languageModel"",""index"":0}]]},""SerpAPI"":{""ai_tool"":[[{""node"":""Restaurant Finder"",""type"":""ai_tool"",""index"":0},{""node"":""Hotel Finder"",""type"":""ai_tool"",""index"":0},{""node"":""Activity Finder"",""type"":""ai_tool"",""index"":0}]]},""Restaurant Finder"":{""main"":[[{""node"":""Merge"",""type"":""main"",""index"":0}]]},""Hotel Finder"":{""main"":[[{""node"":""Merge"",""type"":""main"",""index"":1}]]},""Activity Finder"":{""main"":[[{""node"":""Merge"",""type"":""main"",""index"":2}]]},""Merge"":{""main"":[[{""node"":""Aggregator"",""type"":""main"",""index"":0}]]},""2.0 Flash CW"":{""ai_languageModel"":[[{""node"":""OpenAI CopyWriter"",""type"":""ai_languageModel"",""index"":0}]]},""Claude 3.5 CW"":{""ai_languageModel"":[[{""node"":""Anthropic CopyWriter"",""type"":""ai_languageModel"",""index"":0}]]},""O3-MINI CW"":{""ai_languageModel"":[[{""node"":""Gemini CopyWriter"",""type"":""ai_languageModel"",""index"":0}]]},""OpenAI CopyWriter"":{""main"":[[{""node"":""Voting Merge"",""type"":""main"",""index"":0}]]},""Anthropic CopyWriter"":{""main"":[[{""node"":""Voting Merge"",""type"":""main"",""index"":1}]]},""Gemini CopyWriter"":{""main"":[[{""node"":""Voting Merge"",""type"":""main"",""index"":2}]]},""Voting Merge"":{""main"":[[{""node"":""CW Aggregator"",""type"":""main"",""index"":0}]]},""CW Aggregator"":{""main"":[[{""node"":""CW Demo"",""type"":""main"",""index"":0}]]},""Aggregator"":{""main"":[[{""node"":""Sectioning Demo"",""type"":""main"",""index"":0}]]},""Evaluator"":{""main"":[[{""node"":""If"",""type"":""main"",""index"":0}]]},""Structured Output Parser"":{""ai_outputParser"":[[{""node"":""Evaluator"",""type"":""ai_outputParser"",""index"":0}]]},""EO - o3 mini"":{""ai_languageModel"":[[{""node"":""Customer Support"",""type"":""ai_languageModel"",""index"":0},{""node"":""Evaluator"",""type"":""ai_languageModel"",""index"":0},{""node"":""Classify Email"",""type"":""ai_languageModel"",""index"":0}]]},""Gmail Trigger"":{""main"":[[{""node"":""Classify Email"",""type"":""main"",""index"":0}]]},""Customer Support"":{""main"":[[{""node"":""Evaluator"",""type"":""main"",""index"":0}]]},""If"":{""main"":[[{""node"":""Gmail"",""type"":""main"",""index"":0}],[{""node"":""feedback"",""type"":""main"",""index"":0}]]},""feedback"":{""main"":[[{""node"":""Customer Support"",""type"":""main"",""index"":0}]]},""Classify Email"":{""main"":[[{""node"":""Customer Support"",""type"":""main"",""index"":0}]]},""Sectioning"":{""main"":[[{""node"":""Restaurant Finder"",""type"":""main"",""index"":0},{""node"":""Hotel Finder"",""type"":""main"",""index"":0},{""node"":""Activity Finder"",""type"":""main"",""index"":0}]]},""Voting"":{""main"":[[{""node"":""OpenAI CopyWriter"",""type"":""main"",""index"":0},{""node"":""Anthropic CopyWriter"",""type"":""main"",""index"":0},{""node"":""Gemini CopyWriter"",""type"":""main"",""index"":0}]]},""Routing"":{""main"":[[{""node"":""Text Classifier"",""type"":""main"",""index"":0}]]},""Prompt Chaining"":{""main"":[[{""node"":""Key Points Generator"",""type"":""main"",""index"":0}]]},""When chat message received"":{""main"":[[{""node"":""Calendar Agent"",""type"":""main"",""index"":0}]]},""Agents - O3-MINI"":{""ai_languageModel"":[[{""node"":""Calendar Agent"",""type"":""ai_languageModel"",""index"":0}]]},""Get Events"":{""ai_tool"":[[{""node"":""Calendar Agent"",""type"":""ai_tool"",""index"":0}]]},""Create Calendar Event"":{""ai_tool"":[[{""node"":""Calendar Agent"",""type"":""ai_tool"",""index"":0}]]},""Orchestrator"":{""main"":[[{""node"":""Orchestrator Agent"",""type"":""main"",""index"":0}]]},""O3-mini-P"":{""ai_languageModel"":[[{""node"":""Restaurant Finder"",""type"":""ai_languageModel"",""index"":0},{""node"":""Hotel Finder"",""type"":""ai_languageModel"",""index"":0},{""node"":""Activity Finder"",""type"":""ai_languageModel"",""index"":0}]]},""O3-mini-Routing2"":{""ai_languageModel"":[[{""node"":""Orchestrator Agent"",""type"":""ai_languageModel"",""index"":0},{""node"":""Translator Agent"",""type"":""ai_languageModel"",""index"":0}]]},""Window Buffer Memory"":{""ai_memory"":[[{""node"":""Calendar Agent"",""type"":""ai_memory"",""index"":0}]]},""Orchestrator Agent"":{""main"":[[{""node"":""Split Out"",""type"":""main"",""index"":0}]]},""Split Out"":{""main"":[[{""node"":""Translator Agent"",""type"":""main"",""index"":0}]]},""Translation Array"":{""ai_outputParser"":[[{""node"":""Orchestrator Agent"",""type"":""ai_outputParser"",""index"":0}]]},""Translator Agent"":{""main"":[[{""node"":""Translated Text"",""type"":""main"",""index"":0}]]},""Translated Text"":{""main"":[[{""node"":""Gmail3"",""type"":""main"",""index"":0}]]},""Key Points Generator"":{""main"":[[{""node"":""Report Planner"",""type"":""main"",""index"":0}]]},""Send Email"":{""ai_tool"":[[{""node"":""Calendar Agent"",""type"":""ai_tool"",""index"":0}]]},""Report Planner"":{""main"":[[{""node"":""Report Generator"",""type"":""main"",""index"":0}]]},""Parse Patient Data"":{""main"":[[{""node"":""Initialize Workflow State"",""type"":""main"",""index"":0}]]},""Initialize Workflow State"":{""main"":[[{""node"":""LLM Router"",""type"":""main"",""index"":0}]]},""Router LLM"":{""ai_languageModel"":[[{""node"":""LLM Router"",""type"":""ai_languageModel"",""index"":0}]]},""LLM Router"":{""main"":[[{""node"":""Update Workflow State"",""type"":""main"",""index"":0}]]},""Read/Write Files from Disk"":{""main"":[[{""node"":""Extract from File"",""type"":""main"",""index"":0}]]},""Extract from File"":{""main"":[[{""node"":""Parse Patient Data"",""type"":""main"",""index"":0}]]},""Handle File Read Result"":{""main"":[[{""node"":""File Read Success?"",""type"":""main"",""index"":0}]]},""File Read Success?"":{""main"":[[{""node"":""Initialize Workflow State1"",""type"":""main"",""index"":0}],[{""node"":""Set Error State"",""type"":""main"",""index"":0}]]},""Initialize Workflow State1"":{""main"":[[{""node"":""LLM Router1"",""type"":""main"",""index"":0}]]},""Router LLM1"":{""ai_languageModel"":[[{""node"":""LLM Router1"",""type"":""ai_languageModel"",""index"":0}]]},""LLM Router1"":{""main"":[[{""node"":""Update Workflow State1"",""type"":""main"",""index"":0}]]},""If1"":{""main"":[[{""node"":""Respond to Webhook"",""type"":""main"",""index"":0}],[{""node"":""feedback1"",""type"":""main"",""index"":0}]]},""Structured Output Parser1"":{""ai_outputParser"":[[{""node"":""Anamnesis Evaluator"",""type"":""ai_outputParser"",""index"":0}]]},""EO - o3 mini1"":{""ai_languageModel"":[[{""node"":""Anamnesis Writer"",""type"":""ai_languageModel"",""index"":0},{""node"":""Anamnesis Evaluator"",""type"":""ai_languageModel"",""index"":0}]]},""feedback1"":{""main"":[[{""node"":""Anamnesis Writer"",""type"":""main"",""index"":0}]]},""Postgres Chat Memory"":{""ai_memory"":[[{""node"":""Anamnesis Writer"",""type"":""ai_memory"",""index"":0}]]},""Patient Data"":{""main"":[[{""node"":""Template Creator"",""type"":""main"",""index"":0}]]},""Anamnesis Writer"":{""main"":[[{""node"":""Anamnesis Evaluator"",""type"":""main"",""index"":0}]]},""Anamnesis Evaluator"":{""main"":[[{""node"":""If1"",""type"":""main"",""index"":0}]]},""Template Creator"":{""main"":[[{""node"":""Template Evaluator"",""type"":""main"",""index"":0}]]},""Template Evaluator"":{""main"":[[{""node"":""Anamnesis Writer"",""type"":""main"",""index"":0}]]},""If2"":{""main"":[[],[{""node"":""feedback2"",""type"":""main"",""index"":0}]]},""Structured Output Parser2"":{""ai_outputParser"":[[{""node"":""Diagnosis Evaluator"",""type"":""ai_outputParser"",""index"":0}]]},""EO - o3 mini2"":{""ai_languageModel"":[[{""node"":""Diagnosis Writer"",""type"":""ai_languageModel"",""index"":0},{""node"":""Diagnosis Evaluator"",""type"":""ai_languageModel"",""index"":0}]]},""feedback2"":{""main"":[[{""node"":""Diagnosis Writer"",""type"":""main"",""index"":0}]]},""Postgres Chat Memory1"":{""ai_memory"":[[{""node"":""Diagnosis Writer"",""type"":""ai_memory"",""index"":0}]]},""Patient Data1"":{""main"":[[{""node"":""Template Creator1"",""type"":""main"",""index"":0}]]},""Template Creator1"":{""main"":[[{""node"":""Template Evaluator1"",""type"":""main"",""index"":0}]]},""Template Evaluator1"":{""main"":[[{""node"":""Diagnosis Writer"",""type"":""main"",""index"":0}]]},""When Executed by Another Workflow"":{""main"":[[{""node"":""Patient Data"",""type"":""main"",""index"":0}]]},""Diagnosis Writer"":{""main"":[[{""node"":""Diagnosis Evaluator"",""type"":""main"",""index"":0}]]},""Diagnosis Evaluator"":{""main"":[[{""node"":""If2"",""type"":""main"",""index"":0}]]},""When clicking ‘Test workflow’"":{""main"":[[{""node"":""Diagnosis Example"",""type"":""main"",""index"":0}]]}}",2025-03-27 16:17:44.446+00,2025-03-28 20:45:37.597+00,"{""executionOrder"":""v1""}",,{},27694a58-7091-4ca1-8900-9f3f02dc5b40,0,UfdrG1xvg1DPEU0J,,
